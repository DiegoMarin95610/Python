(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2888],{4444:function(e,t,n){"use strict";n.d(t,{$s:function(){return $},BH:function(){return v},G6:function(){return D},L:function(){return u},LL:function(){return R},P0:function(){return g},Pz:function(){return _},Sg:function(){return w},ZR:function(){return N},aH:function(){return y},b$:function(){return S},eu:function(){return k},hl:function(){return x},m9:function(){return V},ne:function(){return F},pd:function(){return U},q4:function(){return m},ru:function(){return I},tV:function(){return c},uI:function(){return E},vZ:function(){return function e(t,n){if(t===n)return!0;let r=Object.keys(t),i=Object.keys(n);for(let s of r){if(!i.includes(s))return!1;let a=t[s],o=n[s];if(P(a)&&P(o)){if(!e(a,o))return!1}else if(a!==o)return!1}for(let l of i)if(!r.includes(l))return!1;return!0}},w1:function(){return T},xO:function(){return L},xb:function(){return O},z$:function(){return b},zI:function(){return C},zd:function(){return M}});var r=n(3454);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ let i=function(e){let t=[],n=0;for(let r=0;r<e.length;r++){let i=e.charCodeAt(r);i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):(64512&i)==55296&&r+1<e.length&&(64512&e.charCodeAt(r+1))==56320?(i=65536+((1023&i)<<10)+(1023&e.charCodeAt(++r)),t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t},s=function(e){let t=[],n=0,r=0;for(;n<e.length;){let i=e[n++];if(i<128)t[r++]=String.fromCharCode(i);else if(i>191&&i<224){let s=e[n++];t[r++]=String.fromCharCode((31&i)<<6|63&s)}else if(i>239&&i<365){let a=e[n++],o=e[n++],l=e[n++],u=((7&i)<<18|(63&a)<<12|(63&o)<<6|63&l)-65536;t[r++]=String.fromCharCode(55296+(u>>10)),t[r++]=String.fromCharCode(56320+(1023&u))}else{let c=e[n++],h=e[n++];t[r++]=String.fromCharCode((15&i)<<12|(63&c)<<6|63&h)}}return t.join("")},a={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();let n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<e.length;i+=3){let s=e[i],a=i+1<e.length,o=a?e[i+1]:0,l=i+2<e.length,u=l?e[i+2]:0,c=s>>2,h=(3&s)<<4|o>>4,d=(15&o)<<2|u>>6,f=63&u;l||(f=64,a||(d=64)),r.push(n[c],n[h],n[d],n[f])}return r.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(i(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):s(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();let n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<e.length;){let s=n[e.charAt(i++)],a=i<e.length,l=a?n[e.charAt(i)]:0;++i;let u=i<e.length,c=u?n[e.charAt(i)]:64;++i;let h=i<e.length,d=h?n[e.charAt(i)]:64;if(++i,null==s||null==l||null==c||null==d)throw new o;let f=s<<2|l>>4;if(r.push(f),64!==c){let p=l<<4&240|c>>2;if(r.push(p),64!==d){let m=c<<6&192|d;r.push(m)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class o extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}let l=function(e){let t=i(e);return a.encodeByteArray(t,!0)},u=function(e){return l(e).replace(/\./g,"")},c=function(e){try{return a.decodeString(e,!0)}catch(t){console.error("base64Decode failed: ",t)}return null},h=()=>/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ (function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==n.g)return n.g;throw Error("Unable to locate global object.")})().__FIREBASE_DEFAULTS__,d=()=>{if(void 0===r||void 0===r.env)return;let e=r.env.__FIREBASE_DEFAULTS__;if(e)return JSON.parse(e)},f=()=>{let e;if("undefined"==typeof document)return;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(t){return}let n=e&&c(e[1]);return n&&JSON.parse(n)},p=()=>{try{return h()||d()||f()}catch(e){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${e}`);return}},m=e=>{var t,n;return null===(n=null===(t=p())||void 0===t?void 0:t.emulatorHosts)||void 0===n?void 0:n[e]},g=e=>{let t=m(e);if(!t)return;let n=t.lastIndexOf(":");if(n<=0||n+1===t.length)throw Error(`Invalid host ${t} with no separate hostname and port!`);let r=parseInt(t.substring(n+1),10);return"["===t[0]?[t.substring(1,n-1),r]:[t.substring(0,n),r]},y=()=>{var e;return null===(e=p())||void 0===e?void 0:e.config},_=e=>{var t;return null===(t=p())||void 0===t?void 0:t[`_${e}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ class v{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),"function"==typeof e&&(this.promise.catch(()=>{}),1===e.length?e(t):e(t,n))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ function w(e,t){if(e.uid)throw Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');let n=t||"demo-project",r=e.iat||0,i=e.sub||e.user_id;if(!i)throw Error("mockUserToken must contain 'sub' or 'user_id' field!");let s=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:r,exp:r+3600,auth_time:r,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},e);return[u(JSON.stringify({alg:"none",type:"JWT"})),u(JSON.stringify(s)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ function b(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function E(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(b())}function I(){let e="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof e&&void 0!==e.id}function S(){return"object"==typeof navigator&&"ReactNative"===navigator.product}function T(){let e=b();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0}function D(){return!function(){var e;let t=null===(e=p())||void 0===e?void 0:e.forceEnvironment;if("node"===t)return!0;if("browser"===t)return!1;try{return"[object process]"===Object.prototype.toString.call(n.g.process)}catch(r){return!1}}()&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function x(){try{return"object"==typeof indexedDB}catch(e){return!1}}function k(){return new Promise((e,t)=>{try{let n=!0,r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),e(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var e;t((null===(e=i.error)||void 0===e?void 0:e.message)||"")}}catch(s){t(s)}})}function C(){return"undefined"!=typeof navigator&&!!navigator.cookieEnabled}class N extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,N.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,R.prototype.create)}}class R{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e,...t){let n=t[0]||{},r=`${this.service}/${e}`,i=this.errors[e],s=i?i.replace(A,(e,t)=>{let r=n[t];return null!=r?String(r):`<${t}?>`}):"Error",a=`${this.serviceName}: ${s} (${r}).`,o=new N(r,a,n);return o}}let A=/\{\$([^}]+)}/g;function O(e){for(let t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}function P(e){return null!==e&&"object"==typeof e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ function L(e){let t=[];for(let[n,r]of Object.entries(e))Array.isArray(r)?r.forEach(e=>{t.push(encodeURIComponent(n)+"="+encodeURIComponent(e))}):t.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return t.length?"&"+t.join("&"):""}function M(e){let t={},n=e.replace(/^\?/,"").split("&");return n.forEach(e=>{if(e){let[n,r]=e.split("=");t[decodeURIComponent(n)]=decodeURIComponent(r)}}),t}function U(e){let t=e.indexOf("?");if(!t)return"";let n=e.indexOf("#",t);return e.substring(t,n>0?n:void 0)}function F(e,t){let n=new j(e,t);return n.subscribe.bind(n)}class j{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(e=>{this.error(e)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,n){let r;if(void 0===e&&void 0===t&&void 0===n)throw Error("Missing Observer.");void 0===(r=!function(e,t){if("object"!=typeof e||null===e)return!1;for(let n of t)if(n in e&&"function"==typeof e[n])return!0;return!1}(e,["next","error","complete"])?{next:e,error:t,complete:n}:e).next&&(r.next=B),void 0===r.error&&(r.error=B),void 0===r.complete&&(r.complete=B);let i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch(e){}}),this.observers.push(r),i}unsubscribeOne(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(void 0!==this.observers&&void 0!==this.observers[e])try{t(this.observers[e])}catch(n){"undefined"!=typeof console&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function B(){}function $(e,t=1e3,n=2){let r=t*Math.pow(n,e);return Math.min(144e5,r+Math.round(.5*r*(Math.random()-.5)*2))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ function V(e){return e&&e._delegate?e._delegate:e}},6741:function(e,t,n){"use strict";function r(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];throw Error("[Immer] minified error nr: "+e+(n.length?" "+n.map(function(e){return"'"+e+"'"}).join(","):"")+". Find the full error at: https://bit.ly/3cXEKWf")}function i(e){return!!e&&!!e[G]}function s(e){var t;return!!e&&(function(e){if(!e||"object"!=typeof e)return!1;var t=Object.getPrototypeOf(e);if(null===t)return!0;var n=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return n===Object||"function"==typeof n&&Function.toString.call(n)===q}(e)||Array.isArray(e)||!!e[V]||!!(null===(t=e.constructor)||void 0===t?void 0:t[V])||h(e)||d(e))}function a(e,t,n){void 0===n&&(n=!1),0===o(e)?(n?Object.keys:z)(e).forEach(function(r){n&&"symbol"==typeof r||t(r,e[r],e)}):e.forEach(function(n,r){return t(r,n,e)})}function o(e){var t=e[G];return t?t.i>3?t.i-4:t.i:Array.isArray(e)?1:h(e)?2:d(e)?3:0}function l(e,t){return 2===o(e)?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function u(e,t,n){var r=o(e);2===r?e.set(t,n):3===r?e.add(n):e[t]=n}function c(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}function h(e){return F&&e instanceof Map}function d(e){return j&&e instanceof Set}function f(e){return e.o||e.t}function p(e){if(Array.isArray(e))return Array.prototype.slice.call(e);var t=K(e);delete t[G];for(var n=z(t),r=0;r<n.length;r++){var i=n[r],s=t[i];!1===s.writable&&(s.writable=!0,s.configurable=!0),(s.get||s.set)&&(t[i]={configurable:!0,writable:!0,enumerable:s.enumerable,value:e[i]})}return Object.create(Object.getPrototypeOf(e),t)}function m(e,t){return void 0===t&&(t=!1),y(e)||i(e)||!s(e)||(o(e)>1&&(e.set=e.add=e.clear=e.delete=g),Object.freeze(e),t&&a(e,function(e,t){return m(t,!0)},!0)),e}function g(){r(2)}function y(e){return null==e||"object"!=typeof e||Object.isFrozen(e)}function _(e){var t=Y[e];return t||r(18,e),t}function v(e,t){t&&(_("Patches"),e.u=[],e.s=[],e.v=t)}function w(e){b(e),e.p.forEach(I),e.p=null}function b(e){e===M&&(M=e.l)}function E(e){return M={p:[],l:M,h:e,m:!0,_:0}}function I(e){var t=e[G];0===t.i||1===t.i?t.j():t.g=!0}function S(e,t){t._=t.p.length;var n=t.p[0],i=void 0!==e&&e!==n;return t.h.O||_("ES5").S(t,e,i),i?(n[G].P&&(w(t),r(4)),s(e)&&(e=T(t,e),t.l||x(t,e)),t.u&&_("Patches").M(n[G].t,e,t.u,t.s)):e=T(t,n,[]),w(t),t.u&&t.v(t.u,t.s),e!==$?e:void 0}function T(e,t,n){if(y(t))return t;var r=t[G];if(!r)return a(t,function(i,s){return D(e,r,t,i,s,n)},!0),t;if(r.A!==e)return t;if(!r.P)return x(e,r.t,!0),r.t;if(!r.I){r.I=!0,r.A._--;var i=4===r.i||5===r.i?r.o=p(r.k):r.o,s=i,o=!1;3===r.i&&(s=new Set(i),i.clear(),o=!0),a(s,function(t,s){return D(e,r,i,t,s,n,o)}),x(e,i,!1),n&&e.u&&_("Patches").N(r,n,e.u,e.s)}return r.o}function D(e,t,n,r,a,o,c){if(i(a)){var h=T(e,a,o&&t&&3!==t.i&&!l(t.R,r)?o.concat(r):void 0);if(u(n,r,h),!i(h))return;e.m=!1}else c&&n.add(a);if(s(a)&&!y(a)){if(!e.h.D&&e._<1)return;T(e,a),t&&t.A.l||x(e,a)}}function x(e,t,n){void 0===n&&(n=!1),!e.l&&e.h.D&&e.m&&m(t,n)}function k(e,t){var n=e[G];return(n?f(n):e)[t]}function C(e,t){if(t in e)for(var n=Object.getPrototypeOf(e);n;){var r=Object.getOwnPropertyDescriptor(n,t);if(r)return r;n=Object.getPrototypeOf(n)}}function N(e){e.P||(e.P=!0,e.l&&N(e.l))}function R(e){e.o||(e.o=p(e.t))}function A(e,t,n){var r,i,s,a,o,l,u,c=h(t)?_("MapSet").F(t,n):d(t)?_("MapSet").T(t,n):e.O?(s=i={i:(r=Array.isArray(t))?1:0,A:n?n.A:M,P:!1,I:!1,R:{},l:n,t:t,k:null,o:null,j:null,C:!1},a=H,r&&(s=[i],a=W),l=(o=Proxy.revocable(s,a)).revoke,u=o.proxy,i.k=u,i.j=l,u):_("ES5").J(t,n);return(n?n.A:M).p.push(c),c}function O(e,t){switch(t){case 2:return new Map(e);case 3:return Array.from(e)}return p(e)}n.d(t,{xC:function(){return eT},oM:function(){return ek}});var P,L,M,U="undefined"!=typeof Symbol&&"symbol"==typeof Symbol("x"),F="undefined"!=typeof Map,j="undefined"!=typeof Set,B="undefined"!=typeof Proxy&&void 0!==Proxy.revocable&&"undefined"!=typeof Reflect,$=U?Symbol.for("immer-nothing"):((L={})["immer-nothing"]=!0,L),V=U?Symbol.for("immer-draftable"):"__$immer_draftable",G=U?Symbol.for("immer-state"):"__$immer_state",q=""+Object.prototype.constructor,z="undefined"!=typeof Reflect&&Reflect.ownKeys?Reflect.ownKeys:void 0!==Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Object.getOwnPropertyNames,K=Object.getOwnPropertyDescriptors||function(e){var t={};return z(e).forEach(function(n){t[n]=Object.getOwnPropertyDescriptor(e,n)}),t},Y={},H={get:function(e,t){if(t===G)return e;var n,r,i=f(e);if(!l(i,t))return(r=C(i,t))?"value"in r?r.value:null===(n=r.get)||void 0===n?void 0:n.call(e.k):void 0;var a=i[t];return e.I||!s(a)?a:a===k(e.t,t)?(R(e),e.o[t]=A(e.A.h,a,e)):a},has:function(e,t){return t in f(e)},ownKeys:function(e){return Reflect.ownKeys(f(e))},set:function(e,t,n){var r=C(f(e),t);if(null==r?void 0:r.set)return r.set.call(e.k,n),!0;if(!e.P){var i=k(f(e),t),s=null==i?void 0:i[G];if(s&&s.t===n)return e.o[t]=n,e.R[t]=!1,!0;if(c(n,i)&&(void 0!==n||l(e.t,t)))return!0;R(e),N(e)}return e.o[t]===n&&(void 0!==n||t in e.o)||Number.isNaN(n)&&Number.isNaN(e.o[t])||(e.o[t]=n,e.R[t]=!0),!0},deleteProperty:function(e,t){return void 0!==k(e.t,t)||t in e.t?(e.R[t]=!1,R(e),N(e)):delete e.R[t],e.o&&delete e.o[t],!0},getOwnPropertyDescriptor:function(e,t){var n=f(e),r=Reflect.getOwnPropertyDescriptor(n,t);return r?{writable:!0,configurable:1!==e.i||"length"!==t,enumerable:r.enumerable,value:n[t]}:r},defineProperty:function(){r(11)},getPrototypeOf:function(e){return Object.getPrototypeOf(e.t)},setPrototypeOf:function(){r(12)}},W={};a(H,function(e,t){W[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}}),W.deleteProperty=function(e,t){return W.set.call(this,e,t,void 0)},W.set=function(e,t,n){return H.set.call(this,e[0],t,n,e[0])};var Q=new(function(){function e(e){var t=this;this.O=B,this.D=!0,this.produce=function(e,n,i){if("function"==typeof e&&"function"!=typeof n){var a,o=n;return n=e,function(e){var r=this;void 0===e&&(e=o);for(var i=arguments.length,s=Array(i>1?i-1:0),a=1;a<i;a++)s[a-1]=arguments[a];return t.produce(e,function(e){var t;return(t=n).call.apply(t,[r,e].concat(s))})}}if("function"!=typeof n&&r(6),void 0!==i&&"function"!=typeof i&&r(7),s(e)){var l=E(t),u=A(t,e,void 0),c=!0;try{a=n(u),c=!1}finally{c?w(l):b(l)}return"undefined"!=typeof Promise&&a instanceof Promise?a.then(function(e){return v(l,i),S(e,l)},function(e){throw w(l),e}):(v(l,i),S(a,l))}if(!e||"object"!=typeof e){if(void 0===(a=n(e))&&(a=e),a===$&&(a=void 0),t.D&&m(a,!0),i){var h=[],d=[];_("Patches").M(e,a,h,d),i(h,d)}return a}r(21,e)},this.produceWithPatches=function(e,n){if("function"==typeof e)return function(n){for(var r=arguments.length,i=Array(r>1?r-1:0),s=1;s<r;s++)i[s-1]=arguments[s];return t.produceWithPatches(n,function(t){return e.apply(void 0,[t].concat(i))})};var r,i,s=t.produce(e,n,function(e,t){r=e,i=t});return"undefined"!=typeof Promise&&s instanceof Promise?s.then(function(e){return[e,r,i]}):[s,r,i]},"boolean"==typeof(null==e?void 0:e.useProxies)&&this.setUseProxies(e.useProxies),"boolean"==typeof(null==e?void 0:e.autoFreeze)&&this.setAutoFreeze(e.autoFreeze)}var t=e.prototype;return t.createDraft=function(e){s(e)||r(8),i(e)&&(i(t=e)||r(22,t),e=function e(t){if(!s(t))return t;var n,r=t[G],i=o(t);if(r){if(!r.P&&(r.i<4||!_("ES5").K(r)))return r.t;r.I=!0,n=O(t,i),r.I=!1}else n=O(t,i);return a(n,function(t,i){var s;r&&(2===o(s=r.t)?s.get(t):s[t])===i||u(n,t,e(i))}),3===i?new Set(n):n}(t));var t,n=E(this),l=A(this,e,void 0);return l[G].C=!0,b(n),l},t.finishDraft=function(e,t){var n=(e&&e[G]).A;return v(n,t),S(void 0,n)},t.setAutoFreeze=function(e){this.D=e},t.setUseProxies=function(e){e&&!B&&r(20),this.O=e},t.applyPatches=function(e,t){for(n=t.length-1;n>=0;n--){var n,r=t[n];if(0===r.path.length&&"replace"===r.op){e=r.value;break}}n>-1&&(t=t.slice(n+1));var s=_("Patches").$;return i(e)?s(e,t):this.produce(e,function(e){return s(e,t)})},e}()),X=Q.produce;function J(e){return(J="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Z(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function ee(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Z(Object(n),!0).forEach(function(t){!function(e,t,n){var r;r=function(e,t){if("object"!==J(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==J(r))return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"),(t="symbol"===J(r)?r:String(r))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Z(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function et(e){return"Minified Redux error #"+e+"; visit https://redux.js.org/Errors?code="+e+" for the full message or use the non-minified dev environment for full errors. "}Q.produceWithPatches.bind(Q),Q.setAutoFreeze.bind(Q),Q.setUseProxies.bind(Q),Q.applyPatches.bind(Q),Q.createDraft.bind(Q),Q.finishDraft.bind(Q);var en="function"==typeof Symbol&&Symbol.observable||"@@observable",er=function(){return Math.random().toString(36).substring(7).split("").join(".")},ei={INIT:"@@redux/INIT"+er(),REPLACE:"@@redux/REPLACE"+er(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+er()}};function es(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return 0===t.length?function(e){return e}:1===t.length?t[0]:t.reduce(function(e,t){return function(){return e(t.apply(void 0,arguments))}})}function ea(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){return function(){var n=e.apply(void 0,arguments),r=function(){throw Error(et(15))},i={getState:n.getState,dispatch:function(){return r.apply(void 0,arguments)}},s=t.map(function(e){return e(i)});return r=es.apply(void 0,s)(n.dispatch),ee(ee({},n),{},{dispatch:r})}}}function eo(e){return function(t){var n=t.dispatch,r=t.getState;return function(t){return function(i){return"function"==typeof i?i(n,r,e):t(i)}}}}var el=eo();el.withExtraArgument=eo,n(3454);var eu=(P=function(e,t){return(P=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}P(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),ec=function(e,t){var n,r,i,s,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function o(s){return function(o){return function(s){if(n)throw TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&s[0]?r.return:s[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,s[1])).done)return i;switch(r=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===s[0]||2===s[0])){a=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){a.label=s[1];break}if(6===s[0]&&a.label<i[1]){a.label=i[1],i=s;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(s);break}i[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(o){s=[6,o],r=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,o])}}},eh=function(e,t){for(var n=0,r=t.length,i=e.length;n<r;n++,i++)e[i]=t[n];return e},ed=Object.defineProperty,ef=Object.defineProperties,ep=Object.getOwnPropertyDescriptors,em=Object.getOwnPropertySymbols,eg=Object.prototype.hasOwnProperty,ey=Object.prototype.propertyIsEnumerable,e_=function(e,t,n){return t in e?ed(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n},ev=function(e,t){for(var n in t||(t={}))eg.call(t,n)&&e_(e,n,t[n]);if(em)for(var r=0,i=em(t);r<i.length;r++){var n=i[r];ey.call(t,n)&&e_(e,n,t[n])}return e},ew=function(e,t){return ef(e,ep(t))},eb="undefined"!=typeof window&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(0!=arguments.length)return"object"==typeof arguments[0]?es:es.apply(null,arguments)};"undefined"!=typeof window&&window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__;var eE=function(e){function t(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var i=e.apply(this,n)||this;return Object.setPrototypeOf(i,t.prototype),i}return eu(t,e),Object.defineProperty(t,Symbol.species,{get:function(){return t},enumerable:!1,configurable:!0}),t.prototype.concat=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return e.prototype.concat.apply(this,t)},t.prototype.prepend=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return 1===e.length&&Array.isArray(e[0])?new(t.bind.apply(t,eh([void 0],e[0].concat(this)))):new(t.bind.apply(t,eh([void 0],e.concat(this))))},t}(Array),eI=function(e){function t(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var i=e.apply(this,n)||this;return Object.setPrototypeOf(i,t.prototype),i}return eu(t,e),Object.defineProperty(t,Symbol.species,{get:function(){return t},enumerable:!1,configurable:!0}),t.prototype.concat=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return e.prototype.concat.apply(this,t)},t.prototype.prepend=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return 1===e.length&&Array.isArray(e[0])?new(t.bind.apply(t,eh([void 0],e[0].concat(this)))):new(t.bind.apply(t,eh([void 0],e.concat(this))))},t}(Array);function eS(e){return s(e)?X(e,function(){}):e}function eT(e){var t,n=function(e){var t,n,r,i;return void 0===(t=e)&&(t={}),r=void 0===(n=t.thunk)||n,t.immutableCheck,t.serializableCheck,i=new eE,r&&("boolean"==typeof r?i.push(el):i.push(el.withExtraArgument(r.extraArgument))),i},r=e||{},i=r.reducer,s=void 0===i?void 0:i,a=r.middleware,o=void 0===a?n():a,l=r.devTools,u=void 0===l||l,c=r.preloadedState,h=r.enhancers,d=void 0===h?void 0:h;if("function"==typeof s)t=s;else if(function(e){if("object"!=typeof e||null===e)return!1;var t=Object.getPrototypeOf(e);if(null===t)return!0;for(var n=t;null!==Object.getPrototypeOf(n);)n=Object.getPrototypeOf(n);return t===n}(s))t=function(e){for(var t,n=Object.keys(e),r={},i=0;i<n.length;i++){var s=n[i];"function"==typeof e[s]&&(r[s]=e[s])}var a=Object.keys(r);try{!function(e){Object.keys(e).forEach(function(t){var n=e[t];if(void 0===n(void 0,{type:ei.INIT}))throw Error(et(12));if(void 0===n(void 0,{type:ei.PROBE_UNKNOWN_ACTION()}))throw Error(et(13))})}(r)}catch(o){t=o}return function(e,n){if(void 0===e&&(e={}),t)throw t;for(var i=!1,s={},o=0;o<a.length;o++){var l=a[o],u=r[l],c=e[l],h=u(c,n);if(void 0===h)throw n&&n.type,Error(et(14));s[l]=h,i=i||h!==c}return(i=i||a.length!==Object.keys(e).length)?s:e}}(s);else throw Error('"reducer" is a required argument, and must be a function or an object of functions that can be passed to combineReducers');var f=o;"function"==typeof f&&(f=f(n));var p=ea.apply(void 0,f),m=es;u&&(m=eb(ev({trace:!1},"object"==typeof u&&u)));var g=new eI(p),y=g;return Array.isArray(d)?y=eh([p],d):"function"==typeof d&&(y=d(g)),function e(t,n,r){if("function"==typeof n&&"function"==typeof r||"function"==typeof r&&"function"==typeof arguments[3])throw Error(et(0));if("function"==typeof n&&void 0===r&&(r=n,n=void 0),void 0!==r){if("function"!=typeof r)throw Error(et(1));return r(e)(t,n)}if("function"!=typeof t)throw Error(et(2));var i,s=t,a=n,o=[],l=o,u=!1;function c(){l===o&&(l=o.slice())}function h(){if(u)throw Error(et(3));return a}function d(e){if("function"!=typeof e)throw Error(et(4));if(u)throw Error(et(5));var t=!0;return c(),l.push(e),function(){if(t){if(u)throw Error(et(6));t=!1,c();var n=l.indexOf(e);l.splice(n,1),o=null}}}function f(e){if(!function(e){if("object"!=typeof e||null===e)return!1;for(var t=e;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}(e))throw Error(et(7));if(void 0===e.type)throw Error(et(8));if(u)throw Error(et(9));try{u=!0,a=s(a,e)}finally{u=!1}for(var t=o=l,n=0;n<t.length;n++)(0,t[n])();return e}return f({type:ei.INIT}),(i={dispatch:f,subscribe:d,getState:h,replaceReducer:function(e){if("function"!=typeof e)throw Error(et(10));s=e,f({type:ei.REPLACE})}})[en]=function(){var e;return(e={subscribe:function(e){if("object"!=typeof e||null===e)throw Error(et(11));function t(){e.next&&e.next(h())}return t(),{unsubscribe:d(t)}}})[en]=function(){return this},e},i}(t,void 0===c?void 0:c,m.apply(void 0,y))}function eD(e,t){function n(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];if(t){var i=t.apply(void 0,n);if(!i)throw Error("prepareAction did not return an object");return ev(ev({type:e,payload:i.payload},"meta"in i&&{meta:i.meta}),"error"in i&&{error:i.error})}return{type:e,payload:n[0]}}return n.toString=function(){return""+e},n.type=e,n.match=function(t){return t.type===e},n}function ex(e){var t,n={},r=[],i={addCase:function(e,t){var r="string"==typeof e?e:e.type;if(r in n)throw Error("addCase cannot be called with two reducers for the same action type");return n[r]=t,i},addMatcher:function(e,t){return r.push({matcher:e,reducer:t}),i},addDefaultCase:function(e){return t=e,i}};return e(i),[n,r,t]}function ek(e){var t,n=e.name;if(!n)throw Error("`name` is a required option for createSlice");var r="function"==typeof e.initialState?e.initialState:eS(e.initialState),a=e.reducers||{},o=Object.keys(a),l={},u={},c={};function h(){var t="function"==typeof e.extraReducers?ex(e.extraReducers):[e.extraReducers],n=t[0],a=t[1],o=void 0===a?[]:a,l=t[2],c=void 0===l?void 0:l,h=ev(ev({},void 0===n?{}:n),u);return function(e,t,n,r){void 0===n&&(n=[]);var a,o="function"==typeof t?ex(t):[t,n,void 0],l=o[0],u=o[1],c=o[2];if("function"==typeof e)a=function(){return eS(e())};else{var h=eS(e);a=function(){return h}}function d(e,t){void 0===e&&(e=a());var n=eh([l[t.type]],u.filter(function(e){return(0,e.matcher)(t)}).map(function(e){return e.reducer}));return 0===n.filter(function(e){return!!e}).length&&(n=[c]),n.reduce(function(e,n){if(n){if(i(e)){var r=n(e,t);return void 0===r?e:r}if(s(e))return X(e,function(e){return n(e,t)});var r=n(e,t);if(void 0===r){if(null===e)return e;throw Error("A case reducer on a non-draftable value must not return undefined")}return r}return e},e)}return d.getInitialState=a,d}(r,function(e){for(var t in h)e.addCase(t,h[t]);for(var n=0;n<o.length;n++){var r=o[n];e.addMatcher(r.matcher,r.reducer)}c&&e.addDefaultCase(c)})}return o.forEach(function(e){var t,r,i=a[e],s=n+"/"+e;"reducer"in i?(t=i.reducer,r=i.prepare):t=i,l[e]=t,u[s]=t,c[e]=r?eD(s,r):eD(s)}),{name:n,reducer:function(e,n){return t||(t=h()),t(e,n)},actions:c,caseReducers:l,getInitialState:function(){return t||(t=h()),t.getInitialState()}}}var eC=function(e){void 0===e&&(e=21);for(var t="",n=e;n--;)t+="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW"[64*Math.random()|0];return t},eN=["name","message","stack","code"],eR=function(e,t){this.payload=e,this.meta=t},eA=function(e,t){this.payload=e,this.meta=t},eO=function(e){if("object"==typeof e&&null!==e){for(var t={},n=0;n<eN.length;n++){var r=eN[n];"string"==typeof e[r]&&(t[r]=e[r])}return t}return{message:String(e)}};function eP(e){if(e.meta&&e.meta.rejectedWithValue)throw e.payload;if(e.error)throw e.error;return e.payload}!function(){function e(e,t,n){var r=eD(e+"/fulfilled",function(e,t,n,r){return{payload:e,meta:ew(ev({},r||{}),{arg:n,requestId:t,requestStatus:"fulfilled"})}}),i=eD(e+"/pending",function(e,t,n){return{payload:void 0,meta:ew(ev({},n||{}),{arg:t,requestId:e,requestStatus:"pending"})}}),s=eD(e+"/rejected",function(e,t,r,i,s){return{payload:i,error:(n&&n.serializeError||eO)(e||"Rejected"),meta:ew(ev({},s||{}),{arg:r,requestId:t,rejectedWithValue:!!i,requestStatus:"rejected",aborted:(null==e?void 0:e.name)==="AbortError",condition:(null==e?void 0:e.name)==="ConditionError"})}}),a="undefined"!=typeof AbortController?AbortController:function(){function e(){this.signal={aborted:!1,addEventListener:function(){},dispatchEvent:function(){return!1},onabort:function(){},removeEventListener:function(){},reason:void 0,throwIfAborted:function(){}}}return e.prototype.abort=function(){},e}();return Object.assign(function(e){return function(o,l,u){var c,h=(null==n?void 0:n.idGenerator)?n.idGenerator(e):eC(),d=new a;function f(e){c=e,d.abort()}var p=function(){var a,p;return a=this,p=function(){var a,p,m,g,y,_;return ec(this,function(v){switch(v.label){case 0:var w;if(v.trys.push([0,4,,5]),!(null!==(w=g=null==(a=null==n?void 0:n.condition)?void 0:a.call(n,e,{getState:l,extra:u}))&&"object"==typeof w&&"function"==typeof w.then))return[3,2];return[4,g];case 1:g=v.sent(),v.label=2;case 2:if(!1===g||d.signal.aborted)throw{name:"ConditionError",message:"Aborted due to condition callback returning false."};return y=new Promise(function(e,t){return d.signal.addEventListener("abort",function(){return t({name:"AbortError",message:c||"Aborted"})})}),o(i(h,e,null==(p=null==n?void 0:n.getPendingMeta)?void 0:p.call(n,{requestId:h,arg:e},{getState:l,extra:u}))),[4,Promise.race([y,Promise.resolve(t(e,{dispatch:o,getState:l,extra:u,requestId:h,signal:d.signal,abort:f,rejectWithValue:function(e,t){return new eR(e,t)},fulfillWithValue:function(e,t){return new eA(e,t)}})).then(function(t){if(t instanceof eR)throw t;return t instanceof eA?r(t.payload,h,e,t.meta):r(t,h,e)})])];case 3:return m=v.sent(),[3,5];case 4:return m=(_=v.sent())instanceof eR?s(null,h,e,_.payload,_.meta):s(_,h,e),[3,5];case 5:return n&&!n.dispatchConditionRejection&&s.match(m)&&m.meta.condition||o(m),[2,m]}})},new Promise(function(e,t){var n=function(e){try{i(p.next(e))}catch(n){t(n)}},r=function(e){try{i(p.throw(e))}catch(n){t(n)}},i=function(t){return t.done?e(t.value):Promise.resolve(t.value).then(n,r)};i((p=p.apply(a,null)).next())})}();return Object.assign(p,{abort:f,requestId:h,arg:e,unwrap:function(){return p.then(eP)}})}},{pending:i,rejected:s,fulfilled:r,typePrefix:e})}e.withTypes=function(){return e}}();var eL="listenerMiddleware";eD(eL+"/add"),eD(eL+"/removeAll"),eD(eL+"/remove"),"function"==typeof queueMicrotask&&queueMicrotask.bind("undefined"!=typeof window?window:void 0!==n.g?n.g:globalThis),"undefined"!=typeof window&&window.requestAnimationFrame&&window.requestAnimationFrame,function(){function e(e,t){var n=o[e];return n?n.enumerable=t:o[e]=n={configurable:!0,enumerable:t,get:function(){var t=this[G];return H.get(t,e)},set:function(t){var n=this[G];H.set(n,e,t)}},n}function t(e){for(var t=e.length-1;t>=0;t--){var i=e[t][G];if(!i.P)switch(i.i){case 5:r(i)&&N(i);break;case 4:n(i)&&N(i)}}}function n(e){for(var t=e.t,n=e.k,r=z(n),i=r.length-1;i>=0;i--){var s=r[i];if(s!==G){var a=t[s];if(void 0===a&&!l(t,s))return!0;var o=n[s],u=o&&o[G];if(u?u.t!==a:!c(o,a))return!0}}var h=!!t[G];return r.length!==z(t).length+(h?0:1)}function r(e){var t=e.k;if(t.length!==e.t.length)return!0;var n=Object.getOwnPropertyDescriptor(t,t.length-1);if(n&&!n.get)return!0;for(var r=0;r<t.length;r++)if(!t.hasOwnProperty(r))return!0;return!1}var s,o={};s={J:function(t,n){var r=Array.isArray(t),i=function(t,n){if(t){for(var r=Array(n.length),i=0;i<n.length;i++)Object.defineProperty(r,""+i,e(i,!0));return r}var s=K(n);delete s[G];for(var a=z(s),o=0;o<a.length;o++){var l=a[o];s[l]=e(l,t||!!s[l].enumerable)}return Object.create(Object.getPrototypeOf(n),s)}(r,t),s={i:r?5:4,A:n?n.A:M,P:!1,I:!1,R:{},l:n,t:t,k:i,o:null,g:!1,C:!1};return Object.defineProperty(i,G,{value:s,writable:!0}),i},S:function(e,n,s){s?i(n)&&n[G].A===e&&t(e.p):(e.u&&function e(t){if(t&&"object"==typeof t){var n=t[G];if(n){var i=n.t,s=n.k,o=n.R,u=n.i;if(4===u)a(s,function(t){t!==G&&(void 0!==i[t]||l(i,t)?o[t]||e(s[t]):(o[t]=!0,N(n)))}),a(i,function(e){void 0!==s[e]||l(s,e)||(o[e]=!1,N(n))});else if(5===u){if(r(n)&&(N(n),o.length=!0),s.length<i.length)for(var c=s.length;c<i.length;c++)o[c]=!1;else for(var h=i.length;h<s.length;h++)o[h]=!0;for(var d=Math.min(s.length,i.length),f=0;f<d;f++)s.hasOwnProperty(f)||(o[f]=!0),void 0===o[f]&&e(s[f])}}}}(e.p[0]),t(e.p))},K:function(e){return 4===e.i?n(e):r(e)}},Y.ES5||(Y.ES5=s)}()},8518:function(e,t,n){"use strict";function r(){return"undefined"!=typeof __SENTRY_BROWSER_BUNDLE__&&!!__SENTRY_BROWSER_BUNDLE__}function i(){return"npm"}n.d(t,{S:function(){return i},n:function(){return r}})},1422:function(e,t,n){"use strict";n.d(t,{KV:function(){return s},l$:function(){return a}});var r=n(8518);e=n.hmd(e);var i=n(3454);function s(){return!(0,r.n)()&&"[object process]"===Object.prototype.toString.call(void 0!==i?i:0)}function a(e,t){return e.require(t)}},1170:function(e,t,n){"use strict";n.d(t,{Z1:function(){return h},ph:function(){return c},yW:function(){return u}});var r=n(1422),i=n(1235);e=n.hmd(e);let s=(0,i.Rf)(),a={nowSeconds:()=>Date.now()/1e3},o=(0,r.KV)()?function(){try{let t=(0,r.l$)(e,"perf_hooks");return t.performance}catch(n){return}}():function(){let{performance:e}=s;if(!e||!e.now)return;let t=Date.now()-e.now();return{now:()=>e.now(),timeOrigin:t}}(),l=void 0===o?a:{nowSeconds:()=>(o.timeOrigin+o.now())/1e3},u=a.nowSeconds.bind(a),c=l.nowSeconds.bind(l),h=(()=>{let{performance:e}=s;if(!e||!e.now)return;let t=e.now(),n=Date.now(),r=e.timeOrigin?Math.abs(e.timeOrigin+t-n):36e5,i=e.timing&&e.timing.navigationStart,a="number"==typeof i?Math.abs(i+t-n):36e5;return r<36e5||a<36e5?r<=a?e.timeOrigin:i:n})()},1235:function(e,t,n){"use strict";function r(e){return e&&e.Math==Math?e:void 0}n.d(t,{Rf:function(){return s},YO:function(){return a},n2:function(){return i}});let i="object"==typeof globalThis&&r(globalThis)||"object"==typeof window&&r(window)||"object"==typeof self&&r(self)||"object"==typeof n.g&&r(n.g)||function(){return this}()||{};function s(){return i}function a(e,t,n){let r=n||i,s=r.__SENTRY__=r.__SENTRY__||{},a=s[e]||(s[e]=t());return a}},6661:function(e,t,n){"use strict";n.d(t,{fv:function(){return p}});var r,i,s,a,o,l,u=function(){function e(e){this.parent=e}return e.prototype.send=function(e,t){this.parent.createSingletonIfNecessary(),window.$crisp.push(["do","message:send",[e,t]])},e.prototype.sendText=function(e){this.send("text",e)},e.prototype.sendFile=function(e){this.send("file",e)},e.prototype.sendAnimation=function(e){this.send("animation",e)},e.prototype.sendAudio=function(e){this.send("audio",e)},e.prototype.show=function(e,t){this.parent.createSingletonIfNecessary(),window.$crisp.push(["do","message:show",[e,t]])},e.prototype.showText=function(e){this.show("text",e)},e.prototype.showFile=function(e){this.show("file",e)},e.prototype.showAnimation=function(e){this.show("animation",e)},e.prototype.showAudio=function(e){this.show("audio",e)},e.prototype.showPicker=function(e){this.show("picker",e)},e.prototype.showField=function(e){this.show("field",e)},e.prototype.showCarousel=function(e){this.show("carousel",e)},e.prototype.markAsRead=function(){this.parent.createSingletonIfNecessary(),window.$crisp.push(["do","message:read"])},e.prototype.onMessageSent=function(e){this.parent.createSingletonIfNecessary(),window.$crisp.push(["off","message:sent"]),window.$crisp.push(["on","message:sent",e])},e.prototype.onMessageReceived=function(e){this.parent.createSingletonIfNecessary(),window.$crisp.push(["off","message:received"]),window.$crisp.push(["on","message:received",e])},e.prototype.onMessageComposeSent=function(e){this.parent.createSingletonIfNecessary(),window.$crisp.push(["off","message:compose:sent"]),window.$crisp.push(["on","message:compose:sent",e])},e.prototype.onMessageComposeReceive=function(e){this.parent.createSingletonIfNecessary(),window.$crisp.push(["off","message:compose:received"]),window.$crisp.push(["on","message:compose:received",e])},e}(),c=function(){function e(e){this.parent=e}return e.prototype.setNickname=function(e){this.parent.createSingletonIfNecessary(),window.$crisp.push(["set","user:nickname",[e]])},e.prototype.setEmail=function(e,t){this.parent.createSingletonIfNecessary(),window.$crisp.push(["set","user:email",[e,t]])},e.prototype.setPhone=function(e){this.parent.createSingletonIfNecessary(),window.$crisp.push(["set","user:phone",[e]])},e.prototype.setAvatar=function(e){this.parent.createSingletonIfNecessary(),window.$crisp.push(["set","user:avatar",[e]])},e.prototype.setCompany=function(e,t){var n={};t&&t.url&&(n.url=t.url),t&&t.description&&(n.description=t.description),t&&t.employment&&(n.employment=[t.employment.title],t.employment.role&&n.employment.push(t.employment.role)),this.parent.createSingletonIfNecessary(),window.$crisp.push(["set","user:company",[e,n]])},e.prototype.getEmail=function(){return this.parent.isCrispInjected()?window.$crisp.get("user:email"):null},e.prototype.getPhone=function(){return this.parent.isCrispInjected()?window.$crisp.get("user:phone"):null},e.prototype.getNickname=function(){return this.parent.isCrispInjected()?window.$crisp.get("user:nickname"):null},e.prototype.getAvatar=function(){return this.parent.isCrispInjected()?window.$crisp.get("user:avatar"):null},e.prototype.getCompany=function(){return this.parent.isCrispInjected()?window.$crisp.get("user:company"):null},e.prototype.onEmailChanged=function(e){this.parent.isCrispInjected()&&(window.$crisp.push(["off","user:email:changed"]),window.$crisp.push(["on","user:email:changed",e]))},e.prototype.onPhoneChanged=function(e){this.parent.isCrispInjected()&&(window.$crisp.push(["off","user:phone:changed"]),window.$crisp.push(["on","user:phone:changed",e]))},e.prototype.onNicknameChanged=function(e){this.parent.isCrispInjected()&&(window.$crisp.push(["off","user:nickname:changed"]),window.$crisp.push(["on","user:nickname:changed",e]))},e.prototype.onAvatarChanged=function(e){this.parent.isCrispInjected()&&(window.$crisp.push(["off","user:avatar:changed"]),window.$crisp.push(["on","user:avatar:changed",e]))},e}(),h=function(){function e(e){this.parent=e}return e.prototype.run=function(e){this.parent.createSingletonIfNecessary(),window.$crisp.push(["do","trigger:run",[e]])},e}();(r=a||(a={})).Red="red",r.Orange="orange",r.Yellow="yellow",r.Green="green",r.Blue="blue",r.Purple="purple",r.Pink="pink",r.Brown="brown",r.Grey="grey",r.Black="black";var d=function(){function e(e){this.parent=e}return e.prototype.reset=function(e){void 0===e&&(e=!1),this.parent.isCrispInjected()&&window.$crisp.do("session:reset",[e])},e.prototype.setSegments=function(e,t){this.parent.createSingletonIfNecessary(),$crisp.push(["set","session:segments",[e,t]])},e.prototype.setData=function(e){var t=this,n=[];Object.entries(e).forEach(function(e){t.isValidDataValue(e[0])&&n.push([e[0],e[1]])}),this.parent.createSingletonIfNecessary(),$crisp.push(["set","session:data",[n]])},e.prototype.pushEvent=function(e,t,n){void 0===t&&(t={}),void 0===n&&(n=a.Blue),this.parent.isCrispInjected()&&window.$crisp.push(["set","session:event",[[[e,t,n]]]])},e.prototype.getData=function(e){if(this.parent.isCrispInjected())return window.$crisp.get("session:data",e)},e.prototype.getIdentifier=function(){return this.parent.isCrispInjected()?window.$crisp.get("session:identifier"):null},e.prototype.onLoaded=function(e){this.parent.createSingletonIfNecessary(),window.$crisp.push(["off","session:loaded"]),window.$crisp.push(["on","session:loaded",e])},e.prototype.isValidDataValue=function(e){return"string"==typeof e||"number"==typeof e||"boolean"==typeof e},e}(),f=function(){function e(e){this.parent=e}return e.prototype.show=function(){this.parent.autoInjectIfNecessasy(),window.$crisp.push(["do","chat:show"])},e.prototype.hide=function(){this.parent.autoInjectIfNecessasy(),window.$crisp.push(["do","chat:hide"])},e.prototype.open=function(){this.parent.autoInjectIfNecessasy(),window.$crisp.push(["do","chat:open"])},e.prototype.close=function(){this.parent.isCrispInjected()&&window.$crisp.push(["do","chat:close"])},e.prototype.unreadCount=function(){return this.parent.isCrispInjected()?window.$crisp.get("chat:unread:count"):0},e.prototype.isChatOpened=function(){return!!this.parent.isCrispInjected()&&window.$crisp.is("chat:opened")},e.prototype.isVisible=function(){return!!this.parent.isCrispInjected()&&window.$crisp.is("chat:visible")},e.prototype.onChatInitiated=function(e){this.parent.createSingletonIfNecessary(),window.$crisp.push(["off","chat:initiated"]),window.$crisp.push(["on","chat:initiated",e])},e.prototype.onChatOpened=function(e){this.parent.createSingletonIfNecessary(),window.$crisp.push(["off","chat:opened"]),window.$crisp.push(["on","chat:opened",e])},e.prototype.onChatClose=function(e){this.parent.createSingletonIfNecessary(),window.$crisp.push(["off","chat:closed"]),window.$crisp.push(["on","chat:closed",e])},e}();(i=o||(o={})).Default="default",i.Amber="amber",i.Black="black",i.Blue="blue",i.BlueGrey="blue_grey",i.LightBlue="light_blue",i.Brown="brown",i.Cyan="cyan",i.Green="green",i.LightGreen="light_green",i.Grey="grey",i.Indigo="indigo",i.Orange="orange",i.DeepOrange="deep_orange",i.Pink="pink",i.Purple="purple",i.DeepPurple="deep_purple",i.Red="red",i.Teal="teal",(s=l||(l={})).Left="left",s.Right="right";var p=new(function(){function e(){this.clientUrl="https://client.crisp.chat/l.js",this.websiteId="",this.autoload=!0,this.injected=!1,this.chat=new f(this),this.session=new d(this),this.user=new c(this),this.message=new u(this),this.trigger=new h(this)}return e.prototype.configure=function(e,t){void 0===t&&(t={}),this.websiteId=e,this.tokenId=t.tokenId,this.locale=t.locale,this.sessionMerge=t.sessionMerge,this.cookieDomain=t.cookieDomain,this.lockFullview=t.lockFullview,this.lockMaximized=t.lockMaximized,this.safeMode=t.safeMode,void 0!==t.clientUrl&&(this.clientUrl=t.clientUrl),void 0!==t.autoload&&(this.autoload=t.autoload),this.autoload&&this.load()},e.prototype.load=function(){var e=document.getElementsByTagName("head");if(this.createSingletonIfNecessary(),!0!==this.isCrispInjected()){if(!this.websiteId)throw Error("websiteId must be set before loading Crisp");if(window.CRISP_WEBSITE_ID=this.websiteId,window.CRISP_RUNTIME_CONFIG={},this.tokenId&&(window.CRISP_TOKEN_ID=this.tokenId),this.sessionMerge&&(window.CRISP_RUNTIME_CONFIG.session_merge=!0),this.locale&&(window.CRISP_RUNTIME_CONFIG.locale=this.locale),this.lockFullview&&(window.CRISP_RUNTIME_CONFIG.lock_full_view=!0),this.lockMaximized&&(window.CRISP_RUNTIME_CONFIG.lock_maximized=!0),this.cookieDomain&&(window.CRISP_COOKIE_DOMAIN=this.cookieDomain),this.cookieExpire&&(window.CRISP_COOKIE_EXPIRE=this.cookieExpire),!e||!e[0])return this.deferredLoading();!0===this.safeMode&&this.setSafeMode(!0);var t=document.createElement("script");t.src=this.clientUrl,t.async=!0,e[0].appendChild(t),this.injected=!0}},e.prototype.setTokenId=function(e){this.tokenId=e,!0===this.isCrispInjected()&&(e?window.CRISP_TOKEN_ID=e:delete window.CRISP_TOKEN_ID)},e.prototype.setZIndex=function(e){this.createSingletonIfNecessary(),window.$crisp.push(["config","container:index",[e]])},e.prototype.setColorTheme=function(e){this.createSingletonIfNecessary(),window.$crisp.push(["config","color:theme",[e]])},e.prototype.setHideOnAway=function(e){this.createSingletonIfNecessary(),window.$crisp.push(["config","hide:on:away",[e]])},e.prototype.setHideOnMobile=function(e){this.createSingletonIfNecessary(),window.$crisp.push(["config","hide:on:mobile",[e]])},e.prototype.setPosition=function(e){this.createSingletonIfNecessary(),$crisp.push(["config","position:reverse",[e===l.Left]])},e.prototype.setAvailabilityTooltip=function(e){this.createSingletonIfNecessary(),window.$crisp.push(["config","availability:tooltip",[e]])},e.prototype.setVacationMode=function(e){this.createSingletonIfNecessary(),window.$crisp.push(["config","hide:vacation",[e]])},e.prototype.setSafeMode=function(e){void 0===e&&(e=!0),this.createSingletonIfNecessary(),window.$crisp.push(["safe",e])},e.prototype.muteSound=function(e){this.createSingletonIfNecessary(),window.$crisp.push(["config","sound:mute",[e]])},e.prototype.toggleOperatorCount=function(e){this.createSingletonIfNecessary(),window.$crisp.push(["config","show:operator:count",[e]])},e.prototype.createSingletonIfNecessary=function(){void 0===window.$crisp&&(window.$crisp=[])},e.prototype.autoInjectIfNecessasy=function(){this.isCrispInjected()||this.load()},e.prototype.isCrispInjected=function(){return!0===this.injected||!!window.$crisp&&!!window.$crisp.is},e.prototype.deferredLoading=function(){var e=this;document.addEventListener("DOMContentLoaded",function(){e.load()})},e}())},8679:function(e,t,n){"use strict";var r=n(9864),i={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},s={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},a={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},o={};function l(e){return r.isMemo(e)?a:o[e.$$typeof]||i}o[r.ForwardRef]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},o[r.Memo]=a;var u=Object.defineProperty,c=Object.getOwnPropertyNames,h=Object.getOwnPropertySymbols,d=Object.getOwnPropertyDescriptor,f=Object.getPrototypeOf,p=Object.prototype;e.exports=function e(t,n,r){if("string"!=typeof n){if(p){var i=f(n);i&&i!==p&&e(t,i,r)}var a=c(n);h&&(a=a.concat(h(n)));for(var o=l(t),m=l(n),g=0;g<a.length;++g){var y=a[g];if(!s[y]&&!(r&&r[y])&&!(m&&m[y])&&!(o&&o[y])){var _=d(n,y);try{u(t,y,_)}catch(v){}}}}return t}},3454:function(e,t,n){"use strict";var r,i;e.exports=(null==(r=n.g.process)?void 0:r.env)&&"object"==typeof(null==(i=n.g.process)?void 0:i.env)?n.g.process:n(7663)},1118:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/_app",function(){return n(5222)}])},1338:function(e,t,n){"use strict";let r,i,s,a,o,l,u;n.d(t,{I8:function(){return e8},G6:function(){return tE},A0:function(){return tI},db:function(){return e5},kd:function(){return e7},O1:function(){return tv},sd:function(){return tS},X7:function(){return tc},VL:function(){return ta},Sy:function(){return tu},k5:function(){return to},i2:function(){return tp},mD:function(){return th},xW:function(){return tl},EQ:function(){return tm},Kz:function(){return ti},pk:function(){return ts},KL:function(){return ty},Xp:function(){return t_},PR:function(){return tt},LO:function(){return td},Vf:function(){return tf},t5:function(){return tw},z4:function(){return tb},qj:function(){return te},ou:function(){return tg},Ix:function(){return tn},Ho:function(){return tr}});var c,h=n(7456);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ (0,h.KN)("firebase","9.21.0","app");var d=n(841),f=n(6100),p=n(1367),m=n(9709),g=n(6998),y=n(3333),_=n(4444),v=n(8463);let w=(e,t)=>t.some(t=>e instanceof t),b=new WeakMap,E=new WeakMap,I=new WeakMap,S=new WeakMap,T=new WeakMap,D={get(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return E.get(e);if("objectStoreNames"===t)return e.objectStoreNames||I.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return x(e[t])},set:(e,t,n)=>(e[t]=n,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function x(e){var t;if(e instanceof IDBRequest)return function(e){let t=new Promise((t,n)=>{let r=()=>{e.removeEventListener("success",i),e.removeEventListener("error",s)},i=()=>{t(x(e.result)),r()},s=()=>{n(e.error),r()};e.addEventListener("success",i),e.addEventListener("error",s)});return t.then(t=>{t instanceof IDBCursor&&b.set(t,e)}).catch(()=>{}),T.set(t,e),t}(e);if(S.has(e))return S.get(e);let n="function"==typeof(t=e)?t!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(i||(i=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(t)?function(...e){return t.apply(k(this),e),x(b.get(this))}:function(...e){return x(t.apply(k(this),e))}:function(e,...n){let r=t.call(k(this),e,...n);return I.set(r,e.sort?e.sort():[e]),x(r)}:(t instanceof IDBTransaction&&function(e){if(E.has(e))return;let t=new Promise((t,n)=>{let r=()=>{e.removeEventListener("complete",i),e.removeEventListener("error",s),e.removeEventListener("abort",s)},i=()=>{t(),r()},s=()=>{n(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",i),e.addEventListener("error",s),e.addEventListener("abort",s)});E.set(e,t)}(t),w(t,r||(r=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])))?new Proxy(t,D):t;return n!==e&&(S.set(e,n),T.set(n,e)),n}let k=e=>T.get(e),C=["get","getKey","getAll","getAllKeys","count"],N=["put","add","delete","clear"],R=new Map;function A(e,t){if(!(e instanceof IDBDatabase&&!(t in e)&&"string"==typeof t))return;if(R.get(t))return R.get(t);let n=t.replace(/FromIndex$/,""),r=t!==n,i=N.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(i||C.includes(n)))return;let s=async function(e,...t){let s=this.transaction(e,i?"readwrite":"readonly"),a=s.store;return r&&(a=a.index(t.shift())),(await Promise.all([a[n](...t),i&&s.done]))[0]};return R.set(t,s),s}D={...c=D,get:(e,t,n)=>A(e,t)||c.get(e,t,n),has:(e,t)=>!!A(e,t)||c.has(e,t)};let O="@firebase/installations",P="0.6.4",L=`w:${P}`,M="FIS_v2",U=new _.LL("installations","Installations",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."});function F(e){return e instanceof _.ZR&&e.code.includes("request-failed")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ function j({projectId:e}){return`https://firebaseinstallations.googleapis.com/v1/projects/${e}/installations`}function B(e){return{token:e.token,requestStatus:2,expiresIn:Number(e.expiresIn.replace("s","000")),creationTime:Date.now()}}async function $(e,t){let n=await t.json(),r=n.error;return U.create("request-failed",{requestName:e,serverCode:r.code,serverMessage:r.message,serverStatus:r.status})}function V({apiKey:e}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":e})}async function G(e){let t=await e();return t.status>=500&&t.status<600?e():t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ async function q({appConfig:e,heartbeatServiceProvider:t},{fid:n}){let r=j(e),i=V(e),s=t.getImmediate({optional:!0});if(s){let a=await s.getHeartbeatsHeader();a&&i.append("x-firebase-client",a)}let o={fid:n,authVersion:M,appId:e.appId,sdkVersion:L},l={method:"POST",headers:i,body:JSON.stringify(o)},u=await G(()=>fetch(r,l));if(u.ok){let c=await u.json(),h={fid:c.fid||n,registrationStatus:2,refreshToken:c.refreshToken,authToken:B(c.authToken)};return h}throw await $("Create Installation",u)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ function z(e){return new Promise(t=>{setTimeout(t,e)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ let K=/^[cdef][\w-]{21}$/;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ function Y(e){return`${e.appName}!${e.appId}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ let H=new Map;function W(e,t){let n=Y(e);Q(n,t),function(e,t){let n=(!X&&"BroadcastChannel"in self&&((X=new BroadcastChannel("[Firebase] FID Change")).onmessage=e=>{Q(e.data.key,e.data.fid)}),X);n&&n.postMessage({key:e,fid:t}),0===H.size&&X&&(X.close(),X=null)}(n,t)}function Q(e,t){let n=H.get(e);if(n)for(let r of n)r(t)}let X=null,J="firebase-installations-store",Z=null;function ee(){return Z||(Z=function(e,t,{blocked:n,upgrade:r,blocking:i,terminated:s}={}){let a=indexedDB.open(e,1),o=x(a);return r&&a.addEventListener("upgradeneeded",e=>{r(x(a.result),e.oldVersion,e.newVersion,x(a.transaction))}),n&&a.addEventListener("blocked",()=>n()),o.then(e=>{s&&e.addEventListener("close",()=>s()),i&&e.addEventListener("versionchange",()=>i())}).catch(()=>{}),o}("firebase-installations-database",0,{upgrade(e,t){0===t&&e.createObjectStore(J)}})),Z}async function et(e,t){let n=Y(e),r=await ee(),i=r.transaction(J,"readwrite"),s=i.objectStore(J),a=await s.get(n);return await s.put(t,n),await i.done,a&&a.fid===t.fid||W(e,t.fid),t}async function en(e){let t=Y(e),n=await ee(),r=n.transaction(J,"readwrite");await r.objectStore(J).delete(t),await r.done}async function er(e,t){let n=Y(e),r=await ee(),i=r.transaction(J,"readwrite"),s=i.objectStore(J),a=await s.get(n),o=t(a);return void 0===o?await s.delete(n):await s.put(o,n),await i.done,o&&(!a||a.fid!==o.fid)&&W(e,o.fid),o}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ async function ei(e){let t;let n=await er(e.appConfig,n=>{let r=function(e){let t=e||{fid:function(){try{let e=new Uint8Array(17),t=self.crypto||self.msCrypto;t.getRandomValues(e),e[0]=112+e[0]%16;let n=function(e){let t=/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ function(e){let t=btoa(String.fromCharCode(...e));return t.replace(/\+/g,"-").replace(/\//g,"_")}(e);return t.substr(0,22)}(e);return K.test(n)?n:""}catch(r){return""}}(),registrationStatus:0};return el(t)}(n),i=function(e,t){if(0===t.registrationStatus){if(!navigator.onLine){let n=Promise.reject(U.create("app-offline"));return{installationEntry:t,registrationPromise:n}}let r={fid:t.fid,registrationStatus:1,registrationTime:Date.now()},i=es(e,r);return{installationEntry:r,registrationPromise:i}}return 1===t.registrationStatus?{installationEntry:t,registrationPromise:ea(e)}:{installationEntry:t}}(e,r);return t=i.registrationPromise,i.installationEntry});return""===n.fid?{installationEntry:await t}:{installationEntry:n,registrationPromise:t}}async function es(e,t){try{let n=await q(e,t);return et(e.appConfig,n)}catch(r){throw F(r)&&409===r.customData.serverCode?await en(e.appConfig):await et(e.appConfig,{fid:t.fid,registrationStatus:0}),r}}async function ea(e){let t=await eo(e.appConfig);for(;1===t.registrationStatus;)await z(100),t=await eo(e.appConfig);if(0===t.registrationStatus){let{installationEntry:n,registrationPromise:r}=await ei(e);return r||n}return t}function eo(e){return er(e,e=>{if(!e)throw U.create("installation-not-found");return el(e)})}function el(e){return 1===e.registrationStatus&&e.registrationTime+1e4<Date.now()?{fid:e.fid,registrationStatus:0}:e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ async function eu({appConfig:e,heartbeatServiceProvider:t},n){let r=function(e,{fid:t}){return`${j(e)}/${t}/authTokens:generate`}(e,n),i=function(e,{refreshToken:t}){let n=V(e);return n.append("Authorization",`${M} ${t}`),n}(e,n),s=t.getImmediate({optional:!0});if(s){let a=await s.getHeartbeatsHeader();a&&i.append("x-firebase-client",a)}let o={installation:{sdkVersion:L,appId:e.appId}},l={method:"POST",headers:i,body:JSON.stringify(o)},u=await G(()=>fetch(r,l));if(u.ok){let c=await u.json(),h=B(c);return h}throw await $("Generate Auth Token",u)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ async function ec(e,t=!1){let n;let r=await er(e.appConfig,r=>{var i;if(!ep(r))throw U.create("not-registered");let s=r.authToken;if(!t&&2===(i=s).requestStatus&&!function(e){let t=Date.now();return t<e.creationTime||e.creationTime+e.expiresIn<t+36e5}(i))return r;if(1===s.requestStatus)return n=eh(e,t),r;{if(!navigator.onLine)throw U.create("app-offline");let a=function(e){let t={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},e),{authToken:t})}(r);return n=ef(e,a),a}}),i=n?await n:r.authToken;return i}async function eh(e,t){let n=await ed(e.appConfig);for(;1===n.authToken.requestStatus;)await z(100),n=await ed(e.appConfig);let r=n.authToken;return 0===r.requestStatus?ec(e,t):r}function ed(e){return er(e,e=>{if(!ep(e))throw U.create("not-registered");let t=e.authToken;return 1===t.requestStatus&&t.requestTime+1e4<Date.now()?Object.assign(Object.assign({},e),{authToken:{requestStatus:0}}):e})}async function ef(e,t){try{let n=await eu(e,t),r=Object.assign(Object.assign({},t),{authToken:n});return await et(e.appConfig,r),n}catch(s){if(F(s)&&(401===s.customData.serverCode||404===s.customData.serverCode))await en(e.appConfig);else{let i=Object.assign(Object.assign({},t),{authToken:{requestStatus:0}});await et(e.appConfig,i)}throw s}}function ep(e){return void 0!==e&&2===e.registrationStatus}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ async function em(e){let{installationEntry:t,registrationPromise:n}=await ei(e);return n?n.catch(console.error):ec(e).catch(console.error),t.fid}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ async function eg(e,t=!1){await ey(e);let n=await ec(e,t);return n.token}async function ey(e){let{registrationPromise:t}=await ei(e);t&&await t}function e_(e){return U.create("missing-app-config-values",{valueName:e})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ let ev="installations",ew=e=>{let t=e.getProvider("app").getImmediate(),n=/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ function(e){if(!e||!e.options)throw e_("App Configuration");if(!e.name)throw e_("App Name");for(let t of["projectId","apiKey","appId"])if(!e.options[t])throw e_(t);return{appName:e.name,projectId:e.options.projectId,apiKey:e.options.apiKey,appId:e.options.appId}}(t),r=(0,h.qX)(t,"heartbeat");return{app:t,appConfig:n,heartbeatServiceProvider:r,_delete:()=>Promise.resolve()}},eb=e=>{let t=e.getProvider("app").getImmediate(),n=(0,h.qX)(t,ev).getImmediate();return{getId:()=>em(n),getToken:e=>eg(n,e)}};(0,h.Xd)(new v.wA(ev,ew,"PUBLIC")),(0,h.Xd)(new v.wA("installations-internal",eb,"PRIVATE")),(0,h.KN)(O,P),(0,h.KN)(O,P,"esm2017");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ let eE="analytics",eI="https://www.googletagmanager.com/gtag/js",eS=new y.Yd("@firebase/analytics"),eT=new _.LL("analytics","Analytics",{"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-intialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."});/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ function eD(e){if(!e.startsWith(eI)){let t=eT.create("invalid-gtag-resource",{gtagURL:e});return eS.warn(t.message),""}return e}function ex(e){return Promise.all(e.map(e=>e.catch(e=>e)))}async function ek(e,t,n,r,i,s){let a=r[i];try{if(a)await t[a];else{let o=await ex(n),l=o.find(e=>e.measurementId===i);l&&await t[l.appId]}}catch(u){eS.error(u)}e("config",i,s)}async function eC(e,t,n,r,i){try{let s=[];if(i&&i.send_to){let a=i.send_to;Array.isArray(a)||(a=[a]);let o=await ex(n);for(let l of a){let u=o.find(e=>e.measurementId===l),c=u&&t[u.appId];if(c)s.push(c);else{s=[];break}}}0===s.length&&(s=Object.values(t)),await Promise.all(s),e("event",r,i||{})}catch(h){eS.error(h)}}let eN=new class{constructor(e={},t=1e3){this.throttleMetadata=e,this.intervalMillis=t}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,t){this.throttleMetadata[e]=t}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}};async function eR(e){var t;let{appId:n,apiKey:r}=e,i={method:"GET",headers:new Headers({Accept:"application/json","x-goog-api-key":r})},s="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig".replace("{app-id}",n),a=await fetch(s,i);if(200!==a.status&&304!==a.status){let o="";try{let l=await a.json();(null===(t=l.error)||void 0===t?void 0:t.message)&&(o=l.error.message)}catch(u){}throw eT.create("config-fetch-failed",{httpStatus:a.status,responseMessage:o})}return a.json()}async function eA(e,t=eN,n){let{appId:r,apiKey:i,measurementId:s}=e.options;if(!r)throw eT.create("no-app-id");if(!i){if(s)return{measurementId:s,appId:r};throw eT.create("no-api-key")}let a=t.getThrottleMetadata(r)||{backoffCount:0,throttleEndTimeMillis:Date.now()},o=new eP;return setTimeout(async()=>{o.abort()},void 0!==n?n:6e4),eO({appId:r,apiKey:i,measurementId:s},a,o,t)}async function eO(e,{throttleEndTimeMillis:t,backoffCount:n},r,i=eN){var s;let{appId:a,measurementId:o}=e;try{await new Promise((e,n)=>{let i=Math.max(t-Date.now(),0),s=setTimeout(e,i);r.addEventListener(()=>{clearTimeout(s),n(eT.create("fetch-throttle",{throttleEndTimeMillis:t}))})})}catch(l){if(o)return eS.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${o} provided in the "measurementId" field in the local Firebase config. [${null==l?void 0:l.message}]`),{appId:a,measurementId:o};throw l}try{let u=await eR(e);return i.deleteThrottleMetadata(a),u}catch(d){if(!function(e){if(!(e instanceof _.ZR)||!e.customData)return!1;let t=Number(e.customData.httpStatus);return 429===t||500===t||503===t||504===t}(d)){if(i.deleteThrottleMetadata(a),o)return eS.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${o} provided in the "measurementId" field in the local Firebase config. [${null==d?void 0:d.message}]`),{appId:a,measurementId:o};throw d}let c=503===Number(null===(s=null==d?void 0:d.customData)||void 0===s?void 0:s.httpStatus)?(0,_.$s)(n,i.intervalMillis,30):(0,_.$s)(n,i.intervalMillis),h={throttleEndTimeMillis:Date.now()+c,backoffCount:n+1};return i.setThrottleMetadata(a,h),eS.debug(`Calling attemptFetch again in ${c} millis`),eO(e,h,r,i)}}class eP{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}}async function eL(e,t,n,r,i){if(i&&i.global){e("event",n,r);return}{let s=await t,a=Object.assign(Object.assign({},r),{send_to:s});e("event",n,a)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ async function eM(){if(!(0,_.hl)())return eS.warn(eT.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;try{await (0,_.eu)()}catch(e){return eS.warn(eT.create("indexeddb-unavailable",{errorInfo:null==e?void 0:e.toString()}).message),!1}return!0}async function eU(e,t,n,r,i,o,l){var u;let c=eA(e);c.then(t=>{n[t.measurementId]=t.appId,e.options.measurementId&&t.measurementId!==e.options.measurementId&&eS.warn(`The measurement ID in the local Firebase config (${e.options.measurementId}) does not match the measurement ID fetched from the server (${t.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(e=>eS.error(e)),t.push(c);let h=eM().then(e=>e?r.getId():void 0),[d,f]=await Promise.all([c,h]);!function(e){let t=window.document.getElementsByTagName("script");for(let n of Object.values(t))if(n.src&&n.src.includes(eI)&&n.src.includes(e))return n;return null}(o)&&function(e,t){let n;let r=(window.trustedTypes&&(n=window.trustedTypes.createPolicy("firebase-js-sdk-policy",{createScriptURL:eD})),n),i=document.createElement("script"),s=`${eI}?l=${e}&id=${t}`;i.src=r?null==r?void 0:r.createScriptURL(s):s,i.async=!0,document.head.appendChild(i)}(o,d.measurementId),a&&(i("consent","default",a),a=void 0),i("js",new Date);let p=null!==(u=null==l?void 0:l.config)&&void 0!==u?u:{};return p.origin="firebase",p.update=!0,null!=f&&(p.firebase_id=f),i("config",d.measurementId,p),s&&(i("set",s),s=void 0),d.measurementId}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ class eF{constructor(e){this.app=e}_delete(){return delete ej[this.app.options.appId],Promise.resolve()}}let ej={},eB=[],e$={},eV="dataLayer",eG=!1,eq="@firebase/analytics",ez="0.10.0";function eK(e,t){let n={};for(let r in e)e.hasOwnProperty(r)&&(n[r]=t(e[r]));return n}function eY(e){if(null==e)return e;if(e["@type"])switch(e["@type"]){case"type.googleapis.com/google.protobuf.Int64Value":case"type.googleapis.com/google.protobuf.UInt64Value":{let t=Number(e.value);if(isNaN(t))throw Error("Data cannot be decoded from JSON: "+e);return t}default:throw Error("Data cannot be decoded from JSON: "+e)}return Array.isArray(e)?e.map(e=>eY(e)):"function"==typeof e||"object"==typeof e?eK(e,e=>eY(e)):e}(0,h.Xd)(new v.wA(eE,(e,{options:t})=>{let n=e.getProvider("app").getImmediate(),r=e.getProvider("installations-internal").getImmediate();return function(e,t,n){!function(){let e=[];if((0,_.ru)()&&e.push("This is a browser extension environment."),(0,_.zI)()||e.push("Cookies are not available."),e.length>0){let t=e.map((e,t)=>`(${t+1}) ${e}`).join(" "),n=eT.create("invalid-analytics-context",{errorInfo:t});eS.warn(n.message)}}();let r=e.options.appId;if(!r)throw eT.create("no-app-id");if(!e.options.apiKey){if(e.options.measurementId)eS.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${e.options.measurementId} provided in the "measurementId" field in the local Firebase config.`);else throw eT.create("no-api-key")}if(null!=ej[r])throw eT.create("already-exists",{id:r});if(!eG){var i,s;let a,u;a=[],Array.isArray(window[eV])?a=window[eV]:window[eV]=a;let{wrappedGtag:c,gtagCore:h}=(i="gtag",u=function(...e){window[eV].push(arguments)},window[i]&&"function"==typeof window[i]&&(u=window[i]),window[i]=(s=u,async function(e,...t){try{if("event"===e){let[n,r]=t;await eC(s,ej,eB,n,r)}else if("config"===e){let[i,a]=t;await ek(s,ej,eB,e$,i,a)}else if("consent"===e){let[o]=t;s("consent","update",o)}else if("get"===e){let[l,u,c]=t;s("get",l,u,c)}else if("set"===e){let[h]=t;s("set",h)}else s(e,...t)}catch(d){eS.error(d)}}),{gtagCore:u,wrappedGtag:window[i]});l=c,o=h,eG=!0}ej[r]=eU(e,eB,e$,t,o,eV,n);let d=new eF(e);return d}(n,r,t)},"PUBLIC")),(0,h.Xd)(new v.wA("analytics-internal",function(e){try{let t=e.getProvider(eE).getImmediate();return{logEvent:(e,n,r)=>(function(e,t,n,r){eL(l,ej[(e=(0,_.m9)(e)).app.options.appId],t,n,r).catch(e=>eS.error(e))})(t,e,n,r)}}catch(n){throw eT.create("interop-component-reg-failed",{reason:n})}},"PRIVATE")),(0,h.KN)(eq,ez),(0,h.KN)(eq,ez,"esm2017");/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ let eH="functions",eW={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class eQ extends _.ZR{constructor(e,t,n){super(`${eH}/${e}`,t||""),this.details=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ class eX{constructor(e,t,n){this.auth=null,this.messaging=null,this.appCheck=null,this.auth=e.getImmediate({optional:!0}),this.messaging=t.getImmediate({optional:!0}),this.auth||e.get().then(e=>this.auth=e,()=>{}),this.messaging||t.get().then(e=>this.messaging=e,()=>{}),this.appCheck||n.get().then(e=>this.appCheck=e,()=>{})}async getAuthToken(){if(this.auth)try{let e=await this.auth.getToken();return null==e?void 0:e.accessToken}catch(t){return}}async getMessagingToken(){if(this.messaging&&"Notification"in self&&"granted"===Notification.permission)try{return await this.messaging.getToken()}catch(e){return}}async getAppCheckToken(){if(this.appCheck){let e=await this.appCheck.getToken();return e.error?null:e.token}return null}async getContext(){let e=await this.getAuthToken(),t=await this.getMessagingToken(),n=await this.getAppCheckToken();return{authToken:e,messagingToken:t,appCheckToken:n}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ let eJ="us-central1";class eZ{constructor(e,t,n,r,i=eJ,s){this.app=e,this.fetchImpl=s,this.emulatorOrigin=null,this.contextProvider=new eX(t,n,r),this.cancelAllRequests=new Promise(e=>{this.deleteService=()=>Promise.resolve(e())});try{let a=new URL(i);this.customDomain=a.origin,this.region=eJ}catch(o){this.customDomain=null,this.region=i}}_delete(){return this.deleteService()}_url(e){let t=this.app.options.projectId;if(null!==this.emulatorOrigin){let n=this.emulatorOrigin;return`${n}/${t}/${this.region}/${e}`}return null!==this.customDomain?`${this.customDomain}/${e}`:`https://${this.region}-${t}.cloudfunctions.net/${e}`}}async function e0(e,t,n,r){let i;n["Content-Type"]="application/json";try{i=await r(e,{method:"POST",body:JSON.stringify(t),headers:n})}catch(s){return{status:0,json:null}}let a=null;try{a=await i.json()}catch(o){}return{status:i.status,json:a}}async function e1(e,t,n,r){let i;n=function e(t){if(null==t)return null;if(t instanceof Number&&(t=t.valueOf()),"number"==typeof t&&isFinite(t)||!0===t||!1===t||"[object String]"===Object.prototype.toString.call(t))return t;if(t instanceof Date)return t.toISOString();if(Array.isArray(t))return t.map(t=>e(t));if("function"==typeof t||"object"==typeof t)return eK(t,t=>e(t));throw Error("Data cannot be encoded in JSON: "+t)}(n);let s={data:n},a={},o=await e.contextProvider.getContext();o.authToken&&(a.Authorization="Bearer "+o.authToken),o.messagingToken&&(a["Firebase-Instance-ID-Token"]=o.messagingToken),null!==o.appCheckToken&&(a["X-Firebase-AppCheck"]=o.appCheckToken);let l=r.timeout||7e4,u=(i=null,{promise:new Promise((e,t)=>{i=setTimeout(()=>{t(new eQ("deadline-exceeded","deadline-exceeded"))},l)}),cancel(){i&&clearTimeout(i)}}),c=await Promise.race([e0(t,s,a,e.fetchImpl),u.promise,e.cancelAllRequests]);if(u.cancel(),!c)throw new eQ("cancelled","Firebase Functions instance was deleted.");let h=function(e,t){let n,r=function(e){if(e>=200&&e<300)return"ok";switch(e){case 0:case 500:return"internal";case 400:return"invalid-argument";case 401:return"unauthenticated";case 403:return"permission-denied";case 404:return"not-found";case 409:return"aborted";case 429:return"resource-exhausted";case 499:return"cancelled";case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline-exceeded"}return"unknown"}(e),i=r;try{let s=t&&t.error;if(s){let a=s.status;if("string"==typeof a){if(!eW[a])return new eQ("internal","internal");r=eW[a],i=a}let o=s.message;"string"==typeof o&&(i=o),n=s.details,void 0!==n&&(n=eY(n))}}catch(l){}return"ok"===r?null:new eQ(r,i,n)}(c.status,c.json);if(h)throw h;if(!c.json)throw new eQ("internal","Response is not valid JSON object.");let d=c.json.data;if(void 0===d&&(d=c.json.result),void 0===d)throw new eQ("internal","Response is missing data field.");let f=eY(d);return{data:f}}let e2="@firebase/functions",e4="0.9.4";!function(e,t){let n=(t,{instanceIdentifier:n})=>{let r=t.getProvider("app").getImmediate(),i=t.getProvider("auth-internal"),s=t.getProvider("messaging-internal"),a=t.getProvider("app-check-internal");return new eZ(r,i,s,a,n,e)};(0,h.Xd)(new v.wA(eH,n,"PUBLIC").setMultipleInstances(!0)),(0,h.KN)(e2,e4,void 0),(0,h.KN)(e2,e4,"esm2017")}(fetch.bind(self));var e9=n(1106);let e6=(0,h.C6)();u=0===e6.length?(0,h.ZF)({apiKey:"AIzaSyChdEQzA5V11u_fEab6i02KnVZq6L_gDN0",authDomain:"patterned-dev.firebaseapp.com",projectId:"patterned-dev",storageBucket:"patterned-dev.appspot.com",messagingSenderId:"749844832968",appId:"1:749844832968:web:fb435ad7c05c54508b7bfd",measurementId:"G-DWB3FQRJEY"}):(0,h.Mq)();let e5=(0,f.ad)(u);(0,f.ST)(e5).catch(e=>{"failed-precondition"===e.code||e.code});let e3=async e=>{if(null==e?void 0:e.uid){let t=(0,f.JU)(e5,"users",null==e?void 0:e.uid),n=await (0,f.QT)(t);if(n.exists()){let r=n.data();p.h.dispatch((0,m.av)({...r}))}else{let i=null==e?void 0:e.displayName.split(" "),s=i[0],a=i.slice(1).join(" ");try{var o;let l={uid:null==e?void 0:e.uid,userName:(null==e?void 0:null===(o=e.displayName)||void 0===o?void 0:o.trim())||"Username",firstName:s,lastName:a,email:null==e?void 0:e.email,credit:20,creationDate:Date.now(),isActive:!0,membership:"free",renewalMembership:"free",creditExpirationDate:"99-99-9999",privateImages:!1,subscriptionCredits:0,userHasActivePlan:!1,usedCredits:0};await (0,f.pl)(t,l),p.h.dispatch((0,m.av)({...l}))}catch(u){console.log("Error add Doc:",u)}}}},e7=async(e,t)=>{if(e){let n=await (0,f.JU)(e5,"users",e),r=await (0,f.QT)(n),i=r.data(),s=null==i?void 0:i.credit,a=null==i?void 0:i.subscriptionCredits,o=(null==i?void 0:i.usedCredits)||0;if(!(t>s+a)){if(a>=t){p.h.dispatch((0,m.av)({...r.data(),subscriptionCredits:a-t})),await (0,f.r7)(n,{...r.data(),subscriptionCredits:a-t,usedCredits:o+t});return}if(s>=t){p.h.dispatch((0,m.av)({...r.data(),credit:s-t})),await (0,f.r7)(n,{...r.data(),credit:s-t,usedCredits:o+t});return}if(t>a&&t>s&&t===a+s){for(;t>0;)if(a>0)a>=t?(a-=t,t=0):(t-=a,a=0);else if(s>0)s>=t?(s-=t,t=0):(t-=s,s=0);else break;p.h.dispatch((0,m.av)({...r.data(),credit:s,subscriptionCredits:a})),await (0,f.r7)(n,{...r.data(),credit:s,subscriptionCredits:a,usedCredits:o+t})}}}},e8=(0,d.v0)(u),te=async()=>{let e=new d.hJ;e.setCustomParameters({prompt:"select_account"});let t=!1;try{var n,r,i,s,a;let o=await (0,d.rh)(e8,e);if(!o)return t;if(null==o||null===(n=o._tokenResponse)||void 0===n||!n.isNewUser)return await e3(o.user),t=!0,(0,e9.l)("UserLogin",null==o?void 0:null===(a=o.user)||void 0===a?void 0:a.uid),t;{await e3(o.user),(0,e9.l)("UserSignUp",null==o?void 0:null===(r=o.user)||void 0===r?void 0:r.uid);let l=null==o?void 0:null===(i=o.user)||void 0===i?void 0:i.displayName.split(" "),u=l[0];return fetch("/api/sendEmail",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({to:null==o?void 0:null===(s=o.user)||void 0===s?void 0:s.email,asm:{group_id:55091},templateId:"d-1c94a87e2878456b8a4b38ee76867974",dynamic_template_data:{First_Name:u}})}).then(()=>{}).catch(()=>{}),t=!0}}catch(c){console.log("Error sign in with google")}},tt=async e=>{if(e){let t=(0,f.JU)(e5,"users",String(e)),n=await (0,f.QT)(t);if(n.exists())return n.data()}},tn=async(e,t,n,r,i,s,a,o)=>{let l=(0,f.JU)(e5,"users",e),u=await (0,f.QT)(l),c=u.data();await (0,f.pl)((0,f.JU)(e5,"images",n),{userId:e,imgUrl:t,createdAt:Date.now(),patterns:r,backgroundColors:s,caption:o.caption||"",prompt:o.prompt||"",caption_model:o.caption_model||"",generation_model:o.generation_model||"",generation_type:o.generation_type||"",generation_request_type:o.generation_request_type||"",negative_prompt:o.negative_prompt||"",input_img_url:o.input_img_url||"",seeds:o.seeds||0,elements:o.elements||[],colors:i||o.colors||[],bgColors:s||o.bgColors||[],style:a||o.bgColors||"",is_private:c.privateImages,display_in_gallery:!1,imageId:n})},tr=async(e,t,n)=>{try{let r=(0,f.JU)(e5,"users",e),i=await (0,f.QT)(r),s=i.data();return await (0,f.pl)((0,f.JU)(e5,"images",null==t?void 0:t.uiid),{userId:null==s?void 0:s.uid,imgUrl:null==t?void 0:t.imgUrl,imgFileUrl:null==t?void 0:t.imgFileUrl,is_private:s.privateImages,display_in_gallery:!1,imageId:null==t?void 0:t.uiid,createdAt:Date.now(),...n}),{success:!0,error:!1}}catch(a){return console.log("fb error"),{success:!1,error:!0}}},ti=async e=>{let t=(0,f.hJ)(e5,"gallery"),n=(0,f.IO)(t,(0,f.ar)("imageId","==",(null==e?void 0:e.imageId)?null==e?void 0:e.imageId:e)),r=await (0,f.PL)(n),i=r.docs.map(e=>e.data()),s=(0,f.hJ)(e5,"images"),a=(0,f.IO)(s,(0,f.ar)("imageId","==",(null==e?void 0:e.imageId)?null==e?void 0:e.imageId:e)),o=await (0,f.PL)(a),l=o.docs.map(e=>e.data());return i.length?i:l},ts=async e=>{let t=(0,f.hJ)(e5,"images"),n=(0,f.IO)(t,(0,f.ar)("imgUrl","==",e)),r=await (0,f.PL)(n),i=r.docs.map(e=>e.data());return i},ta=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,n=(0,f.hJ)(e5,"gallery"),r=(0,f.IO)(n,(0,f.ar)("display_in_gallery","==",!0),(0,f.Xo)("createdAt","desc"),(0,f.b9)(t));e&&(r=(0,f.IO)(n,(0,f.ar)("display_in_gallery","==",!0),(0,f.Xo)("createdAt","desc"),(0,f.TQ)(e),(0,f.b9)(t)));let i=[];try{let s=await (0,f.PL)(r);if(s.docs.map(e=>{i.push(e.data())}),p.h.dispatch((0,g.wc)([...i])),!(s.docs.length>0))return null;{let a=s.docs[s.docs.length-1];return a}}catch(o){console.log("Error getting images.")}},to=async()=>{let e=(0,f.hJ)(e5,"gallery"),t=await (0,f.Yp)(e);return t.data().count},tl=async e=>{if(e){let t=(0,f.hJ)(e5,"images"),n=(0,f.IO)(t,(0,f.ar)("userId","==",e)),r=await (0,f.Yp)(n);return r.data().count}},tu=async function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:8;if(e){let r=(0,f.hJ)(e5,"images"),i=(0,f.IO)(r,(0,f.ar)("userId","==",e),(0,f.Xo)("createdAt","desc"),(0,f.b9)(n));t&&(i=(0,f.IO)(r,(0,f.ar)("userId","==",e),(0,f.Xo)("createdAt","desc"),(0,f.TQ)(t),(0,f.b9)(n)));let s=[];try{let a=await (0,f.PL)(i);if(a.docs.map(e=>{s.push(e.data())}),!(a.docs.length>0))return{allPrevImage:[],lastVisible:null};{let o=a.docs[a.docs.length-1];return{lastVisible:o,allPrevImage:s}}}catch(l){console.log("Error getting images")}}},tc=async function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:8;if(e){let r=(0,f.hJ)(e5,"users",e,"favImages"),i=(0,f.IO)(r,(0,f.Xo)("addedAt","desc"),(0,f.b9)(n));t&&(i=(0,f.IO)(r,(0,f.Xo)("addedAt","desc"),(0,f.TQ)(t),(0,f.b9)(n)));let s=[];try{let a=await (0,f.PL)(i);if(a.docs.map(e=>{s.push(e.data())}),!(a.docs.length>0))return{lastVisible:null,allFavImages:[]};{let o=a.docs[a.docs.length-1];return{lastVisible:o,allFavImages:s}}}catch(l){console.log("Error getting images.")}}},th=async e=>{if(e){let t=(0,f.hJ)(e5,"users",e,"favImages"),n=await (0,f.Yp)(t);return n.data().count}},td=async(e,t)=>{if(e&&t.imageId){let n=(0,f.JU)((0,f.hJ)(e5,"users",e,"favImages"),t.imageId),r=await (0,f.QT)(n);if(r.exists())await (0,f.oe)(n);else{var i;let s={};(null==t?void 0:null===(i=t.imgUrl)||void 0===i?void 0:i.includes("cloudinary"))?(s.imgUrl=null==t?void 0:t.imgUrl,s.imgFileUrl=null==t?void 0:t.imgUrl,s.imageId=(null==t?void 0:t.imageId)||(null==t?void 0:t.uiid),s.img_host_provider="cloudinary",s.addedAt=Date.now()):(s.imgUrl=null==t?void 0:t.imgUrl,s.imgFileUrl=null==t?void 0:t.imgFileUrl,s.imageId=(null==t?void 0:t.imageId)||(null==t?void 0:t.uiid),s.img_host_provider=(null==t?void 0:t.img_host_provider)||"aws",s.addedAt=Date.now()),await (0,f.pl)(n,s)}}},tf=async(e,t)=>{if(e&&t){let n=(0,f.JU)((0,f.hJ)(e5,"users",e,"favImages"),t),r=await (0,f.QT)(n);return!!r.exists()}},tp=async()=>{let e=(0,f.hJ)(e5,"styles"),t=await (0,f.PL)(e);return t.docs},tm=e=>{let t=(0,f.JU)(e5,"gallery",e),n=(0,f.QT)(t);return n};!function(e=(0,h.Mq)()){e=(0,_.m9)(e);let t=(0,h.qX)(e,eE);t.isInitialized()?t.getImmediate():function(e,t={}){let n=(0,h.qX)(e,eE);if(n.isInitialized()){let r=n.getImmediate();if((0,_.vZ)(t,n.getOptions()))return r;throw eT.create("already-initialized")}let i=n.initialize({options:t});return i}(e)}(u);let tg=async(e,t)=>{let n;(await (0,f.QT)(n=(0,f.JU)(e5,"images",e))).exists()||(n=(0,f.JU)(e5,"gallery",e));try{await (0,f.r7)(n,{large_img:t})}catch(r){console.error(r)}},ty=async e=>{var t;let n;(n=await (0,f.QT)((0,f.JU)(e5,"images",e))).exists()||(n=await (0,f.QT)((0,f.JU)(e5,"gallery",e)));let r=null===(t=n.data())||void 0===t?void 0:t.large_img;return r||void 0},t_=async()=>{let e=[],t=(0,f.hJ)(e5,"products"),n=(0,f.IO)(t,(0,f.ar)("active","==",!0),(0,f.ar)("role","in",["pro","standard","starter"])),r=await (0,f.PL)(n);for(let i of r.docs){let s=(0,f.hJ)(e5,"products",i.id,"prices"),a=await (0,f.PL)(s),o={id:i.id,...i.data(),prices:a.docs.map(e=>({id:e.id,...e.data()}))};e.push(o)}return e},tv=async()=>{let e=null,t=e8.currentUser.uid,n=(0,f.hJ)(e5,"users",t,"payments");e=await (0,f.PL)(n);let r=e.docs[0].id;return r},tw=async()=>{var e,t;let n=/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ function(e=(0,h.Mq)(),t=eJ){let n=(0,h.qX)((0,_.m9)(e),eH),r=n.getImmediate({identifier:t}),i=(0,_.P0)("functions");return i&&function(e,t,n){(0,_.m9)(e).emulatorOrigin=`http://${t}:${n}`}(r,...i),r}(),r=(e=(0,_.m9)(n),t=void 0,n=>(function(e,t,n,r){let i=e._url(t);return e1(e,i,n,r)})(e,"ext-firestore-stripe-payments-createPortalLink",n,t||{})),{data:i}=await r({returnUrl:window.location.origin});window.location.assign(null==i?void 0:i.url)},tb=async(e,t)=>{let n=(0,f.JU)((0,f.hJ)(e5,"gallery"),e),r=(await (0,f.QT)(n)).data();r||(r=(await (0,f.QT)(n=(0,f.JU)((0,f.hJ)(e5,"images"),e))).data());let i=null==r?void 0:r.rating;switch(i||(i={total_rating:0,average_rating:0,"1_star_rating":0,"2_star_rating":0,"3_star_rating":0,"4_star_rating":0,"5_star_rating":0}),t){case 1:i["1_star_rating"]+=1;break;case 2:i["2_star_rating"]+=1;break;case 3:i["3_star_rating"]+=1;break;case 4:i["4_star_rating"]+=1;break;case 5:i["5_star_rating"]+=1;break;default:console.log("Invalid rating value: ".concat(t))}let s=i["1_star_rating"]+i["2_star_rating"]+i["3_star_rating"]+i["4_star_rating"]+i["5_star_rating"],a=((1*i["1_star_rating"]+2*i["2_star_rating"]+3*i["3_star_rating"]+4*i["4_star_rating"]+5*i["5_star_rating"])/s).toFixed(2);i.total_rating=s,i.average_rating=a;let o=null==r?void 0:r.ratedBy;o||(o=[]),await (0,f.r7)(n,{rating:i,ratedBy:o=(null==o?void 0:o.length)?[...o,e8.currentUser.uid]:[e8.currentUser.uid]})},tE=async(e,t)=>{if(e){let n=(0,f.JU)((0,f.hJ)(e5,"gallery"),t),r=(await (0,f.QT)(n)).data();r||(r=(await (0,f.QT)(n=(0,f.JU)((0,f.hJ)(e5,"images"),t))).data());let i=null==r?void 0:r.ratedBy,s=!(null==i?void 0:i.includes(e));return s}},tI=async(e,t)=>{let n=(0,f.JU)((0,f.hJ)(e5,"images"),e);await (0,f.r7)(n,{creatorLikesModelResult:"yes"===t})},tS=async()=>{let e=[],t=(0,f.hJ)(e5,"AlertMessage"),n=(0,f.IO)(t,(0,f.ar)("Active","==",!0),(0,f.Xo)("createdAt","desc")),r=await (0,f.PL)(n);for(let i of r.docs)e.push({id:i.id,data:i.data()});return e.length?e:[]}},1106:function(e,t,n){"use strict";n.d(t,{l:function(){return r}});let r=function(e,t){for(var n=arguments.length,r=Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];fetch("/api/analysis",{method:"POST",body:JSON.stringify({eventName:e,properties:{distinct_id:t,...r}})}).then(()=>{})}},4378:function(e,t,n){"use strict";let r,i,s,a,o,l,u,c,h,d;let f=Object.prototype.toString;function p(e){switch(f.call(e)){case"[object Error]":case"[object Exception]":case"[object DOMException]":return!0;default:return S(e,Error)}}function m(e,t){return f.call(e)===`[object ${t}]`}function g(e){return m(e,"ErrorEvent")}function y(e){return m(e,"DOMError")}function _(e){return m(e,"String")}function v(e){return null===e||"object"!=typeof e&&"function"!=typeof e}function w(e){return m(e,"Object")}function b(e){return"undefined"!=typeof Event&&S(e,Event)}function E(e){return Boolean(e&&e.then&&"function"==typeof e.then)}function I(e){return"number"==typeof e&&e!=e}function S(e,t){try{return e instanceof t}catch(n){return!1}}var T,D,x,k,C,N,R,A=n(1235);let O=(0,A.Rf)();function P(e,t={}){try{let n,r=e,i=[],s=0,a=0,o=Array.isArray(t)?t:t.keyAttrs,l=!Array.isArray(t)&&t.maxStringLength||80;for(;r&&s++<5&&(n=function(e,t){let n,r,i,s,a;let o=[];if(!e||!e.tagName)return"";o.push(e.tagName.toLowerCase());let l=t&&t.length?t.filter(t=>e.getAttribute(t)).map(t=>[t,e.getAttribute(t)]):null;if(l&&l.length)l.forEach(e=>{o.push(`[${e[0]}="${e[1]}"]`)});else if(e.id&&o.push(`#${e.id}`),(n=e.className)&&_(n))for(a=0,r=n.split(/\s+/);a<r.length;a++)o.push(`.${r[a]}`);let u=["aria-label","type","name","title","alt"];for(a=0;a<u.length;a++)i=u[a],(s=e.getAttribute(i))&&o.push(`[${i}="${s}"]`);return o.join("")}(r,o),"html"!==n&&(!(s>1)||!(a+3*i.length+n.length>=l)));)i.push(n),a+=n.length,r=r.parentNode;return i.reverse().join(" > ")}catch(u){return"<unknown>"}}function L(e,t=0){return"string"!=typeof e||0===t?e:e.length<=t?e:`${e.slice(0,t)}...`}function M(e,t){if(!Array.isArray(e))return"";let n=[];for(let r=0;r<e.length;r++){let i=e[r];try{n.push(String(i))}catch(s){n.push("[value cannot be serialized]")}}return n.join(t)}function U(e,t=[],n=!1){return t.some(t=>(function(e,t,n=!1){return!!_(e)&&(m(t,"RegExp")?t.test(e):!!_(t)&&(n?e===t:e.includes(t)))})(e,t,n))}function F(e,t,n){if(!(t in e))return;let r=e[t],i=n(r);if("function"==typeof i)try{B(i,r)}catch(s){}e[t]=i}function j(e,t,n){Object.defineProperty(e,t,{value:n,writable:!0,configurable:!0})}function B(e,t){let n=t.prototype||{};e.prototype=t.prototype=n,j(e,"__sentry_original__",t)}function $(e){return e.__sentry_original__}function V(e){if(p(e))return{message:e.message,name:e.name,stack:e.stack,...q(e)};if(!b(e))return e;{let t={type:e.type,target:G(e.target),currentTarget:G(e.currentTarget),...q(e)};return"undefined"!=typeof CustomEvent&&S(e,CustomEvent)&&(t.detail=e.detail),t}}function G(e){try{return"undefined"!=typeof Element&&S(e,Element)?P(e):Object.prototype.toString.call(e)}catch(t){return"<unknown>"}}function q(e){if("object"!=typeof e||null===e)return{};{let t={};for(let n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}}function z(e){let t=new Map;return function e(t,n){if(w(t)){let r=n.get(t);if(void 0!==r)return r;let i={};for(let s of(n.set(t,i),Object.keys(t)))void 0!==t[s]&&(i[s]=e(t[s],n));return i}if(Array.isArray(t)){let a=n.get(t);if(void 0!==a)return a;let o=[];return n.set(t,o),t.forEach(t=>{o.push(e(t,n))}),o}return t}(e,t)}function K(){let e=A.n2,t=e.crypto||e.msCrypto;if(t&&t.randomUUID)return t.randomUUID().replace(/-/g,"");let n=t&&t.getRandomValues?()=>t.getRandomValues(new Uint8Array(1))[0]:()=>16*Math.random();return"10000000100040008000100000000000".replace(/[018]/g,e=>(e^(15&n())>>e/4).toString(16))}function Y(e){return e.exception&&e.exception.values?e.exception.values[0]:void 0}function H(e){let{message:t,event_id:n}=e;if(t)return t;let r=Y(e);return r?r.type&&r.value?`${r.type}: ${r.value}`:r.type||r.value||n||"<unknown>":n||"<unknown>"}function W(e,t,n){let r=e.exception=e.exception||{},i=r.values=r.values||[],s=i[0]=i[0]||{};s.value||(s.value=t||""),s.type||(s.type=n||"Error")}function Q(e,t){let n=Y(e);if(!n)return;let r=n.mechanism;if(n.mechanism={type:"generic",handled:!0,...r,...t},t&&"data"in t){let i={...r&&r.data,...t.data};n.mechanism.data=i}}function X(e){if(e&&e.__sentry_captured__)return!0;try{j(e,"__sentry_captured__",!0)}catch(t){}return!1}function J(e){return Array.isArray(e)?e:[e]}var Z=n(1170);let ee=["debug","info","warn","error","log","assert","trace"];function et(e){if(!("console"in A.n2))return e();let t=A.n2.console,n={};ee.forEach(e=>{let r=t[e]&&t[e].__sentry_original__;e in t&&r&&(n[e]=t[e],t[e]=r)});try{return e()}finally{Object.keys(n).forEach(e=>{t[e]=n[e]})}}function en(){let e=!1,t={enable(){e=!0},disable(){e=!1}};return"undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__?ee.forEach(n=>{t[n]=(...t)=>{e&&et(()=>{A.n2.console[n](`Sentry Logger [${n}]:`,...t)})}}):ee.forEach(e=>{t[e]=()=>void 0}),t}r="undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__?(0,A.YO)("logger",en):en();let er="production";function ei(e){return new ea(t=>{t(e)})}function es(e){return new ea((t,n)=>{n(e)})}(T=R||(R={}))[T.PENDING=0]="PENDING",T[T.RESOLVED=1]="RESOLVED",T[T.REJECTED=2]="REJECTED";class ea{__init(){this._state=R.PENDING}__init2(){this._handlers=[]}constructor(e){ea.prototype.__init.call(this),ea.prototype.__init2.call(this),ea.prototype.__init3.call(this),ea.prototype.__init4.call(this),ea.prototype.__init5.call(this),ea.prototype.__init6.call(this);try{e(this._resolve,this._reject)}catch(t){this._reject(t)}}then(e,t){return new ea((n,r)=>{this._handlers.push([!1,t=>{if(e)try{n(e(t))}catch(i){r(i)}else n(t)},e=>{if(t)try{n(t(e))}catch(i){r(i)}else r(e)}]),this._executeHandlers()})}catch(e){return this.then(e=>e,e)}finally(e){return new ea((t,n)=>{let r,i;return this.then(t=>{i=!1,r=t,e&&e()},t=>{i=!0,r=t,e&&e()}).then(()=>{if(i){n(r);return}t(r)})})}__init3(){this._resolve=e=>{this._setResult(R.RESOLVED,e)}}__init4(){this._reject=e=>{this._setResult(R.REJECTED,e)}}__init5(){this._setResult=(e,t)=>{if(this._state===R.PENDING){if(E(t)){t.then(this._resolve,this._reject);return}this._state=e,this._value=t,this._executeHandlers()}}}__init6(){this._executeHandlers=()=>{if(this._state===R.PENDING)return;let e=this._handlers.slice();this._handlers=[],e.forEach(e=>{e[0]||(this._state===R.RESOLVED&&e[1](this._value),this._state===R.REJECTED&&e[2](this._value),e[0]=!0)})}}}function eo(e,t={}){if(!t.user||(!e.ipAddress&&t.user.ip_address&&(e.ipAddress=t.user.ip_address),e.did||t.did||(e.did=t.user.id||t.user.email||t.user.username)),e.timestamp=t.timestamp||(0,Z.ph)(),t.ignoreDuration&&(e.ignoreDuration=t.ignoreDuration),t.sid&&(e.sid=32===t.sid.length?t.sid:K()),void 0!==t.init&&(e.init=t.init),!e.did&&t.did&&(e.did=`${t.did}`),"number"==typeof t.started&&(e.started=t.started),e.ignoreDuration)e.duration=void 0;else if("number"==typeof t.duration)e.duration=t.duration;else{let n=e.timestamp-e.started;e.duration=n>=0?n:0}t.release&&(e.release=t.release),t.environment&&(e.environment=t.environment),!e.ipAddress&&t.ipAddress&&(e.ipAddress=t.ipAddress),!e.userAgent&&t.userAgent&&(e.userAgent=t.userAgent),"number"==typeof t.errors&&(e.errors=t.errors),t.status&&(e.status=t.status)}class el{constructor(){this._notifyingListeners=!1,this._scopeListeners=[],this._eventProcessors=[],this._breadcrumbs=[],this._attachments=[],this._user={},this._tags={},this._extra={},this._contexts={},this._sdkProcessingMetadata={}}static clone(e){let t=new el;return e&&(t._breadcrumbs=[...e._breadcrumbs],t._tags={...e._tags},t._extra={...e._extra},t._contexts={...e._contexts},t._user=e._user,t._level=e._level,t._span=e._span,t._session=e._session,t._transactionName=e._transactionName,t._fingerprint=e._fingerprint,t._eventProcessors=[...e._eventProcessors],t._requestSession=e._requestSession,t._attachments=[...e._attachments],t._sdkProcessingMetadata={...e._sdkProcessingMetadata}),t}addScopeListener(e){this._scopeListeners.push(e)}addEventProcessor(e){return this._eventProcessors.push(e),this}setUser(e){return this._user=e||{},this._session&&eo(this._session,{user:e}),this._notifyScopeListeners(),this}getUser(){return this._user}getRequestSession(){return this._requestSession}setRequestSession(e){return this._requestSession=e,this}setTags(e){return this._tags={...this._tags,...e},this._notifyScopeListeners(),this}setTag(e,t){return this._tags={...this._tags,[e]:t},this._notifyScopeListeners(),this}setExtras(e){return this._extra={...this._extra,...e},this._notifyScopeListeners(),this}setExtra(e,t){return this._extra={...this._extra,[e]:t},this._notifyScopeListeners(),this}setFingerprint(e){return this._fingerprint=e,this._notifyScopeListeners(),this}setLevel(e){return this._level=e,this._notifyScopeListeners(),this}setTransactionName(e){return this._transactionName=e,this._notifyScopeListeners(),this}setContext(e,t){return null===t?delete this._contexts[e]:this._contexts[e]=t,this._notifyScopeListeners(),this}setSpan(e){return this._span=e,this._notifyScopeListeners(),this}getSpan(){return this._span}getTransaction(){let e=this.getSpan();return e&&e.transaction}setSession(e){return e?this._session=e:delete this._session,this._notifyScopeListeners(),this}getSession(){return this._session}update(e){if(!e)return this;if("function"==typeof e){let t=e(this);return t instanceof el?t:this}return e instanceof el?(this._tags={...this._tags,...e._tags},this._extra={...this._extra,...e._extra},this._contexts={...this._contexts,...e._contexts},e._user&&Object.keys(e._user).length&&(this._user=e._user),e._level&&(this._level=e._level),e._fingerprint&&(this._fingerprint=e._fingerprint),e._requestSession&&(this._requestSession=e._requestSession)):w(e)&&(this._tags={...this._tags,...e.tags},this._extra={...this._extra,...e.extra},this._contexts={...this._contexts,...e.contexts},e.user&&(this._user=e.user),e.level&&(this._level=e.level),e.fingerprint&&(this._fingerprint=e.fingerprint),e.requestSession&&(this._requestSession=e.requestSession)),this}clear(){return this._breadcrumbs=[],this._tags={},this._extra={},this._user={},this._contexts={},this._level=void 0,this._transactionName=void 0,this._fingerprint=void 0,this._requestSession=void 0,this._span=void 0,this._session=void 0,this._notifyScopeListeners(),this._attachments=[],this}addBreadcrumb(e,t){let n="number"==typeof t?t:100;if(n<=0)return this;let r={timestamp:(0,Z.yW)(),...e};return this._breadcrumbs=[...this._breadcrumbs,r].slice(-n),this._notifyScopeListeners(),this}getLastBreadcrumb(){return this._breadcrumbs[this._breadcrumbs.length-1]}clearBreadcrumbs(){return this._breadcrumbs=[],this._notifyScopeListeners(),this}addAttachment(e){return this._attachments.push(e),this}getAttachments(){return this._attachments}clearAttachments(){return this._attachments=[],this}applyToEvent(e,t={}){if(this._extra&&Object.keys(this._extra).length&&(e.extra={...this._extra,...e.extra}),this._tags&&Object.keys(this._tags).length&&(e.tags={...this._tags,...e.tags}),this._user&&Object.keys(this._user).length&&(e.user={...this._user,...e.user}),this._contexts&&Object.keys(this._contexts).length&&(e.contexts={...this._contexts,...e.contexts}),this._level&&(e.level=this._level),this._transactionName&&(e.transaction=this._transactionName),this._span){e.contexts={trace:this._span.getTraceContext(),...e.contexts};let n=this._span.transaction;if(n){e.sdkProcessingMetadata={dynamicSamplingContext:n.getDynamicSamplingContext(),...e.sdkProcessingMetadata};let r=n.name;r&&(e.tags={transaction:r,...e.tags})}}return this._applyFingerprint(e),e.breadcrumbs=[...e.breadcrumbs||[],...this._breadcrumbs],e.breadcrumbs=e.breadcrumbs.length>0?e.breadcrumbs:void 0,e.sdkProcessingMetadata={...e.sdkProcessingMetadata,...this._sdkProcessingMetadata},this._notifyEventProcessors([...eu(),...this._eventProcessors],e,t)}setSDKProcessingMetadata(e){return this._sdkProcessingMetadata={...this._sdkProcessingMetadata,...e},this}_notifyEventProcessors(e,t,n,i=0){return new ea((s,a)=>{let o=e[i];if(null===t||"function"!=typeof o)s(t);else{let l=o({...t},n);("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&o.id&&null===l&&r.log(`Event processor "${o.id}" dropped event`),E(l)?l.then(t=>this._notifyEventProcessors(e,t,n,i+1).then(s)).then(null,a):this._notifyEventProcessors(e,l,n,i+1).then(s).then(null,a)}})}_notifyScopeListeners(){this._notifyingListeners||(this._notifyingListeners=!0,this._scopeListeners.forEach(e=>{e(this)}),this._notifyingListeners=!1)}_applyFingerprint(e){e.fingerprint=e.fingerprint?J(e.fingerprint):[],this._fingerprint&&(e.fingerprint=e.fingerprint.concat(this._fingerprint)),e.fingerprint&&!e.fingerprint.length&&delete e.fingerprint}}function eu(){return(0,A.YO)("globalEventProcessors",()=>[])}function ec(e){eu().push(e)}class eh{constructor(e,t=new el,n=4){this._version=n,this._stack=[{scope:t}],e&&this.bindClient(e)}isOlderThan(e){return this._version<e}bindClient(e){let t=this.getStackTop();t.client=e,e&&e.setupIntegrations&&e.setupIntegrations()}pushScope(){let e=el.clone(this.getScope());return this.getStack().push({client:this.getClient(),scope:e}),e}popScope(){return!(this.getStack().length<=1)&&!!this.getStack().pop()}withScope(e){let t=this.pushScope();try{e(t)}finally{this.popScope()}}getClient(){return this.getStackTop().client}getScope(){return this.getStackTop().scope}getStack(){return this._stack}getStackTop(){return this._stack[this._stack.length-1]}captureException(e,t){let n=this._lastEventId=t&&t.event_id?t.event_id:K(),r=Error("Sentry syntheticException");return this._withClient((i,s)=>{i.captureException(e,{originalException:e,syntheticException:r,...t,event_id:n},s)}),n}captureMessage(e,t,n){let r=this._lastEventId=n&&n.event_id?n.event_id:K(),i=Error(e);return this._withClient((s,a)=>{s.captureMessage(e,t,{originalException:e,syntheticException:i,...n,event_id:r},a)}),r}captureEvent(e,t){let n=t&&t.event_id?t.event_id:K();return e.type||(this._lastEventId=n),this._withClient((r,i)=>{r.captureEvent(e,{...t,event_id:n},i)}),n}lastEventId(){return this._lastEventId}addBreadcrumb(e,t){let{scope:n,client:r}=this.getStackTop();if(!r)return;let{beforeBreadcrumb:i=null,maxBreadcrumbs:s=100}=r.getOptions&&r.getOptions()||{};if(s<=0)return;let a=(0,Z.yW)(),o={timestamp:a,...e},l=i?et(()=>i(o,t)):o;null!==l&&(r.emit&&r.emit("beforeAddBreadcrumb",l,t),n.addBreadcrumb(l,s))}setUser(e){this.getScope().setUser(e)}setTags(e){this.getScope().setTags(e)}setExtras(e){this.getScope().setExtras(e)}setTag(e,t){this.getScope().setTag(e,t)}setExtra(e,t){this.getScope().setExtra(e,t)}setContext(e,t){this.getScope().setContext(e,t)}configureScope(e){let{scope:t,client:n}=this.getStackTop();n&&e(t)}run(e){let t=ef(this);try{e(this)}finally{ef(t)}}getIntegration(e){let t=this.getClient();if(!t)return null;try{return t.getIntegration(e)}catch(n){return("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&r.warn(`Cannot retrieve integration ${e.id} from the current Hub`),null}}startTransaction(e,t){let n=this._callExtensionMethod("startTransaction",e,t);return("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&!n&&console.warn(`Tracing extension 'startTransaction' has not been added. Call 'addTracingExtensions' before calling 'init':
Sentry.addTracingExtensions();
Sentry.init({...});
`),n}traceHeaders(){return this._callExtensionMethod("traceHeaders")}captureSession(e=!1){if(e)return this.endSession();this._sendSessionUpdate()}endSession(){let e=this.getStackTop(),t=e.scope,n=t.getSession();if(n){var r;let i;i={},r?i={status:r}:"ok"===n.status&&(i={status:"exited"}),eo(n,i)}this._sendSessionUpdate(),t.setSession()}startSession(e){let{scope:t,client:n}=this.getStackTop(),{release:r,environment:i=er}=n&&n.getOptions()||{},{userAgent:s}=A.n2.navigator||{},a=function(e){let t=(0,Z.ph)(),n={sid:K(),init:!0,timestamp:t,started:t,duration:0,status:"ok",errors:0,ignoreDuration:!1,toJSON:()=>z({sid:`${n.sid}`,init:n.init,started:new Date(1e3*n.started).toISOString(),timestamp:new Date(1e3*n.timestamp).toISOString(),status:n.status,errors:n.errors,did:"number"==typeof n.did||"string"==typeof n.did?`${n.did}`:void 0,duration:n.duration,attrs:{release:n.release,environment:n.environment,ip_address:n.ipAddress,user_agent:n.userAgent}})};return e&&eo(n,e),n}({release:r,environment:i,user:t.getUser(),...s&&{userAgent:s},...e}),o=t.getSession&&t.getSession();return o&&"ok"===o.status&&eo(o,{status:"exited"}),this.endSession(),t.setSession(a),a}shouldSendDefaultPii(){let e=this.getClient(),t=e&&e.getOptions();return Boolean(t&&t.sendDefaultPii)}_sendSessionUpdate(){let{scope:e,client:t}=this.getStackTop(),n=e.getSession();n&&t&&t.captureSession&&t.captureSession(n)}_withClient(e){let{scope:t,client:n}=this.getStackTop();n&&e(n,t)}_callExtensionMethod(e,...t){let n=ed(),i=n.__SENTRY__;if(i&&i.extensions&&"function"==typeof i.extensions[e])return i.extensions[e].apply(this,t);("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&r.warn(`Extension method ${e} couldn't be found, doing nothing.`)}}function ed(){return A.n2.__SENTRY__=A.n2.__SENTRY__||{extensions:{},hub:void 0},A.n2}function ef(e){let t=ed(),n=em(t);return eg(t,e),n}function ep(){let e=ed();if(e.__SENTRY__&&e.__SENTRY__.acs){let t=e.__SENTRY__.acs.getCurrentHub();if(t)return t}return function(e=ed()){return(!(e&&e.__SENTRY__&&e.__SENTRY__.hub)||em(e).isOlderThan(4))&&eg(e,new eh),em(e)}(e)}function em(e){return(0,A.YO)("hub",()=>new eh,e)}function eg(e,t){if(!e)return!1;let n=e.__SENTRY__=e.__SENTRY__||{};return n.hub=t,!0}function ey(e){if("boolean"==typeof __SENTRY_TRACING__&&!__SENTRY_TRACING__)return!1;let t=ep().getClient(),n=e||t&&t.getOptions();return!!n&&(n.enableTracing||"tracesSampleRate"in n||"tracesSampler"in n)}let e_=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^/]+?|)(\.[^./]*|))(?:[/]*)$/;function ev(...e){let t="",n=!1;for(let r=e.length-1;r>=-1&&!n;r--){let i=r>=0?e[r]:"/";i&&(t=`${i}/${t}`,n="/"===i.charAt(0))}return t=(function(e,t){let n=0;for(let r=e.length-1;r>=0;r--){let i=e[r];"."===i?e.splice(r,1):".."===i?(e.splice(r,1),n++):n&&(e.splice(r,1),n--)}if(t)for(;n--;n)e.unshift("..");return e})(t.split("/").filter(e=>!!e),!n).join("/"),(n?"/":"")+t||"."}function ew(e){let t=0;for(;t<e.length&&""===e[t];t++);let n=e.length-1;for(;n>=0&&""===e[n];n--);return t>n?[]:e.slice(t,n-t+1)}class eb{static __initStatic(){this.id="RewriteFrames"}__init(){this.name=eb.id}__init2(){this._prefix="app:///"}constructor(e={}){eb.prototype.__init.call(this),eb.prototype.__init2.call(this),eb.prototype.__init3.call(this),e.root&&(this._root=e.root),e.prefix&&(this._prefix=e.prefix),e.iteratee&&(this._iteratee=e.iteratee)}setupOnce(e,t){e(e=>{let n=t().getIntegration(eb);return n?n.process(e):e})}process(e){let t=e;return e.exception&&Array.isArray(e.exception.values)&&(t=this._processExceptionsEvent(t)),t}__init3(){this._iteratee=e=>{if(!e.filename)return e;let t=/^[a-zA-Z]:\\/.test(e.filename)||e.filename.includes("\\")&&!e.filename.includes("/"),n=/^\//.test(e.filename);if(t||n){var r;let i;let s=t?e.filename.replace(/^[a-zA-Z]:/,"").replace(/\\/g,"/"):e.filename,a=this._root?function(e,t){e=ev(e).slice(1),t=ev(t).slice(1);let n=ew(e.split("/")),r=ew(t.split("/")),i=Math.min(n.length,r.length),s=i;for(let a=0;a<i;a++)if(n[a]!==r[a]){s=a;break}let o=[];for(let l=s;l<n.length;l++)o.push("..");return(o=o.concat(r.slice(s))).join("/")}(this._root,s):(i=function(e){let t=e_.exec(e);return t?t.slice(1):[]}(s)[2],r&&i.slice(-1*r.length)===r&&(i=i.slice(0,i.length-r.length)),i);e.filename=`${this._prefix}${a}`}return e}}_processExceptionsEvent(e){try{return{...e,exception:{...e.exception,values:e.exception.values.map(e=>({...e,...e.stacktrace&&{stacktrace:this._processStacktrace(e.stacktrace)}}))}}}catch(t){return e}}_processStacktrace(e){return{...e,frames:e&&e.frames&&e.frames.map(e=>this._iteratee(e))}}}eb.__initStatic();let eE="7.51.0",eI=[/^Script error\.?$/,/^Javascript error: Script error\.? on line 0$/];class eS{static __initStatic(){this.id="InboundFilters"}__init(){this.name=eS.id}constructor(e={}){this._options=e,eS.prototype.__init.call(this)}setupOnce(e,t){let n=e=>{let n=t();if(n){let i=n.getIntegration(eS);if(i){var s;let a=n.getClient(),o=a?a.getOptions():{},l=function(e={},t={}){return{allowUrls:[...e.allowUrls||[],...t.allowUrls||[]],denyUrls:[...e.denyUrls||[],...t.denyUrls||[]],ignoreErrors:[...e.ignoreErrors||[],...t.ignoreErrors||[],...eI],ignoreTransactions:[...e.ignoreTransactions||[],...t.ignoreTransactions||[]],ignoreInternal:void 0===e.ignoreInternal||e.ignoreInternal}}(i._options,o);return(l.ignoreInternal&&function(e){try{return"SentryError"===e.exception.values[0].type}catch(t){}return!1}(e)?(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&r.warn(`Event dropped due to being internal Sentry Error.
Event: ${H(e)}`),0):(s=l.ignoreErrors,!e.type&&s&&s.length&&(function(e){if(e.message)return[e.message];if(e.exception)try{let{type:t="",value:n=""}=e.exception.values&&e.exception.values[0]||{};return[`${n}`,`${t}: ${n}`]}catch(i){("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&r.error(`Cannot extract message for event ${H(e)}`)}return[]})(e).some(e=>U(e,s)))?(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&r.warn(`Event dropped due to being matched by \`ignoreErrors\` option.
Event: ${H(e)}`),0):!function(e,t){if("transaction"!==e.type||!t||!t.length)return!1;let n=e.transaction;return!!n&&U(n,t)}(e,l.ignoreTransactions)?!function(e,t){if(!t||!t.length)return!1;let n=eT(e);return!!n&&U(n,t)}(e,l.denyUrls)?function(e,t){if(!t||!t.length)return!0;let n=eT(e);return!n||U(n,t)}(e,l.allowUrls)||(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&r.warn(`Event dropped due to not being matched by \`allowUrls\` option.
Event: ${H(e)}.
Url: ${eT(e)}`),0):(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&r.warn(`Event dropped due to being matched by \`denyUrls\` option.
Event: ${H(e)}.
Url: ${eT(e)}`),0):(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&r.warn(`Event dropped due to being matched by \`ignoreTransactions\` option.
Event: ${H(e)}`),0))?e:null}}return e};n.id=this.name,e(n)}}function eT(e){try{let t;try{t=e.exception.values[0].stacktrace.frames}catch(n){}return t?function(e=[]){for(let t=e.length-1;t>=0;t--){let n=e[t];if(n&&"<anonymous>"!==n.filename&&"[native code]"!==n.filename)return n.filename||null}return null}(t):null}catch(i){return("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&r.error(`Cannot extract url for event ${H(e)}`),null}}eS.__initStatic();class eD{constructor(){eD.prototype.__init.call(this)}static __initStatic(){this.id="FunctionToString"}__init(){this.name=eD.id}setupOnce(){i=Function.prototype.toString;try{Function.prototype.toString=function(...e){let t=$(this)||this;return i.apply(t,e)}}catch(e){}}}eD.__initStatic();let ex=[];function ek(e,t){t[e.name]=e,-1===ex.indexOf(e.name)&&(e.setupOnce(ec,ep),ex.push(e.name),("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&r.log(`Integration installed: ${e.name}`))}let eC=/\(error: (.*)\)/;function eN(...e){let t=e.sort((e,t)=>e[0]-t[0]).map(e=>e[1]);return(e,n=0)=>{let r=[],i=e.split("\n");for(let s=n;s<i.length;s++){let a=i[s];if(a.length>1024)continue;let o=eC.test(a)?a.replace(eC,"$1"):a;if(!o.match(/\S*Error: /)){for(let l of t){let u=l(o);if(u){r.push(u);break}}if(r.length>=50)break}}return function(e){if(!e.length)return[];let t=e.slice(0,50),n=t[t.length-1].function;n&&/sentryWrapped/.test(n)&&t.pop(),t.reverse();let r=t[t.length-1].function;return r&&/captureMessage|captureException/.test(r)&&t.pop(),t.map(e=>({...e,filename:e.filename||t[t.length-1].filename,function:e.function||"?"}))}(r)}}let eR="<anonymous>";function eA(e){try{if(!e||"function"!=typeof e)return eR;return e.name||eR}catch(t){return eR}}let eO=(0,A.Rf)();function eP(){if(!("fetch"in eO))return!1;try{return new Headers,new Request("http://www.example.com"),new Response,!0}catch(e){return!1}}function eL(e){return e&&/^function fetch\(\)\s+\{\s+\[native code\]\s+\}$/.test(e.toString())}let eM=(0,A.Rf)(),eU=(0,A.Rf)(),eF="__sentry_xhr_v2__",ej={},eB={};function e$(e,t){ej[e]=ej[e]||[],ej[e].push(t),function(e){if(!eB[e])switch(eB[e]=!0,e){case"console":"console"in eU&&ee.forEach(function(e){e in eU.console&&F(eU.console,e,function(t){return function(...n){eV("console",{args:n,level:e}),t&&t.apply(eU.console,n)}})});break;case"dom":(function(){if(!("document"in eU))return;let e=eV.bind(null,"dom"),t=ez(e,!0);eU.document.addEventListener("click",t,!1),eU.document.addEventListener("keypress",t,!1),["EventTarget","Node"].forEach(t=>{let n=eU[t]&&eU[t].prototype;n&&n.hasOwnProperty&&n.hasOwnProperty("addEventListener")&&(F(n,"addEventListener",function(t){return function(n,r,i){if("click"===n||"keypress"==n)try{let s=this,a=s.__sentry_instrumentation_handlers__=s.__sentry_instrumentation_handlers__||{},o=a[n]=a[n]||{refCount:0};if(!o.handler){let l=ez(e);o.handler=l,t.call(this,n,l,i)}o.refCount++}catch(u){}return t.call(this,n,r,i)}}),F(n,"removeEventListener",function(e){return function(t,n,r){if("click"===t||"keypress"==t)try{let i=this.__sentry_instrumentation_handlers__||{},s=i[t];s&&(s.refCount--,s.refCount<=0&&(e.call(this,t,s.handler,r),s.handler=void 0,delete i[t]),0===Object.keys(i).length&&delete this.__sentry_instrumentation_handlers__)}catch(a){}return e.call(this,t,n,r)}}))})})();break;case"xhr":(function(){if(!("XMLHttpRequest"in eU))return;let e=XMLHttpRequest.prototype;F(e,"open",function(e){return function(...t){let n=t[1],r=this[eF]={method:_(t[0])?t[0].toUpperCase():t[0],url:t[1],request_headers:{}};_(n)&&"POST"===r.method&&n.match(/sentry_key/)&&(this.__sentry_own_request__=!0);let i=()=>{let e=this[eF];if(e&&4===this.readyState){try{e.status_code=this.status}catch(n){}eV("xhr",{args:t,endTimestamp:Date.now(),startTimestamp:Date.now(),xhr:this})}};return"onreadystatechange"in this&&"function"==typeof this.onreadystatechange?F(this,"onreadystatechange",function(e){return function(...t){return i(),e.apply(this,t)}}):this.addEventListener("readystatechange",i),F(this,"setRequestHeader",function(e){return function(...t){let[n,r]=t,i=this[eF];return i&&(i.request_headers[n.toLowerCase()]=r),e.apply(this,t)}}),e.apply(this,t)}}),F(e,"send",function(e){return function(...t){let n=this[eF];return n&&void 0!==t[0]&&(n.body=t[0]),eV("xhr",{args:t,startTimestamp:Date.now(),xhr:this}),e.apply(this,t)}})})();break;case"fetch":!function(){if(!eP())return!1;if(eL(eO.fetch))return!0;let e=!1,t=eO.document;if(t&&"function"==typeof t.createElement)try{let n=t.createElement("iframe");n.hidden=!0,t.head.appendChild(n),n.contentWindow&&n.contentWindow.fetch&&(e=eL(n.contentWindow.fetch)),t.head.removeChild(n)}catch(i){("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&r.warn("Could not create sandbox iframe for pure fetch check, bailing to window.fetch: ",i)}return e}()||F(eU,"fetch",function(e){return function(...t){let{method:n,url:r}=function(e){if(0===e.length)return{method:"GET",url:""};if(2===e.length){let[t,n]=e;return{url:eq(t),method:eG(n,"method")?String(n.method).toUpperCase():"GET"}}let r=e[0];return{url:eq(r),method:eG(r,"method")?String(r.method).toUpperCase():"GET"}}(t),i={args:t,fetchData:{method:n,url:r},startTimestamp:Date.now()};return eV("fetch",{...i}),e.apply(eU,t).then(e=>(eV("fetch",{...i,endTimestamp:Date.now(),response:e}),e),e=>{throw eV("fetch",{...i,endTimestamp:Date.now(),error:e}),e})}});break;case"history":(function(){if(!function(){let e=eM.chrome,t=e&&e.app&&e.app.runtime,n="history"in eM&&!!eM.history.pushState&&!!eM.history.replaceState;return!t&&n}())return;let e=eU.onpopstate;function t(e){return function(...t){let n=t.length>2?t[2]:void 0;if(n){let r=s,i=String(n);s=i,eV("history",{from:r,to:i})}return e.apply(this,t)}}eU.onpopstate=function(...t){let n=eU.location.href,r=s;if(s=n,eV("history",{from:r,to:n}),e)try{return e.apply(this,t)}catch(i){}},F(eU.history,"pushState",t),F(eU.history,"replaceState",t)})();break;case"error":eK=eU.onerror,eU.onerror=function(e,t,n,r,i){return eV("error",{column:r,error:i,line:n,msg:e,url:t}),!!eK&&!eK.__SENTRY_LOADER__&&eK.apply(this,arguments)},eU.onerror.__SENTRY_INSTRUMENTED__=!0;break;case"unhandledrejection":eY=eU.onunhandledrejection,eU.onunhandledrejection=function(e){return eV("unhandledrejection",e),!eY||!!eY.__SENTRY_LOADER__||eY.apply(this,arguments)},eU.onunhandledrejection.__SENTRY_INSTRUMENTED__=!0;break;default:("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&r.warn("unknown instrumentation type:",e);return}}(e)}function eV(e,t){if(e&&ej[e])for(let n of ej[e]||[])try{n(t)}catch(i){("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&r.error(`Error while triggering instrumentation handler.
Type: ${e}
Name: ${eA(n)}
Error:`,i)}}function eG(e,t){return!!e&&"object"==typeof e&&!!e[t]}function eq(e){return"string"==typeof e?e:e?eG(e,"url")?e.url:e.toString?e.toString():"":""}function ez(e,t=!1){return n=>{if(!n||o===n||function(e){if("keypress"!==e.type)return!1;try{let t=e.target;if(!t||!t.tagName)return!0;if("INPUT"===t.tagName||"TEXTAREA"===t.tagName||t.isContentEditable)return!1}catch(n){}return!0}(n))return;let r="keypress"===n.type?"input":n.type;void 0===a?(e({event:n,name:r,global:t}),o=n):function(e,t){if(!e||e.type!==t.type)return!0;try{if(e.target!==t.target)return!0}catch(n){}return!1}(o,n)&&(e({event:n,name:r,global:t}),o=n),clearTimeout(a),a=eU.setTimeout(()=>{a=void 0},1e3)}}let eK=null,eY=null;class eH extends Error{constructor(e,t="warn"){super(e),this.message=e,this.name=new.target.prototype.constructor.name,Object.setPrototypeOf(this,new.target.prototype),this.logLevel=t}}let eW=/^(?:(\w+):)\/\/(?:(\w+)(?::(\w+)?)?@)([\w.-]+)(?::(\d+))?\/(.+)/;function eQ(e,t=!1){let{host:n,path:r,pass:i,port:s,projectId:a,protocol:o,publicKey:l}=e;return`${o}://${l}${t&&i?`:${i}`:""}@${n}${s?`:${s}`:""}/${r?`${r}/`:r}${a}`}function eX(e){let t=eW.exec(e);if(!t)throw new eH(`Invalid Sentry Dsn: ${e}`);let[n,r,i="",s,a="",o]=t.slice(1),l="",u=o,c=u.split("/");if(c.length>1&&(l=c.slice(0,-1).join("/"),u=c.pop()),u){let h=u.match(/^\d+/);h&&(u=h[0])}return eJ({host:s,pass:i,path:l,projectId:u,port:a,protocol:n,publicKey:r})}function eJ(e){return{protocol:e.protocol,publicKey:e.publicKey||"",pass:e.pass||"",host:e.host,port:e.port||"",path:e.path||"",projectId:e.projectId}}function eZ(e,t=100,r=Infinity){try{return function e(t,r,i=Infinity,s=Infinity,a=function(){let e="function"==typeof WeakSet,t=e?new WeakSet:[];return[function(n){if(e)return!!t.has(n)||(t.add(n),!1);for(let r=0;r<t.length;r++){let i=t[r];if(i===n)return!0}return t.push(n),!1},function(n){if(e)t.delete(n);else for(let r=0;r<t.length;r++)if(t[r]===n){t.splice(r,1);break}}]}()){let[o,l]=a;if(null==r||["number","boolean","string"].includes(typeof r)&&!I(r))return r;let u=function(e,t){try{if("domain"===e&&t&&"object"==typeof t&&t._events)return"[Domain]";if("domainEmitter"===e)return"[DomainEmitter]";if(void 0!==n.g&&t===n.g)return"[Global]";if("undefined"!=typeof window&&t===window)return"[Window]";if("undefined"!=typeof document&&t===document)return"[Document]";if(w(t)&&"nativeEvent"in t&&"preventDefault"in t&&"stopPropagation"in t)return"[SyntheticEvent]";if("number"==typeof t&&t!=t)return"[NaN]";if("function"==typeof t)return`[Function: ${eA(t)}]`;if("symbol"==typeof t)return`[${String(t)}]`;if("bigint"==typeof t)return`[BigInt: ${String(t)}]`;let r=function(e){let t=Object.getPrototypeOf(e);return t?t.constructor.name:"null prototype"}(t);if(/^HTML(\w*)Element$/.test(r))return`[HTMLElement: ${r}]`;return`[object ${r}]`}catch(i){return`**non-serializable** (${i})`}}(t,r);if(!u.startsWith("[object "))return u;if(r.__sentry_skip_normalization__)return r;let c="number"==typeof r.__sentry_override_normalization_depth__?r.__sentry_override_normalization_depth__:i;if(0===c)return u.replace("object ","");if(o(r))return"[Circular ~]";if(r&&"function"==typeof r.toJSON)try{let h=r.toJSON();return e("",h,c-1,s,a)}catch(d){}let f=Array.isArray(r)?[]:{},p=0,m=V(r);for(let g in m){if(!Object.prototype.hasOwnProperty.call(m,g))continue;if(p>=s){f[g]="[MaxProperties ~]";break}let y=m[g];f[g]=e(g,y,c-1,s,a),p++}return l(r),f}("",e,t,r)}catch(i){return{ERROR:`**non-serializable** (${i})`}}}function e0(e,t=[]){return[e,t]}function e1(e,t){let n=e[1];for(let r of n){let i=r[0].type,s=t(r,i);if(s)return!0}return!1}function e2(e,t){let n=t||new TextEncoder;return n.encode(e)}let e4={session:"session",sessions:"session",attachment:"attachment",transaction:"transaction",event:"error",client_report:"internal",user_report:"default",profile:"profile",replay_event:"replay",replay_recording:"replay",check_in:"monitor"};function e9(e){if(!e||!e.sdk)return;let{name:t,version:n}=e.sdk;return{name:t,version:n}}let e6=new WeakMap,e5="Not capturing exception because it's already been captured.";class e3{__init(){this._integrations={}}__init2(){this._integrationsInitialized=!1}__init3(){this._numProcessing=0}__init4(){this._outcomes={}}__init5(){this._hooks={}}constructor(e){if(e3.prototype.__init.call(this),e3.prototype.__init2.call(this),e3.prototype.__init3.call(this),e3.prototype.__init4.call(this),e3.prototype.__init5.call(this),this._options=e,e.dsn){this._dsn=function(e){let t="string"==typeof e?eX(e):eJ(e);return!function(e){if(!("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__))return;let{port:t,projectId:n,protocol:r}=e;if(["protocol","publicKey","host","projectId"].forEach(t=>{if(!e[t])throw new eH(`Invalid Sentry Dsn: ${t} missing`)}),!n.match(/^\d+$/))throw new eH(`Invalid Sentry Dsn: Invalid projectId ${n}`);if(!("http"===r||"https"===r))throw new eH(`Invalid Sentry Dsn: Invalid protocol ${r}`);if(t&&isNaN(parseInt(t,10)))throw new eH(`Invalid Sentry Dsn: Invalid port ${t}`)}(t),t}(e.dsn);let t=function(e,t={}){var n;let r="string"==typeof t?t:t.tunnel,i="string"!=typeof t&&t._metadata?t._metadata.sdk:void 0;return r||`${function(e){let t=e.protocol?`${e.protocol}:`:"",n=e.port?`:${e.port}`:"";return`${t}//${e.host}${n}${e.path?`/${e.path}`:""}/api/`}(e)}${e.projectId}/envelope/?${Object.keys(n={sentry_key:e.publicKey,sentry_version:"7",...i&&{sentry_client:`${i.name}/${i.version}`}}).map(e=>`${encodeURIComponent(e)}=${encodeURIComponent(n[e])}`).join("&")}`}(this._dsn,e);this._transport=e.transport({recordDroppedEvent:this.recordDroppedEvent.bind(this),...e.transportOptions,url:t})}else("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&r.warn("No DSN provided, client will not do anything.")}captureException(e,t,n){if(X(e)){("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&r.log(e5);return}let i=t&&t.event_id;return this._process(this.eventFromException(e,t).then(e=>this._captureEvent(e,t,n)).then(e=>{i=e})),i}captureMessage(e,t,n,r){let i=n&&n.event_id,s=v(e)?this.eventFromMessage(String(e),t,n):this.eventFromException(e,n);return this._process(s.then(e=>this._captureEvent(e,n,r)).then(e=>{i=e})),i}captureEvent(e,t,n){if(t&&t.originalException&&X(t.originalException)){("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&r.log(e5);return}let i=t&&t.event_id;return this._process(this._captureEvent(e,t,n).then(e=>{i=e})),i}captureSession(e){if(!this._isEnabled()){("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&r.warn("SDK not enabled, will not capture session.");return}"string"!=typeof e.release?("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&r.warn("Discarded session because of missing or non-string release"):(this.sendSession(e),eo(e,{init:!1}))}getDsn(){return this._dsn}getOptions(){return this._options}getSdkMetadata(){return this._options._metadata}getTransport(){return this._transport}flush(e){let t=this._transport;return t?this._isClientDoneProcessing(e).then(n=>t.flush(e).then(e=>n&&e)):ei(!0)}close(e){return this.flush(e).then(e=>(this.getOptions().enabled=!1,e))}setupIntegrations(){this._isEnabled()&&!this._integrationsInitialized&&(this._integrations=function(e){let t={};return e.forEach(e=>{e&&ek(e,t)}),t}(this._options.integrations),this._integrationsInitialized=!0)}getIntegrationById(e){return this._integrations[e]}getIntegration(e){try{return this._integrations[e.id]||null}catch(t){return("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&r.warn(`Cannot retrieve integration ${e.id} from the current Client`),null}}addIntegration(e){ek(e,this._integrations)}sendEvent(e,t={}){if(this._dsn){let n=function(e,t,n,r){var i,s;let a=e9(n),o=e.type&&"replay_event"!==e.type?e.type:"event";i=e,(s=n&&n.sdk)&&(i.sdk=i.sdk||{},i.sdk.name=i.sdk.name||s.name,i.sdk.version=i.sdk.version||s.version,i.sdk.integrations=[...i.sdk.integrations||[],...s.integrations||[]],i.sdk.packages=[...i.sdk.packages||[],...s.packages||[]]);let l=function(e,t,n,r){let i=e.sdkProcessingMetadata&&e.sdkProcessingMetadata.dynamicSamplingContext;return{event_id:e.event_id,sent_at:new Date().toISOString(),...t&&{sdk:t},...!!n&&{dsn:eQ(r)},...i&&{trace:z({...i})}}}(e,a,r,t);delete e.sdkProcessingMetadata;let u=[{type:o},e];return e0(l,[u])}(e,this._dsn,this._options._metadata,this._options.tunnel);for(let r of t.attachments||[])n=function(e,t){let[n,r]=e;return[n,[...r,t]]}(n,function(e,t){let n="string"==typeof e.data?e2(e.data,t):e.data;return[z({type:"attachment",length:n.length,filename:e.filename,content_type:e.contentType,attachment_type:e.attachmentType}),n]}(r,this._options.transportOptions&&this._options.transportOptions.textEncoder));let i=this._sendEnvelope(n);i&&i.then(t=>this.emit("afterSendEvent",e,t),null)}}sendSession(e){if(this._dsn){let t=function(e,t,n,r){let i=e9(n),s={sent_at:new Date().toISOString(),...i&&{sdk:i},...!!r&&{dsn:eQ(t)}};return e0(s,["aggregates"in e?[{type:"sessions"},e]:[{type:"session"},e]])}(e,this._dsn,this._options._metadata,this._options.tunnel);this._sendEnvelope(t)}}recordDroppedEvent(e,t,n){if(this._options.sendClientReports){let i=`${e}:${t}`;("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&r.log(`Adding outcome: "${i}"`),this._outcomes[i]=this._outcomes[i]+1||1}}on(e,t){this._hooks[e]||(this._hooks[e]=[]),this._hooks[e].push(t)}emit(e,...t){this._hooks[e]&&this._hooks[e].forEach(e=>e(...t))}_updateSessionFromEvent(e,t){let n=!1,r=!1,i=t.exception&&t.exception.values;if(i)for(let s of(r=!0,i)){let a=s.mechanism;if(a&&!1===a.handled){n=!0;break}}let o="ok"===e.status,l=o&&0===e.errors||o&&n;l&&(eo(e,{...n&&{status:"crashed"},errors:e.errors||Number(r||n)}),this.captureSession(e))}_isClientDoneProcessing(e){return new ea(t=>{let n=0,r=setInterval(()=>{0==this._numProcessing?(clearInterval(r),t(!0)):(n+=1,e&&n>=e&&(clearInterval(r),t(!1)))},1)})}_isEnabled(){return!1!==this.getOptions().enabled&&void 0!==this._dsn}_prepareEvent(e,t,n){let r=this.getOptions(),i=Object.keys(this._integrations);return!t.integrations&&i.length>0&&(t.integrations=i),function(e,t,n,r){var i;let{normalizeDepth:s=3,normalizeMaxBreadth:a=1e3}=e,o={...t,event_id:t.event_id||n.event_id||K(),timestamp:t.timestamp||(0,Z.yW)()},l=n.integrations||e.integrations.map(e=>e.name);(function(e,t){let{environment:n,release:r,dist:i,maxValueLength:s=250}=t;"environment"in e||(e.environment="environment"in t?n:er),void 0===e.release&&void 0!==r&&(e.release=r),void 0===e.dist&&void 0!==i&&(e.dist=i),e.message&&(e.message=L(e.message,s));let a=e.exception&&e.exception.values&&e.exception.values[0];a&&a.value&&(a.value=L(a.value,s));let o=e.request;o&&o.url&&(o.url=L(o.url,s))})(o,e),i=o,l.length>0&&(i.sdk=i.sdk||{},i.sdk.integrations=[...i.sdk.integrations||[],...l]),void 0===t.type&&function(e,t){let n;let r=A.n2._sentryDebugIds;if(!r)return;let i=e6.get(t);i?n=i:(n=new Map,e6.set(t,n));let s=Object.keys(r).reduce((e,i)=>{let s;let a=n.get(i);a?s=a:(s=t(i),n.set(i,s));for(let o=s.length-1;o>=0;o--){let l=s[o];if(l.filename){e[l.filename]=r[i];break}}return e},{}),a=new Set;try{e.exception.values.forEach(e=>{e.stacktrace.frames.forEach(e=>{e.filename&&a.add(e.filename)})})}catch(o){}e.debug_meta=e.debug_meta||{},e.debug_meta.images=e.debug_meta.images||[];let l=e.debug_meta.images;a.forEach(e=>{s[e]&&l.push({type:"sourcemap",code_file:e,debug_id:s[e]})})}(o,e.stackParser);let u=r;n.captureContext&&(u=el.clone(u).update(n.captureContext));let c=ei(o);if(u){if(u.getAttachments){let h=[...n.attachments||[],...u.getAttachments()];h.length&&(n.attachments=h)}c=u.applyToEvent(o,n)}return c.then(e=>"number"==typeof s&&s>0?function(e,t,n){if(!e)return null;let r={...e,...e.breadcrumbs&&{breadcrumbs:e.breadcrumbs.map(e=>({...e,...e.data&&{data:eZ(e.data,t,n)}}))},...e.user&&{user:eZ(e.user,t,n)},...e.contexts&&{contexts:eZ(e.contexts,t,n)},...e.extra&&{extra:eZ(e.extra,t,n)}};return e.contexts&&e.contexts.trace&&r.contexts&&(r.contexts.trace=e.contexts.trace,e.contexts.trace.data&&(r.contexts.trace.data=eZ(e.contexts.trace.data,t,n))),e.spans&&(r.spans=e.spans.map(e=>(e.data&&(e.data=eZ(e.data,t,n)),e))),r}(e,s,a):e)}(r,e,t,n)}_captureEvent(e,t={},n){return this._processEvent(e,t,n).then(e=>e.event_id,e=>{("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&("log"===e.logLevel?r.log(e.message):r.warn(e))})}_processEvent(e,t,n){let r=this.getOptions(),{sampleRate:i}=r;if(!this._isEnabled())return es(new eH("SDK not enabled, will not capture event.","log"));let s=e8(e),a=e7(e),o=e.type||"error",l=`before send for type \`${o}\``;if(a&&"number"==typeof i&&Math.random()>i)return this.recordDroppedEvent("sample_rate","error",e),es(new eH(`Discarding event because it's not included in the random sample (sampling rate = ${i})`,"log"));let u="replay_event"===o?"replay":o;return this._prepareEvent(e,t,n).then(n=>{if(null===n)throw this.recordDroppedEvent("event_processor",u,e),new eH("An event processor returned `null`, will not send event.","log");let i=t.data&&!0===t.data.__sentry__;if(i)return n;let s=function(e,t,n){let{beforeSend:r,beforeSendTransaction:i}=e;return e7(t)&&r?r(t,n):e8(t)&&i?i(t,n):t}(r,n,t);return function(e,t){let n=`${t} must return \`null\` or a valid event.`;if(E(e))return e.then(e=>{if(!w(e)&&null!==e)throw new eH(n);return e},e=>{throw new eH(`${t} rejected with ${e}`)});if(!w(e)&&null!==e)throw new eH(n);return e}(s,l)}).then(r=>{if(null===r)throw this.recordDroppedEvent("before_send",u,e),new eH(`${l} returned \`null\`, will not send event.`,"log");let i=n&&n.getSession();!s&&i&&this._updateSessionFromEvent(i,r);let a=r.transaction_info;return s&&a&&r.transaction!==e.transaction&&(r.transaction_info={...a,source:"custom"}),this.sendEvent(r,t),r}).then(null,e=>{if(e instanceof eH)throw e;throw this.captureException(e,{data:{__sentry__:!0},originalException:e}),new eH(`Event processing pipeline threw an error, original event will not be sent. Details have been sent as a new event.
Reason: ${e}`)})}_process(e){this._numProcessing++,e.then(e=>(this._numProcessing--,e),e=>(this._numProcessing--,e))}_sendEnvelope(e){if(this._transport&&this._dsn)return this.emit("beforeEnvelope",e),this._transport.send(e).then(null,e=>{("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&r.error("Error while sending event:",e)});("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&r.error("Transport disabled")}_clearOutcomes(){let e=this._outcomes;return this._outcomes={},Object.keys(e).map(t=>{let[n,r]=t.split(":");return{reason:n,category:r,quantity:e[t]}})}}function e7(e){return void 0===e.type}function e8(e){return"transaction"===e.type}var te=n(8518);function tt(e,t){let n=tr(e,t),r={type:t&&t.name,value:function(e){let t=e&&e.message;return t?t.error&&"string"==typeof t.error.message?t.error.message:t:"No error message"}(t)};return n.length&&(r.stacktrace={frames:n}),void 0===r.type&&""===r.value&&(r.value="Unrecoverable error caught"),r}function tn(e,t){return{exception:{values:[tt(e,t)]}}}function tr(e,t){let n=t.stacktrace||t.stack||"",r=function(e){if(e){if("number"==typeof e.framesToPop)return e.framesToPop;if(ti.test(e.message))return 1}return 0}(t);try{return e(n,r)}catch(i){}return[]}let ti=/Minified React error #\d+;/i;function ts(e,t,n,r,i){let s;if(g(t)&&t.error)return tn(e,t.error);if(y(t)||m(t,"DOMException")){if("stack"in t)s=tn(e,t);else{let a=t.name||(y(t)?"DOMError":"DOMException"),o=t.message?`${a}: ${t.message}`:a;W(s=ta(e,o,n,r),o)}return"code"in t&&(s.tags={...s.tags,"DOMException.code":`${t.code}`}),s}return p(t)?tn(e,t):w(t)||b(t)?(Q(s=function(e,t,n,r){let i=ep(),s=i.getClient(),a=s&&s.getOptions().normalizeDepth,o={exception:{values:[{type:b(t)?t.constructor.name:r?"UnhandledRejection":"Error",value:`Non-Error ${r?"promise rejection":"exception"} captured with keys: ${function(e,t=40){let n=Object.keys(V(e));if(n.sort(),!n.length)return"[object has no keys]";if(n[0].length>=t)return L(n[0],t);for(let r=n.length;r>0;r--){let i=n.slice(0,r).join(", ");if(!(i.length>t)){if(r===n.length)return i;return L(i,t)}}return""}(t)}`}]},extra:{__serialized__:function e(t,n=3,r=102400){let i=eZ(t,n);return~-encodeURI(JSON.stringify(i)).split(/%..|./).length>r?e(t,n-1,r):i}(t,a)}};if(n){let l=tr(e,n);l.length&&(o.exception.values[0].stacktrace={frames:l})}return o}(e,t,n,i),{synthetic:!0}),s):(W(s=ta(e,t,n,r),`${t}`,void 0),Q(s,{synthetic:!0}),s)}function ta(e,t,n,r){let i={message:t};if(r&&n){let s=tr(e,n);s.length&&(i.exception={values:[{value:t,stacktrace:{frames:s}}]})}return i}let to=A.n2,tl=0;function tu(e,t={},n){if("function"!=typeof e)return e;try{let r=e.__sentry_wrapped__;if(r)return r;if($(e))return e}catch(i){return e}let s=function(){let r=Array.prototype.slice.call(arguments);try{n&&"function"==typeof n&&n.apply(this,arguments);let i=r.map(e=>tu(e,t));return e.apply(this,i)}catch(a){var s;throw tl++,setTimeout(()=>{tl--}),s=e=>{e.addEventProcessor(e=>(t.mechanism&&(W(e,void 0,void 0),Q(e,t.mechanism)),e.extra={...e.extra,arguments:r},e)),ep().captureException(a,{captureContext:void 0})},ep().withScope(s),a}};try{for(let a in e)Object.prototype.hasOwnProperty.call(e,a)&&(s[a]=e[a])}catch(o){}B(s,e),j(e,"__sentry_wrapped__",s);try{let l=Object.getOwnPropertyDescriptor(s,"name");l.configurable&&Object.defineProperty(s,"name",{get:()=>e.name})}catch(u){}return s}let tc=["fatal","error","warning","log","info","debug"];function th(e){if(!e)return{};let t=e.match(/^(([^:/?#]+):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?$/);if(!t)return{};let n=t[6]||"",r=t[8]||"";return{host:t[4],path:t[5],protocol:t[2],search:n,hash:r,relative:t[5]+n+r}}let td="Breadcrumbs";class tf{static __initStatic(){this.id=td}__init(){this.name=tf.id}constructor(e){tf.prototype.__init.call(this),this.options={console:!0,dom:!0,fetch:!0,history:!0,sentry:!0,xhr:!0,...e}}setupOnce(){var e;this.options.console&&e$("console",tp),this.options.dom&&e$("dom",(e=this.options.dom,function(t){let n;let i="object"==typeof e?e.serializeAttribute:void 0,s="object"==typeof e&&"number"==typeof e.maxStringLength?e.maxStringLength:void 0;s&&s>1024&&(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&r.warn(`\`dom.maxStringLength\` cannot exceed 1024, but a value of ${s} was configured. Sentry will use 1024 instead.`),s=1024),"string"==typeof i&&(i=[i]);try{let a=t.event;n=a&&a.target?P(a.target,{keyAttrs:i,maxStringLength:s}):P(a,{keyAttrs:i,maxStringLength:s})}catch(o){n="<unknown>"}0!==n.length&&ep().addBreadcrumb({category:`ui.${t.name}`,message:n},{event:t.event,name:t.name,global:t.global})})),this.options.xhr&&e$("xhr",tm),this.options.fetch&&e$("fetch",tg),this.options.history&&e$("history",ty)}addSentryBreadcrumb(e){this.options.sentry&&ep().addBreadcrumb({category:`sentry.${"transaction"===e.type?"transaction":"event"}`,event_id:e.event_id,level:e.level,message:H(e)},{event:e})}}function tp(e){var t;for(let n=0;n<e.args.length;n++)if("ref=Ref<"===e.args[n]){e.args[n+1]="viewRef";break}let r={category:"console",data:{arguments:e.args,logger:"console"},level:"warn"===(t=e.level)?"warning":tc.includes(t)?t:"log",message:M(e.args," ")};if("assert"===e.level){if(!1!==e.args[0])return;r.message=`Assertion failed: ${M(e.args.slice(1)," ")||"console.assert"}`,r.data.arguments=e.args.slice(1)}ep().addBreadcrumb(r,{input:e.args,level:e.level})}function tm(e){let{startTimestamp:t,endTimestamp:n}=e,r=e.xhr[eF];if(!t||!n||!r)return;let{method:i,url:s,status_code:a,body:o}=r,l={xhr:e.xhr,input:o,startTimestamp:t,endTimestamp:n};ep().addBreadcrumb({category:"xhr",data:{method:i,url:s,status_code:a},type:"http"},l)}function tg(e){let{startTimestamp:t,endTimestamp:n}=e;if(!(!n||e.fetchData.url.match(/sentry_key/)&&"POST"===e.fetchData.method)){if(e.error){let r=e.fetchData,i={data:e.error,input:e.args,startTimestamp:t,endTimestamp:n};ep().addBreadcrumb({category:"fetch",data:r,level:"error",type:"http"},i)}else{let s={...e.fetchData,status_code:e.response&&e.response.status},a={input:e.args,response:e.response,startTimestamp:t,endTimestamp:n};ep().addBreadcrumb({category:"fetch",data:s,type:"http"},a)}}}function ty(e){let t=e.from,n=e.to,r=th(to.location.href),i=th(t),s=th(n);i.path||(i=r),r.protocol===s.protocol&&r.host===s.host&&(n=s.relative),r.protocol===i.protocol&&r.host===i.host&&(t=i.relative),ep().addBreadcrumb({category:"navigation",data:{from:t,to:n}})}tf.__initStatic();class t_ extends e3{constructor(e){let t=to.SENTRY_SDK_SOURCE||(0,te.S)();e._metadata=e._metadata||{},e._metadata.sdk=e._metadata.sdk||{name:"sentry.javascript.browser",packages:[{name:`${t}:@sentry/browser`,version:eE}],version:eE},super(e),e.sendClientReports&&to.document&&to.document.addEventListener("visibilitychange",()=>{"hidden"===to.document.visibilityState&&this._flushOutcomes()})}eventFromException(e,t){return function(e,t,n,r){let i=n&&n.syntheticException||void 0,s=ts(e,t,i,r);return Q(s),s.level="error",n&&n.event_id&&(s.event_id=n.event_id),ei(s)}(this._options.stackParser,e,t,this._options.attachStacktrace)}eventFromMessage(e,t="info",n){return function(e,t,n="info",r,i){let s=r&&r.syntheticException||void 0,a=ta(e,t,s,i);return a.level=n,r&&r.event_id&&(a.event_id=r.event_id),ei(a)}(this._options.stackParser,e,t,n,this._options.attachStacktrace)}sendEvent(e,t){let n=this.getIntegrationById(td);n&&n.addSentryBreadcrumb&&n.addSentryBreadcrumb(e),super.sendEvent(e,t)}captureUserFeedback(e){if(!this._isEnabled()){("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&r.warn("SDK not enabled, will not capture user feedback.");return}let t=function(e,{metadata:t,tunnel:n,dsn:r}){let i={event_id:e.event_id,sent_at:new Date().toISOString(),...t&&t.sdk&&{sdk:{name:t.sdk.name,version:t.sdk.version}},...!!n&&!!r&&{dsn:eQ(r)}};return e0(i,[[{type:"user_report"},e]])}(e,{metadata:this.getSdkMetadata(),dsn:this.getDsn(),tunnel:this.getOptions().tunnel});this._sendEnvelope(t)}_prepareEvent(e,t,n){return e.platform=e.platform||"javascript",super._prepareEvent(e,t,n)}_flushOutcomes(){let e=this._clearOutcomes();if(0===e.length){("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&r.log("No outcomes to send");return}if(!this._dsn){("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&r.log("No dsn provided, will not send outcomes");return}("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&r.log("Sending outcomes:",e);let t=function(e,t,n){let r=[{type:"client_report"},{timestamp:(0,Z.yW)(),discarded_events:e}];return e0(t?{dsn:t}:{},[r])}(e,this._options.tunnel&&eQ(this._dsn));this._sendEnvelope(t)}}class tv{static __initStatic(){this.id="GlobalHandlers"}__init(){this.name=tv.id}__init2(){this._installFunc={onerror:tw,onunhandledrejection:tb}}constructor(e){tv.prototype.__init.call(this),tv.prototype.__init2.call(this),this._options={onerror:!0,onunhandledrejection:!0,...e}}setupOnce(){Error.stackTraceLimit=50;let e=this._options;for(let t in e){var n;let i=this._installFunc[t];i&&e[t]&&(n=t,("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&r.log(`Global Handler attached: ${n}`),i(),this._installFunc[t]=void 0)}}}function tw(){e$("error",e=>{let[t,n,r]=tS();if(!t.getIntegration(tv))return;let{msg:i,url:s,line:a,column:o,error:l}=e;if(tl>0||l&&l.__sentry_own_request__)return;let u=void 0===l&&_(i)?function(e,t,n,r){let i=g(e)?e.message:e,s="Error",a=i.match(/^(?:[Uu]ncaught (?:exception: )?)?(?:((?:Eval|Internal|Range|Reference|Syntax|Type|URI|)Error): )?(.*)$/i);a&&(s=a[1],i=a[2]);let o={exception:{values:[{type:s,value:i}]}};return tE(o,t,n,r)}(i,s,a,o):tE(ts(n,l||i,void 0,r,!1),s,a,o);u.level="error",tI(t,l,u,"onerror")})}function tb(){e$("unhandledrejection",e=>{let[t,n,r]=tS();if(!t.getIntegration(tv))return;let i=e;try{"reason"in e?i=e.reason:"detail"in e&&"reason"in e.detail&&(i=e.detail.reason)}catch(s){}if(tl>0||i&&i.__sentry_own_request__)return!0;let a=v(i)?{exception:{values:[{type:"UnhandledRejection",value:`Non-Error promise rejection captured with value: ${String(i)}`}]}}:ts(n,i,void 0,r,!0);a.level="error",tI(t,i,a,"onunhandledrejection")})}function tE(e,t,n,r){let i=e.exception=e.exception||{},s=i.values=i.values||[],a=s[0]=s[0]||{},o=a.stacktrace=a.stacktrace||{},l=o.frames=o.frames||[],u=isNaN(parseInt(r,10))?void 0:r,c=isNaN(parseInt(n,10))?void 0:n,h=_(t)&&t.length>0?t:function(){try{return O.document.location.href}catch(e){return""}}();return 0===l.length&&l.push({colno:u,filename:h,function:"?",in_app:!0,lineno:c}),e}function tI(e,t,n,r){Q(n,{handled:!1,type:r}),e.captureEvent(n,{originalException:t})}function tS(){let e=ep(),t=e.getClient(),n=t&&t.getOptions()||{stackParser:()=>[],attachStacktrace:!1};return[e,n.stackParser,n.attachStacktrace]}tv.__initStatic();let tT=["EventTarget","Window","Node","ApplicationCache","AudioTrackList","ChannelMergerNode","CryptoOperation","EventSource","FileReader","HTMLUnknownElement","IDBDatabase","IDBRequest","IDBTransaction","KeyOperation","MediaController","MessagePort","ModalWindow","Notification","SVGElementInstance","Screen","TextTrack","TextTrackCue","TextTrackList","WebSocket","WebSocketWorker","Worker","XMLHttpRequest","XMLHttpRequestEventTarget","XMLHttpRequestUpload"];class tD{static __initStatic(){this.id="TryCatch"}__init(){this.name=tD.id}constructor(e){tD.prototype.__init.call(this),this._options={XMLHttpRequest:!0,eventTarget:!0,requestAnimationFrame:!0,setInterval:!0,setTimeout:!0,...e}}setupOnce(){this._options.setTimeout&&F(to,"setTimeout",tx),this._options.setInterval&&F(to,"setInterval",tx),this._options.requestAnimationFrame&&F(to,"requestAnimationFrame",tk),this._options.XMLHttpRequest&&"XMLHttpRequest"in to&&F(XMLHttpRequest.prototype,"send",tC);let e=this._options.eventTarget;if(e){let t=Array.isArray(e)?e:tT;t.forEach(tN)}}}function tx(e){return function(...t){let n=t[0];return t[0]=tu(n,{mechanism:{data:{function:eA(e)},handled:!0,type:"instrument"}}),e.apply(this,t)}}function tk(e){return function(t){return e.apply(this,[tu(t,{mechanism:{data:{function:"requestAnimationFrame",handler:eA(e)},handled:!0,type:"instrument"}})])}}function tC(e){return function(...t){let n=this;return["onload","onerror","onprogress","onreadystatechange"].forEach(e=>{e in n&&"function"==typeof n[e]&&F(n,e,function(t){let n={mechanism:{data:{function:e,handler:eA(t)},handled:!0,type:"instrument"}},r=$(t);return r&&(n.mechanism.data.handler=eA(r)),tu(t,n)})}),e.apply(this,t)}}function tN(e){let t=to[e]&&to[e].prototype;t&&t.hasOwnProperty&&t.hasOwnProperty("addEventListener")&&(F(t,"addEventListener",function(t){return function(n,r,i){try{"function"==typeof r.handleEvent&&(r.handleEvent=tu(r.handleEvent,{mechanism:{data:{function:"handleEvent",handler:eA(r),target:e},handled:!0,type:"instrument"}}))}catch(s){}return t.apply(this,[n,tu(r,{mechanism:{data:{function:"addEventListener",handler:eA(r),target:e},handled:!0,type:"instrument"}}),i])}}),F(t,"removeEventListener",function(e){return function(t,n,r){try{let i=n&&n.__sentry_wrapped__;i&&e.call(this,t,i,r)}catch(s){}return e.call(this,t,n,r)}}))}tD.__initStatic();class tR{static __initStatic(){this.id="LinkedErrors"}__init(){this.name=tR.id}constructor(e={}){tR.prototype.__init.call(this),this._key=e.key||"cause",this._limit=e.limit||5}setupOnce(){let e=ep().getClient();e&&ec((t,n)=>{let r=ep().getIntegration(tR);return r?function(e,t,n,r,i){if(!r.exception||!r.exception.values||!i||!S(i.originalException,Error))return r;let s=function e(t,n,r,i,s=[]){if(!S(r[i],Error)||s.length+1>=n)return s;let a=tt(t,r[i]);return e(t,n,r[i],i,[a,...s])}(e,n,i.originalException,t);return r.exception.values=[...s,...r.exception.values],r}(e.getOptions().stackParser,r._key,r._limit,t,n):t})}}tR.__initStatic();class tA{constructor(){tA.prototype.__init.call(this)}static __initStatic(){this.id="HttpContext"}__init(){this.name=tA.id}setupOnce(){ec(e=>{if(ep().getIntegration(tA)){if(!to.navigator&&!to.location&&!to.document)return e;let t=e.request&&e.request.url||to.location&&to.location.href,{referrer:n}=to.document||{},{userAgent:r}=to.navigator||{},i={...e.request&&e.request.headers,...n&&{Referer:n},...r&&{"User-Agent":r}},s={...e.request,...t&&{url:t},headers:i};return{...e,request:s}}return e})}}tA.__initStatic();class tO{constructor(){tO.prototype.__init.call(this)}static __initStatic(){this.id="Dedupe"}__init(){this.name=tO.id}setupOnce(e,t){let n=e=>{if(e.type)return e;let n=t().getIntegration(tO);if(n){try{var i;if((i=n._previousEvent)&&(function(e,t){let n=e.message,r=t.message;return!!((n||r)&&(!n||r)&&(n||!r)&&n===r&&tL(e,t)&&tP(e,t))}(e,i)||function(e,t){let n=tM(t),r=tM(e);return!!(n&&r&&n.type===r.type&&n.value===r.value&&tL(e,t)&&tP(e,t))}(e,i)))return("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&r.warn("Event dropped due to being a duplicate of previously captured event."),null}catch(s){}return n._previousEvent=e}return e};n.id=this.name,e(n)}}function tP(e,t){let n=tU(e),r=tU(t);if(!n&&!r)return!0;if(n&&!r||!n&&r||r.length!==n.length)return!1;for(let i=0;i<r.length;i++){let s=r[i],a=n[i];if(s.filename!==a.filename||s.lineno!==a.lineno||s.colno!==a.colno||s.function!==a.function)return!1}return!0}function tL(e,t){let n=e.fingerprint,r=t.fingerprint;if(!n&&!r)return!0;if(n&&!r||!n&&r)return!1;try{return!(n.join("")!==r.join(""))}catch(i){return!1}}function tM(e){return e.exception&&e.exception.values&&e.exception.values[0]}function tU(e){let t=e.exception;if(t)try{return t.values[0].stacktrace.frames}catch(n){}}function tF(e,t,n,r){let i={filename:e,function:t,in_app:!0};return void 0!==n&&(i.lineno=n),void 0!==r&&(i.colno=r),i}tO.__initStatic();let tj=/^\s*at (?:(.+?\)(?: \[.+\])?|.*?) ?\((?:address at )?)?(?:async )?((?:<anonymous>|[-a-z]+:|.*bundle|\/)?.*?)(?::(\d+))?(?::(\d+))?\)?\s*$/i,tB=/\((\S*)(?::(\d+))(?::(\d+))\)/,t$=e=>{let t=tj.exec(e);if(t){let n=t[2]&&0===t[2].indexOf("eval");if(n){let r=tB.exec(t[2]);r&&(t[2]=r[1],t[3]=r[2],t[4]=r[3])}let[i,s]=tH(t[1]||"?",t[2]);return tF(s,i,t[3]?+t[3]:void 0,t[4]?+t[4]:void 0)}},tV=/^\s*(.*?)(?:\((.*?)\))?(?:^|@)?((?:[-a-z]+)?:\/.*?|\[native code\]|[^@]*(?:bundle|\d+\.js)|\/[\w\-. /=]+)(?::(\d+))?(?::(\d+))?\s*$/i,tG=/(\S+) line (\d+)(?: > eval line \d+)* > eval/i,tq=e=>{let t=tV.exec(e);if(t){let n=t[3]&&t[3].indexOf(" > eval")>-1;if(n){let r=tG.exec(t[3]);r&&(t[1]=t[1]||"eval",t[3]=r[1],t[4]=r[2],t[5]="")}let i=t[3],s=t[1]||"?";return[s,i]=tH(s,i),tF(i,s,t[4]?+t[4]:void 0,t[5]?+t[5]:void 0)}},tz=/^\s*at (?:((?:\[object object\])?.+) )?\(?((?:[-a-z]+):.*?):(\d+)(?::(\d+))?\)?\s*$/i,tK=e=>{let t=tz.exec(e);return t?tF(t[2],t[1]||"?",+t[3],t[4]?+t[4]:void 0):void 0},tY=eN(...[[30,t$],[50,tq],[40,tK]]),tH=(e,t)=>{let n=-1!==e.indexOf("safari-extension"),r=-1!==e.indexOf("safari-web-extension");return n||r?[-1!==e.indexOf("@")?e.split("@")[0]:"?",n?`safari-extension:${t}`:`safari-web-extension:${t}`]:[e,t]};function tW(e,t,n=function(e){let t=[];function n(e){return t.splice(t.indexOf(e),1)[0]}return{$:t,add:function(r){if(!(void 0===e||t.length<e))return es(new eH("Not adding Promise because buffer limit was reached."));let i=r();return -1===t.indexOf(i)&&t.push(i),i.then(()=>n(i)).then(null,()=>n(i).then(null,()=>{})),i},drain:function(e){return new ea((n,r)=>{let i=t.length;if(!i)return n(!0);let s=setTimeout(()=>{e&&e>0&&n(!1)},e);t.forEach(e=>{ei(e).then(()=>{--i||(clearTimeout(s),n(!0))},r)})})}}}(e.bufferSize||30)){let i={},s=e=>n.drain(e);function a(s){let a=[];if(e1(s,(t,n)=>{let r=e4[n];if(function(e,t,n=Date.now()){return(e[t]||e.all||0)>n}(i,r)){let s=tQ(t,n);e.recordDroppedEvent("ratelimit_backoff",r,s)}else a.push(t)}),0===a.length)return ei();let o=e0(s[0],a),l=t=>{e1(o,(n,r)=>{let i=tQ(n,r);e.recordDroppedEvent(t,e4[r],i)})},u=()=>t({body:function(e,t){let[n,r]=e,i=JSON.stringify(n);function s(e){"string"==typeof i?i="string"==typeof e?i+e:[e2(i,t),e]:i.push("string"==typeof e?e2(e,t):e)}for(let a of r){let[o,l]=a;if(s(`
${JSON.stringify(o)}
`),"string"==typeof l||l instanceof Uint8Array)s(l);else{let u;try{u=JSON.stringify(l)}catch(c){u=JSON.stringify(eZ(l))}s(u)}}return"string"==typeof i?i:function(e){let t=e.reduce((e,t)=>e+t.length,0),n=new Uint8Array(t),r=0;for(let i of e)n.set(i,r),r+=i.length;return n}(i)}(o,e.textEncoder)}).then(e=>(void 0!==e.statusCode&&(e.statusCode<200||e.statusCode>=300)&&("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&r.warn(`Sentry responded with status code ${e.statusCode} to sent event.`),i=function(e,{statusCode:t,headers:n},r=Date.now()){let i={...e},s=n&&n["x-sentry-rate-limits"],a=n&&n["retry-after"];if(s)for(let o of s.trim().split(",")){let[l,u]=o.split(":",2),c=parseInt(l,10),h=(isNaN(c)?60:c)*1e3;if(u)for(let d of u.split(";"))i[d]=r+h;else i.all=r+h}else a?i.all=r+function(e,t=Date.now()){let n=parseInt(`${e}`,10);if(!isNaN(n))return 1e3*n;let r=Date.parse(`${e}`);return isNaN(r)?6e4:r-t}(a,r):429===t&&(i.all=r+6e4);return i}(i,e),e),e=>{throw l("network_error"),e});return n.add(u).then(e=>e,e=>{if(e instanceof eH)return("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&r.error("Skipped sending event because buffer is full."),l("queue_overflow"),ei();throw e})}return a.__sentry__baseTransport__=!0,{send:a,flush:s}}function tQ(e,t){if("event"===t||"transaction"===t)return Array.isArray(e)?e[1]:void 0}function tX(e,t=function(){if(c)return c;if(eL(to.fetch))return c=to.fetch.bind(to);let e=to.document,t=to.fetch;if(e&&"function"==typeof e.createElement)try{let n=e.createElement("iframe");n.hidden=!0,e.head.appendChild(n);let i=n.contentWindow;i&&i.fetch&&(t=i.fetch),e.head.removeChild(n)}catch(s){("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&r.warn("Could not create sandbox iframe for pure fetch check, bailing to window.fetch: ",s)}return c=t.bind(to)}()){let n=0,i=0;return tW(e,function(r){let s=r.body.length;n+=s,i++;let a={body:r.body,method:"POST",referrerPolicy:"origin",headers:e.headers,keepalive:n<=6e4&&i<15,...e.fetchOptions};try{return t(e.url,a).then(e=>(n-=s,i--,{statusCode:e.status,headers:{"x-sentry-rate-limits":e.headers.get("X-Sentry-Rate-Limits"),"retry-after":e.headers.get("Retry-After")}}))}catch(o){return c=void 0,n-=s,i--,es(o)}})}function tJ(e){return tW(e,function(t){return new ea((n,r)=>{let i=new XMLHttpRequest;for(let s in i.onerror=r,i.onreadystatechange=()=>{4===i.readyState&&n({statusCode:i.status,headers:{"x-sentry-rate-limits":i.getResponseHeader("X-Sentry-Rate-Limits"),"retry-after":i.getResponseHeader("Retry-After")}})},i.open("POST",e.url),e.headers)Object.prototype.hasOwnProperty.call(e.headers,s)&&i.setRequestHeader(s,e.headers[s]);i.send(t.body)})})}let tZ=[new eS,new eD,new tD,new tf,new tv,new tR,new tO,new tA];function t0(e){e.startSession({ignoreDuration:!0}),e.captureSession()}class t1{__init(){this.spans=[]}constructor(e=1e3){t1.prototype.__init.call(this),this._maxlen=e}add(e){this.spans.length>this._maxlen?e.spanRecorder=void 0:this.spans.push(e)}}class t2{__init2(){this.traceId=K()}__init3(){this.spanId=K().substring(16)}__init4(){this.startTimestamp=(0,Z.ph)()}__init5(){this.tags={}}__init6(){this.data={}}__init7(){this.instrumenter="sentry"}constructor(e){if(t2.prototype.__init2.call(this),t2.prototype.__init3.call(this),t2.prototype.__init4.call(this),t2.prototype.__init5.call(this),t2.prototype.__init6.call(this),t2.prototype.__init7.call(this),!e)return this;e.traceId&&(this.traceId=e.traceId),e.spanId&&(this.spanId=e.spanId),e.parentSpanId&&(this.parentSpanId=e.parentSpanId),"sampled"in e&&(this.sampled=e.sampled),e.op&&(this.op=e.op),e.description&&(this.description=e.description),e.data&&(this.data=e.data),e.tags&&(this.tags=e.tags),e.status&&(this.status=e.status),e.startTimestamp&&(this.startTimestamp=e.startTimestamp),e.endTimestamp&&(this.endTimestamp=e.endTimestamp),e.instrumenter&&(this.instrumenter=e.instrumenter)}startChild(e){let t=new t2({...e,parentSpanId:this.spanId,sampled:this.sampled,traceId:this.traceId});if(t.spanRecorder=this.spanRecorder,t.spanRecorder&&t.spanRecorder.add(t),t.transaction=this.transaction,("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&t.transaction){let n=e&&e.op||"< unknown op >",i=t.transaction.name||"< unknown name >",s=t.transaction.spanId,a=`[Tracing] Starting '${n}' span on transaction '${i}' (${s}).`;t.transaction.metadata.spanMetadata[t.spanId]={logMessage:a},r.log(a)}return t}setTag(e,t){return this.tags={...this.tags,[e]:t},this}setData(e,t){return this.data={...this.data,[e]:t},this}setStatus(e){return this.status=e,this}setHttpStatus(e){this.setTag("http.status_code",String(e));let t=function(e){if(e<400&&e>=100)return"ok";if(e>=400&&e<500)switch(e){case 401:return"unauthenticated";case 403:return"permission_denied";case 404:return"not_found";case 409:return"already_exists";case 413:return"failed_precondition";case 429:return"resource_exhausted";default:return"invalid_argument"}if(e>=500&&e<600)switch(e){case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline_exceeded";default:return"internal_error"}return"unknown_error"}(e);return"unknown_error"!==t&&this.setStatus(t),this}isSuccess(){return"ok"===this.status}finish(e){if(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&this.transaction&&this.transaction.spanId!==this.spanId){let{logMessage:t}=this.transaction.metadata.spanMetadata[this.spanId];t&&r.log(t.replace("Starting","Finishing"))}this.endTimestamp="number"==typeof e?e:(0,Z.ph)()}toTraceparent(){let e="";return void 0!==this.sampled&&(e=this.sampled?"-1":"-0"),`${this.traceId}-${this.spanId}${e}`}toContext(){return z({data:this.data,description:this.description,endTimestamp:this.endTimestamp,op:this.op,parentSpanId:this.parentSpanId,sampled:this.sampled,spanId:this.spanId,startTimestamp:this.startTimestamp,status:this.status,tags:this.tags,traceId:this.traceId})}updateWithContext(e){return this.data=e.data||{},this.description=e.description,this.endTimestamp=e.endTimestamp,this.op=e.op,this.parentSpanId=e.parentSpanId,this.sampled=e.sampled,this.spanId=e.spanId||this.spanId,this.startTimestamp=e.startTimestamp||this.startTimestamp,this.status=e.status,this.tags=e.tags||{},this.traceId=e.traceId||this.traceId,this}getTraceContext(){return z({data:Object.keys(this.data).length>0?this.data:void 0,description:this.description,op:this.op,parent_span_id:this.parentSpanId,span_id:this.spanId,status:this.status,tags:Object.keys(this.tags).length>0?this.tags:void 0,trace_id:this.traceId})}toJSON(){return z({data:Object.keys(this.data).length>0?this.data:void 0,description:this.description,op:this.op,parent_span_id:this.parentSpanId,span_id:this.spanId,start_timestamp:this.startTimestamp,status:this.status,tags:Object.keys(this.tags).length>0?this.tags:void 0,timestamp:this.endTimestamp,trace_id:this.traceId})}}class t4 extends t2{__init(){this._measurements={}}__init2(){this._contexts={}}__init3(){this._frozenDynamicSamplingContext=void 0}constructor(e,t){super(e),t4.prototype.__init.call(this),t4.prototype.__init2.call(this),t4.prototype.__init3.call(this),this._hub=t||ep(),this._name=e.name||"",this.metadata={source:"custom",...e.metadata,spanMetadata:{}},this._trimEnd=e.trimEnd,this.transaction=this;let n=this.metadata.dynamicSamplingContext;n&&(this._frozenDynamicSamplingContext={...n})}get name(){return this._name}set name(e){this.setName(e)}setName(e,t="custom"){this._name=e,this.metadata.source=t}initSpanRecorder(e=1e3){this.spanRecorder||(this.spanRecorder=new t1(e)),this.spanRecorder.add(this)}setContext(e,t){null===t?delete this._contexts[e]:this._contexts[e]=t}setMeasurement(e,t,n=""){this._measurements[e]={value:t,unit:n}}setMetadata(e){this.metadata={...this.metadata,...e}}finish(e){if(void 0!==this.endTimestamp)return;this.name||(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&r.warn("Transaction has no name, falling back to `<unlabeled transaction>`."),this.name="<unlabeled transaction>"),super.finish(e);let t=this._hub.getClient();if(t&&t.emit&&t.emit("finishTransaction",this),!0!==this.sampled){("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&r.log("[Tracing] Discarding transaction because its trace was not chosen to be sampled."),t&&t.recordDroppedEvent("sample_rate","transaction");return}let n=this.spanRecorder?this.spanRecorder.spans.filter(e=>e!==this&&e.endTimestamp):[];this._trimEnd&&n.length>0&&(this.endTimestamp=n.reduce((e,t)=>e.endTimestamp&&t.endTimestamp?e.endTimestamp>t.endTimestamp?e:t:e).endTimestamp);let i=this.metadata,s={contexts:{...this._contexts,trace:this.getTraceContext()},spans:n,start_timestamp:this.startTimestamp,tags:this.tags,timestamp:this.endTimestamp,transaction:this.name,type:"transaction",sdkProcessingMetadata:{...i,dynamicSamplingContext:this.getDynamicSamplingContext()},...i.source&&{transaction_info:{source:i.source}}},a=Object.keys(this._measurements).length>0;return a&&(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&r.log("[Measurements] Adding measurements to transaction",JSON.stringify(this._measurements,void 0,2)),s.measurements=this._measurements),("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&r.log(`[Tracing] Finishing ${this.op} transaction: ${this.name}.`),this._hub.captureEvent(s)}toContext(){let e=super.toContext();return z({...e,name:this.name,trimEnd:this._trimEnd})}updateWithContext(e){return super.updateWithContext(e),this.name=e.name||"",this._trimEnd=e.trimEnd,this}getDynamicSamplingContext(){if(this._frozenDynamicSamplingContext)return this._frozenDynamicSamplingContext;let e=this._hub||ep(),t=e&&e.getClient();if(!t)return{};let{environment:n,release:r}=t.getOptions()||{},{publicKey:i}=t.getDsn()||{},s=this.metadata.sampleRate,a=void 0!==s?s.toString():void 0,{segment:o}=e.getScope().getUser()||{},l=this.metadata.source,u=l&&"url"!==l?this.name:void 0,c=z({environment:n||er,release:r,transaction:u,user_segment:o,public_key:i,trace_id:this.traceId,sample_rate:a});return t.emit&&t.emit("createDsc",c),c}setHub(e){this._hub=e}}let t9={idleTimeout:1e3,finalTimeout:3e4,heartbeatInterval:5e3};class t6 extends t1{constructor(e,t,n,r){super(r),this._pushActivity=e,this._popActivity=t,this.transactionSpanId=n}add(e){e.spanId!==this.transactionSpanId&&(e.finish=t=>{e.endTimestamp="number"==typeof t?t:(0,Z.ph)(),this._popActivity(e.spanId)},void 0===e.endTimestamp&&this._pushActivity(e.spanId)),super.add(e)}}class t5 extends t4{__init(){this.activities={}}__init2(){this._heartbeatCounter=0}__init3(){this._finished=!1}__init4(){this._idleTimeoutCanceledPermanently=!1}__init5(){this._beforeFinishCallbacks=[]}__init6(){this._finishReason="externalFinish"}constructor(e,t,n=t9.idleTimeout,i=t9.finalTimeout,s=t9.heartbeatInterval,a=!1){super(e,t),this._idleHub=t,this._idleTimeout=n,this._finalTimeout=i,this._heartbeatInterval=s,this._onScope=a,t5.prototype.__init.call(this),t5.prototype.__init2.call(this),t5.prototype.__init3.call(this),t5.prototype.__init4.call(this),t5.prototype.__init5.call(this),t5.prototype.__init6.call(this),a&&(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&r.log(`Setting idle transaction on scope. Span ID: ${this.spanId}`),t.configureScope(e=>e.setSpan(this))),this._restartIdleTimeout(),setTimeout(()=>{this._finished||(this.setStatus("deadline_exceeded"),this._finishReason="finalTimeout",this.finish())},this._finalTimeout)}finish(e=(0,Z.ph)()){if(this._finished=!0,this.activities={},"ui.action.click"===this.op&&this.setTag("finishReason",this._finishReason),this.spanRecorder){for(let t of(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&r.log("[Tracing] finishing IdleTransaction",new Date(1e3*e).toISOString(),this.op),this._beforeFinishCallbacks))t(this,e);this.spanRecorder.spans=this.spanRecorder.spans.filter(t=>{if(t.spanId===this.spanId)return!0;!t.endTimestamp&&(t.endTimestamp=e,t.setStatus("cancelled"),("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&r.log("[Tracing] cancelling span since transaction ended early",JSON.stringify(t,void 0,2)));let n=t.startTimestamp<e;return!n&&("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&r.log("[Tracing] discarding Span since it happened after Transaction was finished",JSON.stringify(t,void 0,2)),n}),("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&r.log("[Tracing] flushing IdleTransaction")}else("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&r.log("[Tracing] No active IdleTransaction");if(this._onScope){let n=this._idleHub.getScope();n.getTransaction()===this&&n.setSpan(void 0)}return super.finish(e)}registerBeforeFinishCallback(e){this._beforeFinishCallbacks.push(e)}initSpanRecorder(e){if(!this.spanRecorder){let t=e=>{this._finished||this._pushActivity(e)},n=e=>{this._finished||this._popActivity(e)};this.spanRecorder=new t6(t,n,this.spanId,e),("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&r.log("Starting heartbeat"),this._pingHeartbeat()}this.spanRecorder.add(this)}cancelIdleTimeout(e,{restartOnChildSpanChange:t}={restartOnChildSpanChange:!0}){this._idleTimeoutCanceledPermanently=!1===t,this._idleTimeoutID&&(clearTimeout(this._idleTimeoutID),this._idleTimeoutID=void 0,0===Object.keys(this.activities).length&&this._idleTimeoutCanceledPermanently&&(this._finishReason="cancelled",this.finish(e)))}setFinishReason(e){this._finishReason=e}_restartIdleTimeout(e){this.cancelIdleTimeout(),this._idleTimeoutID=setTimeout(()=>{this._finished||0!==Object.keys(this.activities).length||(this._finishReason="idleTimeout",this.finish(e))},this._idleTimeout)}_pushActivity(e){this.cancelIdleTimeout(void 0,{restartOnChildSpanChange:!this._idleTimeoutCanceledPermanently}),("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&r.log(`[Tracing] pushActivity: ${e}`),this.activities[e]=!0,("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&r.log("[Tracing] new activities count",Object.keys(this.activities).length)}_popActivity(e){if(this.activities[e]&&(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&r.log(`[Tracing] popActivity ${e}`),delete this.activities[e],("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&r.log("[Tracing] new activities count",Object.keys(this.activities).length)),0===Object.keys(this.activities).length){let t=(0,Z.ph)();this._idleTimeoutCanceledPermanently?(this._finishReason="cancelled",this.finish(t)):this._restartIdleTimeout(t+this._idleTimeout/1e3)}}_beat(){if(this._finished)return;let e=Object.keys(this.activities).join("");e===this._prevHeartbeatString?this._heartbeatCounter++:this._heartbeatCounter=1,this._prevHeartbeatString=e,this._heartbeatCounter>=3?(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&r.log("[Tracing] Transaction finished because of no change for 3 heart beats"),this.setStatus("deadline_exceeded"),this._finishReason="heartbeatFailed",this.finish()):this._pingHeartbeat()}_pingHeartbeat(){("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&r.log(`pinging Heartbeat -> current counter: ${this._heartbeatCounter}`),setTimeout(()=>{this._beat()},this._heartbeatInterval)}}function t3(e){let t=e||ep(),n=t.getScope();return n.getTransaction()}let t7=!1;function t8(){let e=t3();if(e){let t="internal_error";("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&r.log(`[Tracing] Transaction: ${t} -> Global error occured`),e.setStatus(t)}}function ne(){let e=this.getScope(),t=e.getSpan();return t?{"sentry-trace":t.toTraceparent()}:{}}function nt(e,t,n){var i;let s;return ey(t)?void 0!==e.sampled?(e.setMetadata({sampleRate:Number(e.sampled)}),e):("function"==typeof t.tracesSampler?(s=t.tracesSampler(n),e.setMetadata({sampleRate:Number(s)})):void 0!==n.parentSampled?s=n.parentSampled:void 0!==t.tracesSampleRate?(s=t.tracesSampleRate,e.setMetadata({sampleRate:Number(s)})):(s=1,e.setMetadata({sampleRate:s})),I(i=s)||!("number"==typeof i||"boolean"==typeof i)?(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&r.warn(`[Tracing] Given sample rate is invalid. Sample rate must be a boolean or a number between 0 and 1. Got ${JSON.stringify(i)} of type ${JSON.stringify(typeof i)}.`),1):(i<0||i>1)&&(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&r.warn(`[Tracing] Given sample rate is invalid. Sample rate must be between 0 and 1. Got ${i}.`),1))?(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&r.warn("[Tracing] Discarding transaction because of invalid sample rate."),e.sampled=!1,e):s?(e.sampled=Math.random()<s,e.sampled)?(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&r.log(`[Tracing] starting ${e.op} transaction - ${e.name}`),e):(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&r.log(`[Tracing] Discarding transaction because it's not included in the random sample (sampling rate = ${Number(s)})`),e):(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&r.log(`[Tracing] Discarding transaction because ${"function"==typeof t.tracesSampler?"tracesSampler returned 0 or false":"a negative sampling decision was inherited or tracesSampleRate is set to 0"}`),e.sampled=!1,e):(e.sampled=!1,e)}function nn(e,t){let n=this.getClient(),i=n&&n.getOptions()||{},s=i.instrumenter||"sentry",a=e.instrumenter||"sentry";s!==a&&(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&r.error(`A transaction was started with instrumenter=\`${a}\`, but the SDK is configured with the \`${s}\` instrumenter.
The transaction will not be sampled. Please use the ${s} instrumentation to start transactions.`),e.sampled=!1);let o=new t4(e,this);return(o=nt(o,i,{parentSampled:e.parentSampled,transactionContext:e,...t})).sampled&&o.initSpanRecorder(i._experiments&&i._experiments.maxSpans),n&&n.emit&&n.emit("startTransaction",o),o}function nr(e,t,n,r,i,s,a){let o=e.getClient(),l=o&&o.getOptions()||{},u=new t5(t,e,n,r,a,i);return(u=nt(u,l,{parentSampled:t.parentSampled,transactionContext:t,...s})).sampled&&u.initSpanRecorder(l._experiments&&l._experiments.maxSpans),o&&o.emit&&o.emit("startTransaction",u),u}t8.tag="sentry_tracingErrorCallback";let ni=RegExp("^[ \\t]*([0-9a-f]{32})?-?([0-9a-f]{16})?-?([01])?[ \\t]*$");function ns(e){let t;let n=e.match(ni);if(e&&n)return"1"===n[3]?t=!0:"0"===n[3]&&(t=!1),{traceId:n[1],parentSampled:t,parentSpanId:n[2]}}let na="baggage",no="sentry-",nl=/^sentry-/;function nu(e){if(!_(e)&&!Array.isArray(e))return;let t={};if(Array.isArray(e))t=e.reduce((e,t)=>{let n=nh(t);return{...e,...n}},{});else{if(!e)return;t=nh(e)}let n=Object.entries(t).reduce((e,[t,n])=>{if(t.match(nl)){let r=t.slice(no.length);e[r]=n}return e},{});return Object.keys(n).length>0?n:void 0}function nc(e){let t=Object.entries(e).reduce((e,[t,n])=>(n&&(e[`${no}${t}`]=n),e),{});return function(e){if(0!==Object.keys(e).length)return Object.entries(e).reduce((e,[t,n],i)=>{let s=`${encodeURIComponent(t)}=${encodeURIComponent(n)}`,a=0===i?s:`${e},${s}`;return a.length>8192?(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&r.warn(`Not adding key: ${t} with val: ${n} to baggage header due to exceeding baggage size limits.`),e):a},"")}(t)}function nh(e){return e.split(",").map(e=>e.split("=").map(e=>decodeURIComponent(e.trim()))).reduce((e,[t,n])=>(e[t]=n,e),{})}let nd=A.n2,nf=(e,t,n)=>{let r,i;return s=>{t.value>=0&&(s||n)&&((i=t.value-(r||0))||void 0===r)&&(r=t.value,t.delta=i,e(t))}},np=()=>`v3-${Date.now()}-${Math.floor(Math.random()*(9e12-1))+1e12}`,nm=()=>{let e=nd.performance.timing,t=nd.performance.navigation.type,n={entryType:"navigation",startTime:0,type:2==t?"back_forward":1===t?"reload":"navigate"};for(let r in e)"navigationStart"!==r&&"toJSON"!==r&&(n[r]=Math.max(e[r]-e.navigationStart,0));return n},ng=()=>nd.__WEB_VITALS_POLYFILL__?nd.performance&&(performance.getEntriesByType&&performance.getEntriesByType("navigation")[0]||nm()):nd.performance&&performance.getEntriesByType&&performance.getEntriesByType("navigation")[0],ny=()=>{let e=ng();return e&&e.activationStart||0},n_=(e,t)=>{let n=ng(),r="navigate";return n&&(r=nd.document.prerendering||ny()>0?"prerender":n.type.replace(/_/g,"-")),{name:e,value:void 0===t?-1:t,rating:"good",delta:0,entries:[],id:np(),navigationType:r}},nv=(e,t,n)=>{try{if(PerformanceObserver.supportedEntryTypes.includes(e)){let r=new PerformanceObserver(e=>{t(e.getEntries())});return r.observe(Object.assign({type:e,buffered:!0},n||{})),r}}catch(i){}},nw=(e,t)=>{let n=r=>{("pagehide"===r.type||"hidden"===nd.document.visibilityState)&&(e(r),t&&(removeEventListener("visibilitychange",n,!0),removeEventListener("pagehide",n,!0)))};addEventListener("visibilitychange",n,!0),addEventListener("pagehide",n,!0)},nb=e=>{let t;let n=n_("CLS",0),r=0,i=[],s=e=>{e.forEach(e=>{if(!e.hadRecentInput){let s=i[0],a=i[i.length-1];r&&0!==i.length&&e.startTime-a.startTime<1e3&&e.startTime-s.startTime<5e3?(r+=e.value,i.push(e)):(r=e.value,i=[e]),r>n.value&&(n.value=r,n.entries=i,t&&t())}})},a=nv("layout-shift",s);if(a){t=nf(e,n);let o=()=>{s(a.takeRecords()),t(!0)};return nw(o),o}},nE=-1,nI=()=>"hidden"!==nd.document.visibilityState||nd.document.prerendering?1/0:0,nS=()=>{nw(({timeStamp:e})=>{nE=e},!0)},nT=()=>(nE<0&&(nE=nI(),nS()),{get firstHiddenTime(){return nE}}),nD=e=>{let t;let n=nT(),r=n_("FID"),i=e=>{e.startTime<n.firstHiddenTime&&(r.value=e.processingStart-e.startTime,r.entries.push(e),t(!0))},s=e=>{e.forEach(i)},a=nv("first-input",s);t=nf(e,r),a&&nw(()=>{s(a.takeRecords()),a.disconnect()},!0)},nx={},nk=e=>{let t;let n=nT(),r=n_("LCP"),i=e=>{let i=e[e.length-1];if(i){let s=Math.max(i.startTime-ny(),0);s<n.firstHiddenTime&&(r.value=s,r.entries=[i],t())}},s=nv("largest-contentful-paint",i);if(s){t=nf(e,r);let a=()=>{nx[r.id]||(i(s.takeRecords()),s.disconnect(),nx[r.id]=!0,t(!0))};return["keydown","click"].forEach(e=>{addEventListener(e,a,{once:!0,capture:!0})}),nw(a,!0),a}};function nC(e){return"number"==typeof e&&isFinite(e)}function nN(e,{startTimestamp:t,...n}){return t&&e.startTimestamp>t&&(e.startTimestamp=t),e.startChild({startTimestamp:t,...n})}function nR(e){return e/1e3}function nA(){return nd&&nd.addEventListener&&nd.performance}let nO=0,nP={};function nL(e,t,n,r,i,s){let a=s?t[s]:t[`${n}End`],o=t[`${n}Start`];o&&a&&nN(e,{op:"browser",description:i||n,startTimestamp:r+nR(o),endTimestamp:r+nR(a)})}let nM=["localhost",/^\//],nU={traceFetch:!0,traceXHR:!0,tracingOrigins:nM,tracePropagationTargets:nM},nF={...t9,markBackgroundTransactions:!0,routingInstrumentation:function(e,t=!0,n=!0){let i;if(!nd||!nd.location){("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&r.warn("Could not initialize routing instrumentation due to invalid location");return}let s=nd.location.href;t&&(i=e({name:nd.location.pathname,startTimestamp:Z.Z1?Z.Z1/1e3:void 0,op:"pageload",metadata:{source:"url"}})),n&&e$("history",({to:t,from:n})=>{if(void 0===n&&s&&-1!==s.indexOf(t)){s=void 0;return}n!==t&&(s=void 0,i&&(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&r.log(`[Tracing] Finishing current transaction with op: ${i.op}`),i.finish()),i=e({name:nd.location.pathname,op:"navigation",metadata:{source:"url"}}))})},startTransactionOnLocationChange:!0,startTransactionOnPageLoad:!0,enableLongTask:!0,_experiments:{},...nU};class nj{__init(){this.name="BrowserTracing"}constructor(e){nj.prototype.__init.call(this),function(){let e=ed();e.__SENTRY__&&(e.__SENTRY__.extensions=e.__SENTRY__.extensions||{},e.__SENTRY__.extensions.startTransaction||(e.__SENTRY__.extensions.startTransaction=nn),e.__SENTRY__.extensions.traceHeaders||(e.__SENTRY__.extensions.traceHeaders=ne),t7||(t7=!0,e$("error",t8),e$("unhandledrejection",t8)))}(),this.options={...nF,...e},void 0!==this.options._experiments.enableLongTask&&(this.options.enableLongTask=this.options._experiments.enableLongTask),e&&!e.tracePropagationTargets&&e.tracingOrigins&&(this.options.tracePropagationTargets=e.tracingOrigins),this._collectWebVitals=function(){let e=nA();if(e&&Z.Z1){e.mark&&nd.performance.mark("sentry-tracing-init"),nD(e=>{let t=e.entries.pop();if(!t)return;let n=nR(Z.Z1),i=nR(t.startTime);("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&r.log("[Measurements] Adding FID"),nP.fid={value:e.value,unit:"millisecond"},nP["mark.fid"]={value:n+i,unit:"second"}});let t=nb(e=>{let t=e.entries.pop();t&&(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&r.log("[Measurements] Adding CLS"),nP.cls={value:e.value,unit:""},u=t)}),n=nk(e=>{let t=e.entries.pop();t&&(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&r.log("[Measurements] Adding LCP"),nP.lcp={value:e.value,unit:"millisecond"},l=t)});return()=>{t&&t(),n&&n()}}return()=>void 0}(),this.options.enableLongTask&&function(){let e=e=>{for(let t of e){let n=t3();if(!n)return;let r=nR(Z.Z1+t.startTime),i=nR(t.duration);n.startChild({description:"Main UI thread blocked",op:"ui.long-task",startTimestamp:r,endTimestamp:r+i})}};nv("longtask",e)}(),this.options._experiments.enableInteractions&&function(){let e=e=>{for(let t of e){let n=t3();if(!n)return;if("click"===t.name){let r=nR(Z.Z1+t.startTime),i=nR(t.duration);n.startChild({description:P(t.target),op:`ui.interaction.${t.name}`,startTimestamp:r,endTimestamp:r+i})}}};nv("event",e,{durationThreshold:0})}()}setupOnce(e,t){this._getCurrentHub=t;let{routingInstrumentation:n,startTransactionOnLocationChange:i,startTransactionOnPageLoad:s,markBackgroundTransactions:a,traceFetch:o,traceXHR:l,tracePropagationTargets:u,shouldCreateSpanForRequest:c,_experiments:h}=this.options;n(e=>{let n=this._createRouteTransaction(e);return this.options._experiments.onStartRouteTransaction&&this.options._experiments.onStartRouteTransaction(n,e,t),n},s,i),a&&(nd&&nd.document?nd.document.addEventListener("visibilitychange",()=>{let e=t3();if(nd.document.hidden&&e){let t="cancelled";("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&r.log(`[Tracing] Transaction: ${t} -> since tab moved to the background, op: ${e.op}`),e.status||e.setStatus(t),e.setTag("visibilitychange","document.hidden"),e.finish()}}):("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&r.warn("[Tracing] Could not set up background tab detection due to lack of global document")),h.enableInteractions&&this._registerInteractionListener(),function(e){let{traceFetch:t,traceXHR:n,tracePropagationTargets:r,tracingOrigins:i,shouldCreateSpanForRequest:s}={traceFetch:nU.traceFetch,traceXHR:nU.traceXHR,...e},a="function"==typeof s?s:e=>!0,o=e=>U(e,r||i||nM),l={};t&&e$("fetch",e=>{(function(e,t,n,r){if(!ey()||!(e.fetchData&&t(e.fetchData.url)))return;if(e.endTimestamp){let i=e.fetchData.__span;if(!i)return;let s=r[i];s&&(e.response?s.setHttpStatus(e.response.status):e.error&&s.setStatus("internal_error"),s.finish(),delete r[i]);return}let a=e.response&&e.response.headers&&e.response.headers.get("content-length"),o=ep().getScope(),l=o&&o.getSpan(),u=l&&l.transaction;if(l&&u){let{method:c,url:h}=e.fetchData,d=l.startChild({data:{url:h,type:"fetch",...a?{"http.response_content_length":a}:{},"http.method":c},description:`${c} ${h}`,op:"http.client"});e.fetchData.__span=d.spanId,r[d.spanId]=d;let f=e.args[0];e.args[1]=e.args[1]||{};let p=e.args[1];n(e.fetchData.url)&&(p.headers=function(e,t,n,r){let i=nc(t),s=n.toTraceparent(),a="undefined"!=typeof Request&&S(e,Request)?e.headers:r.headers;if(!a)return{"sentry-trace":s,baggage:i};if("undefined"!=typeof Headers&&S(a,Headers)){let o=new Headers(a);return o.append("sentry-trace",s),i&&o.append(na,i),o}if(Array.isArray(a)){let l=[...a,["sentry-trace",s]];return i&&l.push([na,i]),l}{let u="baggage"in a?a.baggage:void 0,c=[];return Array.isArray(u)?c.push(...u):u&&c.push(u),i&&c.push(i),{...a,"sentry-trace":s,baggage:c.length>0?c.join(","):void 0}}}(f,u.getDynamicSamplingContext(),d,p))}})(e,a,o,l)}),n&&e$("xhr",e=>{(function(e,t,n,r){let i=e.xhr,s=i&&i[eF];if(!ey()||i&&i.__sentry_own_request__||!(i&&s&&t(s.url)))return;if(e.endTimestamp){let a=i.__sentry_xhr_span_id__;if(!a)return;let o=r[a];o&&(o.setHttpStatus(s.status_code),o.finish(),delete r[a]);return}let l=ep().getScope(),u=l&&l.getSpan(),c=u&&u.transaction;if(u&&c){let h=u.startChild({data:{...s.data,type:"xhr","http.method":s.method,url:s.url},description:`${s.method} ${s.url}`,op:"http.client"});if(i.__sentry_xhr_span_id__=h.spanId,r[i.__sentry_xhr_span_id__]=h,i.setRequestHeader&&n(s.url))try{i.setRequestHeader("sentry-trace",h.toTraceparent());let d=c.getDynamicSamplingContext(),f=nc(d);f&&i.setRequestHeader(na,f)}catch(p){}}})(e,a,o,l)})}({traceFetch:o,traceXHR:l,tracePropagationTargets:u,shouldCreateSpanForRequest:c})}_createRouteTransaction(e){if(!this._getCurrentHub){("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&r.warn(`[Tracing] Did not create ${e.op} transaction because _getCurrentHub is invalid.`);return}let{beforeNavigate:t,idleTimeout:n,finalTimeout:i,heartbeatInterval:s}=this.options,a="pageload"===e.op,o=a?nB("sentry-trace"):null,c=a?nB("baggage"):null,h=o?ns(o):void 0,d=c?nu(c):void 0,f={...e,...h,metadata:{...e.metadata,dynamicSamplingContext:h&&!d?{}:d},trimEnd:!0},p="function"==typeof t?t(f):f,m=void 0===p?{...f,sampled:!1}:p;m.metadata=m.name!==f.name?{...m.metadata,source:"custom"}:m.metadata,this._latestRouteName=m.name,this._latestRouteSource=m.metadata&&m.metadata.source,!1===m.sampled&&("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&r.log(`[Tracing] Will not send ${m.op} transaction because of beforeNavigate.`),("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&r.log(`[Tracing] Starting ${m.op} transaction on scope`);let g=this._getCurrentHub(),{location:y}=nd,_=nr(g,m,n,i,!0,{location:y},s);return _.registerBeforeFinishCallback(e=>{this._collectWebVitals(),function(e){let t,n;let i=nA();if(!i||!nd.performance.getEntries||!Z.Z1)return;("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&r.log("[Tracing] Adding & adjusting spans using Performance API");let s=nR(Z.Z1),a=i.getEntries();if(a.slice(nO).forEach(i=>{let a=nR(i.startTime),o=nR(i.duration);if("navigation"!==e.op||!(s+a<e.startTimestamp))switch(i.entryType){case"navigation":["unloadEvent","redirect","domContentLoadedEvent","loadEvent","connect"].forEach(t=>{nL(e,i,t,s)}),nL(e,i,"secureConnection",s,"TLS/SSL","connectEnd"),nL(e,i,"fetch",s,"cache","domainLookupStart"),nL(e,i,"domainLookup",s,"DNS"),nN(e,{op:"browser",description:"request",startTimestamp:s+nR(i.requestStart),endTimestamp:s+nR(i.responseEnd)}),nN(e,{op:"browser",description:"response",startTimestamp:s+nR(i.responseStart),endTimestamp:s+nR(i.responseEnd)}),t=s+nR(i.responseStart),n=s+nR(i.requestStart);break;case"mark":case"paint":case"measure":{(function(e,t,n,r,i){let s=i+n;nN(e,{description:t.name,endTimestamp:s+r,op:t.entryType,startTimestamp:s})})(e,i,a,o,s);let l=nT(),u=i.startTime<l.firstHiddenTime;"first-paint"===i.name&&u&&(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&r.log("[Measurements] Adding FP"),nP.fp={value:i.startTime,unit:"millisecond"}),"first-contentful-paint"===i.name&&u&&(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&r.log("[Measurements] Adding FCP"),nP.fcp={value:i.startTime,unit:"millisecond"});break}case"resource":{let c=i.name.replace(nd.location.origin,"");(function(e,t,n,r,i,s){if("xmlhttprequest"===t.initiatorType||"fetch"===t.initiatorType)return;let a={};"transferSize"in t&&(a["http.response_transfer_size"]=t.transferSize),"encodedBodySize"in t&&(a["http.response_content_length"]=t.encodedBodySize),"decodedBodySize"in t&&(a["http.decoded_response_content_length"]=t.decodedBodySize),"renderBlockingStatus"in t&&(a["resource.render_blocking_status"]=t.renderBlockingStatus);let o=s+r;nN(e,{description:n,endTimestamp:o+i,op:t.initiatorType?`resource.${t.initiatorType}`:"resource.other",startTimestamp:o,data:a})})(e,i,c,a,o,s)}}}),nO=Math.max(a.length-1,0),function(e){let t=nd.navigator;if(!t)return;let n=t.connection;n&&(n.effectiveType&&e.setTag("effectiveConnectionType",n.effectiveType),n.type&&e.setTag("connectionType",n.type),nC(n.rtt)&&(nP["connection.rtt"]={value:n.rtt,unit:"millisecond"})),nC(t.deviceMemory)&&e.setTag("deviceMemory",`${t.deviceMemory} GB`),nC(t.hardwareConcurrency)&&e.setTag("hardwareConcurrency",String(t.hardwareConcurrency))}(e),"pageload"===e.op){"number"==typeof t&&(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&r.log("[Measurements] Adding TTFB"),nP.ttfb={value:(t-e.startTimestamp)*1e3,unit:"millisecond"},"number"==typeof n&&n<=t&&(nP["ttfb.requestTime"]={value:(t-n)*1e3,unit:"millisecond"})),["fcp","fp","lcp"].forEach(t=>{if(!nP[t]||s>=e.startTimestamp)return;let n=nP[t].value,i=s+nR(n),a=Math.abs((i-e.startTimestamp)*1e3);("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&r.log(`[Measurements] Normalized ${t} from ${n} to ${a} (${a-n})`),nP[t].value=a});let o=nP["mark.fid"];o&&nP.fid&&(nN(e,{description:"first input delay",endTimestamp:o.value+nR(nP.fid.value),op:"ui.action",startTimestamp:o.value}),delete nP["mark.fid"]),"fcp"in nP||delete nP.cls,Object.keys(nP).forEach(t=>{e.setMeasurement(t,nP[t].value,nP[t].unit)}),l&&(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&r.log("[Measurements] Adding LCP Data"),l.element&&e.setTag("lcp.element",P(l.element)),l.id&&e.setTag("lcp.id",l.id),l.url&&e.setTag("lcp.url",l.url.trim().slice(0,200)),e.setTag("lcp.size",l.size)),u&&u.sources&&(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&r.log("[Measurements] Adding CLS Data"),u.sources.forEach((t,n)=>e.setTag(`cls.source.${n+1}`,P(t.node))))}l=void 0,u=void 0,nP={}}(e)}),_}_registerInteractionListener(){let e;let t=()=>{let{idleTimeout:t,finalTimeout:n,heartbeatInterval:i}=this.options,s="ui.action.click",a=t3();if(a&&a.op&&["navigation","pageload"].includes(a.op)){("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&r.warn(`[Tracing] Did not create ${s} transaction because a pageload or navigation transaction is in progress.`);return}if(e&&(e.setFinishReason("interactionInterrupted"),e.finish(),e=void 0),!this._getCurrentHub){("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&r.warn(`[Tracing] Did not create ${s} transaction because _getCurrentHub is invalid.`);return}if(!this._latestRouteName){("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&r.warn(`[Tracing] Did not create ${s} transaction because _latestRouteName is missing.`);return}let o=this._getCurrentHub(),{location:l}=nd,u={name:this._latestRouteName,op:s,trimEnd:!0,metadata:{source:this._latestRouteSource||"url"}};e=nr(o,u,t,n,!0,{location:l},i)};["click"].forEach(e=>{addEventListener(e,t,{once:!1,capture:!0})})}}function nB(e){var t;let n=(t=`meta[name=${e}]`,O.document&&O.document.querySelector?O.document.querySelector(t):null);return n?n.getAttribute("content"):null}function n$(e,t,n={}){return Array.isArray(t)?nV(e,t,n):function(e,t,n){let r=r=>{let i=t(r);if(e.allowExclusionByUser){let s=i.find(t=>t.name===e.name);if(!s)return i}return nV(e,i,n)};return r}(e,t,n)}function nV(e,t,n){let r=t.find(t=>t.name===e.name);if(r){for(let[i,s]of Object.entries(n))!function e(t,n,r){let i=n.match(/([a-z_]+)\.(.*)/i);if(null===i)t[n]=r;else{let s=t[i[1]];e(s,i[2],r)}}(r,i,s);return t}return[...t,e]}var nG=n(3454),nq=n(1163),nz=n.n(nq);let nK={"routing.instrumentation":"next-router"},nY=ep().getClient();function nH(e,t=!0,n=!0){let{route:i,traceParentData:s,baggage:a,params:o}=function(){let e;let t=to.document.getElementById("__NEXT_DATA__");if(t&&t.innerHTML)try{e=JSON.parse(t.innerHTML)}catch(n){("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&r.warn("Could not extract __NEXT_DATA__")}if(!e)return{};let i={},{page:s,query:a,props:o}=e;return i.route=s,i.params=a,o&&o.pageProps&&(o.pageProps._sentryBaggage&&(i.baggage=o.pageProps._sentryBaggage),o.pageProps._sentryTraceData&&(i.traceParentData=ns(o.pageProps._sentryTraceData))),i}();if(d=i||to.location.pathname,t){let l=nu(a);h=e({name:d,op:"pageload",tags:nK,...o&&nY&&nY.getOptions().sendDefaultPii&&{data:o},...s,metadata:{source:i?"route":"url",dynamicSamplingContext:s&&!l?{}:l}})}n&&nz().events.on("routeChangeStart",t=>{let n,r;let i=function(e){let t=(to.__BUILD_MANIFEST||{}).sortedPages;if(t)return t.find(t=>{let n=function(e){let t=e.split("/"),n="";t[t.length-1].match(/^\[\[\.\.\..+\]\]$/)&&(t.pop(),n="(?:/(.+?))?");let r=t.map(e=>e.replace(/^\[\.\.\..+\]$/,"(.+?)").replace(/^\[.*\]$/,"([^/]+?)")).join("/");return RegExp(`^${r}${n}(?:/)?$`)}(t);return e.match(n)})}(t.split(/[\?#]/,1)[0]);i?(n=i,r="route"):(n=t,r="url");let s={...nK,from:d};d=n,h&&h.finish();let a=e({name:n,op:"navigation",tags:s,metadata:{source:r}});if(a){let o=a.startChild({op:"ui.nextjs.route-change",description:"Next.js Route Change"}),l=()=>{o.finish(),nz().events.off("routeChangeComplete",l)};nz().events.on("routeChangeComplete",l)}})}let nW=n.g,nQ=n.g;var nX=n(3454),nJ=window;nJ.__sentryRewritesTunnelPath__=void 0,nJ.SENTRY_RELEASE={id:"de25f2d8d283f36441a0f84d3de9f15b7cb9b983"},nJ.__rewriteFramesAssetPrefixPath__="";let nZ=nX.env.SENTRY_DSN||nX.env.NEXT_PUBLIC_SENTRY_DSN;!function(e){let t=nW.__sentryRewritesTunnelPath__;if(t&&e.dsn){let n=eX(e.dsn),i=n.host.match(/^o(\d+)\.ingest\.sentry\.io$/);if(i){let s=i[1],a=`${t}?o=${s}&p=${n.projectId}`;e.tunnel=a,("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&r.info(`Tunneling events to "${a}"`)}else("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&r.warn("Provided DSN is not a Sentry SaaS DSN. Will not tunnel events.")}}(D={dsn:nZ||"https://e0acd357e50a43329e05463b2b8180d3@o4504814805450752.ingest.sentry.io/4504814806827008",tracesSampleRate:1}),k=["nextjs","react"],(x=D)._metadata=x._metadata||{},x._metadata.sdk=x._metadata.sdk||{name:"sentry.javascript.nextjs",packages:k.map(e=>({name:`npm:@sentry/${e}`,version:eE})),version:eE},D.environment=D.environment||function(e){let t=e?"production":nG.env.VERCEL_ENV;return t?`vercel-${t}`:void 0}(!0)||"production",function(e){let t=e.integrations||[],n=nQ.__rewriteFramesAssetPrefixPath__||"",r=new eb({iteratee(e){try{let{origin:t}=new URL(e.filename);e.filename=function(e){let t;let n=e[0],r=1;for(;r<e.length;){let i=e[r],s=e[r+1];if(r+=2,("optionalAccess"===i||"optionalCall"===i)&&null==n)return;"access"===i||"optionalAccess"===i?(t=n,n=s(n)):("call"===i||"optionalCall"===i)&&(n=s((...e)=>n.call(t,...e)),t=void 0)}return n}([e,"access",e=>e.filename,"optionalAccess",e=>e.replace,"call",e=>e(t,"app://"),"access",e=>e.replace,"call",e=>e(n,"")])}catch(r){}return e.filename&&e.filename.startsWith("app:///_next")&&(e.filename=decodeURI(e.filename)),e.filename&&e.filename.match(/^app:\/\/\/_next\/static\/chunks\/(main-|main-app-|polyfills-|webpack-|framework-|framework\.)[0-9a-f]+\.js$/)&&(e.in_app=!1),e}});if(t=n$(r,t),("undefined"==typeof __SENTRY_TRACING__||__SENTRY_TRACING__)&&ey(e)){let i=new nj({tracingOrigins:[...nU.tracingOrigins,/^(api\/)/],routingInstrumentation:nH});t=n$(i,t,{"options.routingInstrumentation":nH})}e.integrations=t}(D),(C=D)._metadata=C._metadata||{},C._metadata.sdk=C._metadata.sdk||{name:"sentry.javascript.react",packages:[{name:"npm:@sentry/react",version:eE}],version:eE},function(e={}){var t;void 0===e.defaultIntegrations&&(e.defaultIntegrations=tZ),void 0===e.release&&("string"==typeof __SENTRY_RELEASE__&&(e.release=__SENTRY_RELEASE__),to.SENTRY_RELEASE&&to.SENTRY_RELEASE.id&&(e.release=to.SENTRY_RELEASE.id)),void 0===e.autoSessionTracking&&(e.autoSessionTracking=!0),void 0===e.sendClientReports&&(e.sendClientReports=!0);let n={...e,stackParser:Array.isArray(t=e.stackParser||tY)?eN(...t):t,integrations:function(e){let t;let n=e.defaultIntegrations||[],r=e.integrations;n.forEach(e=>{e.isDefaultInstance=!0}),t=Array.isArray(r)?[...n,...r]:"function"==typeof r?J(r(n)):n;let i=function(e){let t={};return e.forEach(e=>{let{name:n}=e,r=t[n];r&&!r.isDefaultInstance&&e.isDefaultInstance||(t[n]=e)}),Object.keys(t).map(e=>t[e])}(t),s=function(e,t){for(let n=0;n<e.length;n++)if(!0===t(e[n]))return n;return -1}(i,e=>"Debug"===e.name);if(-1!==s){let[a]=i.splice(s,1);i.push(a)}return i}(e),transport:e.transport||(eP()?tX:tJ)};(function(e,t){!0===t.debug&&("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__?r.enable():console.warn("[Sentry] Cannot initialize SDK with `debug` option using a non-debug bundle."));let n=ep(),i=n.getScope();i.update(t.initialScope);let s=new e(t);n.bindClient(s)})(t_,n),e.autoSessionTracking&&function(){if(void 0===to.document){("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&r.warn("Session tracking in non-browser environment with @sentry/browser is not supported.");return}let e=ep();e.captureSession&&(t0(e),e$("history",({from:e,to:t})=>{void 0===e||e===t||t0(ep())}))}()}(C),N=e=>{e.setTag("runtime","browser");let t=e=>"transaction"===e.type&&"/404"===e.transaction?null:e;t.id="NextClient404Filter",e.addEventProcessor(t)},ep().configureScope(N)},7645:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){let n=s.default,i=(null==t?void 0:t.suspense)?{}:{loading(e){let{error:t,isLoading:n,pastDelay:r}=e;return null}};if(e instanceof Promise?i.loader=()=>e:"function"==typeof e?i.loader=e:"object"==typeof e&&(i=r({},i,e)),(i=r({},i,t)).suspense&&(delete i.ssr,delete i.loading),i.loadableGenerated&&delete(i=r({},i,i.loadableGenerated)).loadableGenerated,"boolean"==typeof i.ssr&&!i.suspense){if(!i.ssr)return delete i.ssr,a(n,i);delete i.ssr}return n(i)},t.noSSR=a;var r=n(6495).Z,i=n(2648).Z,s=(i(n(7294)),i(n(4588)));function a(e,t){return delete t.webpack,delete t.modules,e(t)}("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},3644:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LoadableContext=void 0;var r=(0,n(2648).Z)(n(7294));let i=r.default.createContext(null);t.LoadableContext=i},4588:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(6495).Z,i=(0,n(1598).Z)(n(7294)),s=n(3644);let a=[],o=[],l=!1;function u(e){let t=e(),n={loading:!0,loaded:null,error:null};return n.promise=t.then(e=>(n.loading=!1,n.loaded=e,e)).catch(e=>{throw n.loading=!1,n.error=e,e}),n}class c{promise(){return this._res.promise}retry(){this._clearTimeouts(),this._res=this._loadFn(this._opts.loader),this._state={pastDelay:!1,timedOut:!1};let{_res:e,_opts:t}=this;e.loading&&("number"==typeof t.delay&&(0===t.delay?this._state.pastDelay=!0:this._delay=setTimeout(()=>{this._update({pastDelay:!0})},t.delay)),"number"==typeof t.timeout&&(this._timeout=setTimeout(()=>{this._update({timedOut:!0})},t.timeout))),this._res.promise.then(()=>{this._update({}),this._clearTimeouts()}).catch(e=>{this._update({}),this._clearTimeouts()}),this._update({})}_update(e){this._state=r({},this._state,{error:this._res.error,loaded:this._res.loaded,loading:this._res.loading},e),this._callbacks.forEach(e=>e())}_clearTimeouts(){clearTimeout(this._delay),clearTimeout(this._timeout)}getCurrentValue(){return this._state}subscribe(e){return this._callbacks.add(e),()=>{this._callbacks.delete(e)}}constructor(e,t){this._loadFn=e,this._opts=t,this._callbacks=new Set,this._delay=null,this._timeout=null,this.retry()}}function h(e){return function(e,t){let n=Object.assign({loader:null,loading:null,delay:200,timeout:null,webpack:null,modules:null,suspense:!1},t);n.suspense&&(n.lazy=i.default.lazy(n.loader));let a=null;function u(){if(!a){let t=new c(e,n);a={getCurrentValue:t.getCurrentValue.bind(t),subscribe:t.subscribe.bind(t),retry:t.retry.bind(t),promise:t.promise.bind(t)}}return a.promise()}if(!l){let h=n.webpack?n.webpack():n.modules;h&&o.push(e=>{for(let t of h)if(-1!==e.indexOf(t))return u()})}function d(){u();let e=i.default.useContext(s.LoadableContext);e&&Array.isArray(n.modules)&&n.modules.forEach(t=>{e(t)})}let f=n.suspense?function(e,t){return d(),i.default.createElement(n.lazy,r({},e,{ref:t}))}:function(e,t){d();let r=i.useSyncExternalStore(a.subscribe,a.getCurrentValue,a.getCurrentValue);return i.default.useImperativeHandle(t,()=>({retry:a.retry}),[]),i.default.useMemo(()=>{var t;return r.loading||r.error?i.default.createElement(n.loading,{isLoading:r.loading,pastDelay:r.pastDelay,timedOut:r.timedOut,error:r.error,retry:a.retry}):r.loaded?i.default.createElement((t=r.loaded)&&t.__esModule?t.default:t,e):null},[e,r])};return f.preload=()=>u(),f.displayName="LoadableComponent",i.default.forwardRef(f)}(u,e)}function d(e,t){let n=[];for(;e.length;){let r=e.pop();n.push(r(t))}return Promise.all(n).then(()=>{if(e.length)return d(e,t)})}h.preloadAll=()=>new Promise((e,t)=>{d(a).then(e,t)}),h.preloadReady=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return new Promise(t=>{let n=()=>(l=!0,t());d(o,e).then(n,n)})},window.__NEXT_PRELOADREADY=h.preloadReady,t.default=h},5222:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return j}});var r=n(5893),i=n(9008),s=n.n(i),a=n(5152),o=n.n(a),l=n(1163),u=n(7294),c=n(9473),h=n(1367),d={h1:e=>(0,r.jsx)("h1",{className:"text-3xl font-bold mt-8 mb-4",...e}),h2:e=>(0,r.jsx)("h2",{className:"text-2xl font-bold mt-6 mb-3",...e}),h3:e=>(0,r.jsx)("h3",{className:"text-xl font-bold mt-6 mb-2",...e}),h4:e=>(0,r.jsx)("h4",{className:"text-lg font-bold mt-4 mb-2",...e}),h5:e=>(0,r.jsx)("h5",{className:"text-md font-bold mt-3 mb-1",...e}),h6:e=>(0,r.jsx)("h6",{className:"text-sm font-bold mt-2 mb-1",...e}),p:e=>(0,r.jsx)("p",{className:"text-lg leading-7 my-4",...e}),blockquote:e=>(0,r.jsx)("blockquote",{className:"border-l-4 border-gray-500 pl-4 my-4",...e}),pre:e=>(0,r.jsx)("pre",{className:"my-4 overflow-x-auto",children:e.children}),code:e=>(0,r.jsx)("code",{className:"font-mono whitespace-pre-wrap p-1 rounded-md",children:e.children}),inlineCode:e=>(0,r.jsx)("code",{className:"font-mono bg-gray-200 px-1 rounded-sm",children:e.children}),ul:e=>(0,r.jsx)("ul",{className:"list-disc list-inside my-4",...e}),ol:e=>(0,r.jsx)("ol",{className:"list-decimal list-inside my-4",...e}),li:e=>(0,r.jsx)("li",{className:"text-lg leading-7",...e}),img:e=>(0,r.jsx)("img",{className:"my-4",...e}),hr:()=>(0,r.jsx)("hr",{className:"my-8 border-gray-500"}),em:e=>(0,r.jsx)("em",{className:"italic",...e}),br:()=>(0,r.jsx)("br",{}),a:e=>(0,r.jsx)("a",{className:"text-blue-500 hover:text-blue-700 underline",...e})};n(6774);var f=()=>{window.va||(window.va=function(...e){(window.vaq=window.vaq||[]).push(e)})},p=(e={debug:!0})=>{var t;if(!("undefined"!=typeof window))return;let n=function(e="auto"){return"auto"===e?!function(){try{return!1}catch(e){return!1}}()?"production":"development":e}(e.mode);f(),e.beforeSend&&(null==(t=window.va)||t.call(window,"beforeSend",e.beforeSend));let r="development"===n?"https://cdn.vercel-insights.com/v1/script.debug.js":"/_vercel/insights/script.js";if(document.head.querySelector(`script[src*="${r}"]`))return;let i=document.createElement("script");i.src=r,i.defer=!0,i.setAttribute("data-sdkn","@vercel/analytics"),i.setAttribute("data-sdkv","0.1.11"),"development"===n&&!1===e.debug&&i.setAttribute("data-debug","false"),document.head.appendChild(i)};function m({beforeSend:e,debug:t=!0,mode:n="auto"}){return(0,u.useEffect)(()=>{p({beforeSend:e,debug:t,mode:n})},[e,t,n]),null}var g=n(6661),y=n(1151),_=n(1955),v=n(1106),w=n(1338),b=n(6405),E=n(8868);function I(){let e=(0,u.useRef)(!1);return(0,E.L)(()=>(e.current=!0,()=>{e.current=!1}),[]),e}var S=n(240),T=n(6681);class D extends u.Component{getSnapshotBeforeUpdate(e){let t=this.props.childRef.current;if(t&&e.isPresent&&!this.props.isPresent){let n=this.props.sizeRef.current;n.height=t.offsetHeight||0,n.width=t.offsetWidth||0,n.top=t.offsetTop,n.left=t.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function x({children:e,isPresent:t}){let n=(0,u.useId)(),r=(0,u.useRef)(null),i=(0,u.useRef)({width:0,height:0,top:0,left:0});return(0,u.useInsertionEffect)(()=>{let{width:e,height:s,top:a,left:o}=i.current;if(t||!r.current||!e||!s)return;r.current.dataset.motionPopId=n;let l=document.createElement("style");return document.head.appendChild(l),l.sheet&&l.sheet.insertRule(`
          [data-motion-pop-id="${n}"] {
            position: absolute !important;
            width: ${e}px !important;
            height: ${s}px !important;
            top: ${a}px !important;
            left: ${o}px !important;
          }
        `),()=>{document.head.removeChild(l)}},[t]),u.createElement(D,{isPresent:t,childRef:r,sizeRef:i},u.cloneElement(e,{ref:r}))}let k=({children:e,initial:t,isPresent:n,onExitComplete:r,custom:i,presenceAffectsLayout:s,mode:a})=>{let o=(0,T.h)(C),l=(0,u.useId)(),c=(0,u.useMemo)(()=>({id:l,initial:t,isPresent:n,custom:i,onExitComplete(e){for(let t of(o.set(e,!0),o.values()))if(!t)return;r&&r()},register:e=>(o.set(e,!1),()=>o.delete(e))}),s?void 0:[n]);return(0,u.useMemo)(()=>{o.forEach((e,t)=>o.set(t,!1))},[n]),u.useEffect(()=>{n||o.size||!r||r()},[n]),"popLayout"===a&&(e=u.createElement(x,{isPresent:n},e)),u.createElement(S.O.Provider,{value:c},e)};function C(){return new Map}var N=n(5364),R=n(5487);let A=e=>e.key||"",O=({children:e,custom:t,initial:n=!0,onExitComplete:r,exitBeforeEnter:i,presenceAffectsLayout:s=!0,mode:a="sync"})=>{var o;(0,R.k)(!i,"Replace exitBeforeEnter with mode='wait'");let l=(0,u.useContext)(N.p).forceRender||function(){let e=I(),[t,n]=(0,u.useState)(0),r=(0,u.useCallback)(()=>{e.current&&n(t+1)},[t]),i=(0,u.useCallback)(()=>b.Wi.postRender(r),[r]);return[i,t]}()[0],c=I(),h=function(e){let t=[];return u.Children.forEach(e,e=>{(0,u.isValidElement)(e)&&t.push(e)}),t}(e),d=h,f=(0,u.useRef)(new Map).current,p=(0,u.useRef)(d),m=(0,u.useRef)(new Map).current,g=(0,u.useRef)(!0);if((0,E.L)(()=>{g.current=!1,function(e,t){e.forEach(e=>{let n=A(e);t.set(n,e)})}(h,m),p.current=d}),o=()=>{g.current=!0,m.clear(),f.clear()},(0,u.useEffect)(()=>()=>o(),[]),g.current)return u.createElement(u.Fragment,null,d.map(e=>u.createElement(k,{key:A(e),isPresent:!0,initial:!!n&&void 0,presenceAffectsLayout:s,mode:a},e)));d=[...d];let y=p.current.map(A),_=h.map(A),v=y.length;for(let w=0;w<v;w++){let S=y[w];-1!==_.indexOf(S)||f.has(S)||f.set(S,void 0)}return"wait"===a&&f.size&&(d=[]),f.forEach((e,n)=>{if(-1!==_.indexOf(n))return;let i=m.get(n);if(!i)return;let o=y.indexOf(n),g=e;if(!g){let v=()=>{m.delete(n),f.delete(n);let e=p.current.findIndex(e=>e.key===n);if(p.current.splice(e,1),!f.size){if(p.current=h,!1===c.current)return;l(),r&&r()}};g=u.createElement(k,{key:A(i),isPresent:!1,onExitComplete:v,custom:t,presenceAffectsLayout:s,mode:a},i),f.set(n,g)}d.splice(o,0,g)}),d=d.map(e=>{let t=e.key;return f.has(t)?e:u.createElement(k,{key:A(e),isPresent:!0,presenceAffectsLayout:s,mode:a},e)}),u.createElement(u.Fragment,null,f.size?d:d.map(e=>(0,u.cloneElement)(e)))},P=o()(()=>Promise.all([n.e(1664),n.e(5675),n.e(4185)]).then(n.bind(n,4185)),{loadableGenerated:{webpack:()=>[4185]}}),L=o()(()=>Promise.all([n.e(1664),n.e(723)]).then(n.bind(n,723)),{loadableGenerated:{webpack:()=>[723]}}),M=o()(()=>n.e(8840).then(n.bind(n,8840)),{loadableGenerated:{webpack:()=>[8840]}}),U=o()(()=>Promise.all([n.e(4334),n.e(792)]).then(n.bind(n,792)),{loadableGenerated:{webpack:()=>[792]}}),F=o()(()=>Promise.all([n.e(1664),n.e(3802)]).then(n.bind(n,3802)),{loadableGenerated:{webpack:()=>[3802]}});var j=function(e){let{Component:t,pageProps:n}=e,[i,a]=(0,u.useState)(!1),o=(0,l.useRouter)(),f=()=>{a(!0)},p=()=>{a(!1)},b=()=>{a(!1)};l.Router.events.on("routeChangeStart",f),l.Router.events.on("routeChangeComplete",p),l.Router.events.on("routeChangeError",b);let[E,I]=(0,u.useState)(()=>"true"!==_.Z.get("userAcceptCookies"));(0,u.useEffect)(()=>{g.fv.configure("912af067-0d51-43d0-9528-547980442ca5")},[]);let S=()=>{I(!1),_.Z.set("userAcceptCookies","true",{expires:365,path:"/",sameSite:"strict"})};(0,u.useEffect)(()=>{{let e=localStorage.getItem("userId");if("/prompt-guide"===o.pathname||"/legal/privacy-policy"===o.pathname||"/legal/terms-of-service"===o.pathname||"/FAQ"===o.pathname){let t=o.pathname.split("/").pop(),n=t.replace(/-/g," ").toLowerCase().replace(/(^|\s)\S/g,e=>e.toUpperCase()).replace(/ /g,"");(0,v.l)("".concat(n,"PageViewed"),localStorage.getItem("userId")||e||_.Z.get("guestId"))}else{let r=o.pathname.split("/").pop();if(""===r)(0,v.l)("HomePageViewed",localStorage.getItem("userId")||e||_.Z.get("guestId"));else{let i=r.charAt(0).toUpperCase()+r.slice(1);(0,v.l)("".concat(i,"PageViewed"),localStorage.getItem("userId")||e||_.Z.get("guestId"))}}}},[o.pathname]);let[T,D]=(0,u.useState)([]);(0,u.useEffect)(()=>{(0,w.sd)().then(e=>{let t=(null==e?void 0:e.map(e=>e.id))||[];for(let n=t.length-1;n>=0;n--){let r=t[n];"true"===localStorage.getItem("message-".concat(r,"-seen"))&&t.splice(n,1)}let i=e.filter(e=>t.includes(e.id));D(i)})},[]);let x=e=>{D(t=>t.filter(t=>t.id!==e.id))};return(0,r.jsxs)(c.zt,{store:h.h,children:[(0,r.jsx)(s(),{children:(0,r.jsx)("title",{children:"Pattern AI"})}),(0,r.jsx)("div",{className:"bg-secondary min-h-screen overflow-hidden",children:i?(0,r.jsx)("div",{className:"w-full h-screen flex items-center justify-center",children:(0,r.jsx)(M,{})}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(O,{children:(null==T?void 0:T.length)&&(null==T?void 0:T.map(e=>(0,r.jsx)(U,{message:e,onClose:()=>x(e)},e.id)))}),(0,r.jsx)(P,{}),(0,r.jsxs)("main",{className:"".concat("/prompt-guide"===o.pathname||"/legal/privacy-policy"===o.pathname||"/legal/terms-of-service"===o.pathname||"/FAQ"===o.pathname?"prose mx-auto max-w-3xl pt-10 py-20":"w-full"),children:[(0,r.jsx)(y.Zo,{components:d,children:(0,r.jsx)(t,{...n})}),(0,r.jsx)(m,{})]}),(0,r.jsx)(L,{}),E&&(0,r.jsx)(F,{handleAcceptAllCookies:S})]})})]})}},1367:function(e,t,n){"use strict";n.d(t,{h:function(){return o}});var r=n(6741),i=n(9709),s=n(6998),a=n(7217);let o=(0,r.xC)({reducer:{user:i.ZP,data:s.ZP,dashboard:a.ZP}})},7217:function(e,t,n){"use strict";n.d(t,{De:function(){return u},HJ:function(){return m},Kk:function(){return v},Tg:function(){return c},WA:function(){return b},XI:function(){return w},ZB:function(){return g},Zv:function(){return a},bw:function(){return s},e6:function(){return h},ee:function(){return l},gv:function(){return f},k6:function(){return o},lg:function(){return _},nC:function(){return y},s6:function(){return p},xE:function(){return d}});var r=n(6741);let i=(0,r.oM)({name:"dashboard",initialState:{showGeneratedImages:!1,showLoadingCards:!1,dataLoading:!1,allData:[],allDataLength:0,numberOfImages:2,apiError:"",showErrorPage:!1,showPrevImgs:!1,showFavImgs:!1,showNewImgs:!0,selectedSize:"512x512",guidanceScale:7,showApiErrorPopup:!1,apiErrorMessage:"",showLeavePopup:!1,showCreatorReview:!1},reducers:{setShowGeneratedImages(e,t){e.showGeneratedImages=t.payload},setShowLoadingCards(e,t){e.showLoadingCards=t.payload},setAllData(e,t){e.allData=t.payload},setAllDataLength(e,t){e.allDataLength=t.payload},setNumberOfImages(e,t){e.numberOfImages=t.payload},setApiError(e,t){e.apiError=t.payload},setShowErrorPage(e,t){e.showErrorPage=t.payload},setDataLoading(e,t){e.dataLoading=t.payload},setShowPrevImgs(e,t){e.showPrevImgs=t.payload},setShowFavImgs(e,t){e.showFavImgs=t.payload},setShowNewImgs(e,t){e.showNewImgs=t.payload},setSelectedSize(e,t){e.selectedSize=t.payload},setGuidanceScale(e,t){e.guidanceScale=t.payload},setShowApiErrorPopup(e,t){e.showApiErrorPopup=t.payload},setApiErrorMessage(e,t){e.apiErrorMessage=t.payload},setShowLeavePopup(e,t){e.showLeavePopup=t.payload},setShowCreatorReview(e,t){e.showCreatorReview=t.payload}}}),{setShowGeneratedImages:s,setShowLoadingCards:a,setAllData:o,setAllDataLength:l,setNumberOfImages:u,setApiError:c,setShowErrorPage:h,setDataLoading:d,setShowPrevImgs:f,setShowFavImgs:p,setShowNewImgs:m,setSelectedSize:g,setGuidanceScale:y,setShowApiErrorPopup:_,setApiErrorMessage:v,setShowLeavePopup:w,setShowCreatorReview:b}=i.actions;t.ZP=i.reducer},6998:function(e,t,n){"use strict";n.d(t,{wc:function(){return s}});var r=n(6741);let i=(0,r.oM)({name:"data",initialState:{galleryImages:[]},reducers:{setGalleryImages(e,t){e.galleryImages.length?e.galleryImages.push(...t.payload):e.galleryImages=t.payload}}}),{setGalleryImages:s}=i.actions;t.ZP=i.reducer},9709:function(e,t,n){"use strict";n.d(t,{Wx:function(){return s},av:function(){return a},pZ:function(){return o}});var r=n(6741);let i=(0,r.oM)({name:"user",initialState:{userLoggedIn:!1,user:null,showLoginModal:!1},reducers:{setUserLoggedIn(e,t){e.userLoggedIn=t.payload},setUser(e,t){e.user=t.payload},setShowLoginModal(e,t){e.showLoginModal=t.payload}}}),{setUserLoggedIn:s,setUser:a,setShowLoginModal:o}=i.actions;t.ZP=i.reducer},6774:function(){},7663:function(e){!function(){var t={229:function(e){var t,n,r,i=e.exports={};function s(){throw Error("setTimeout has not been defined")}function a(){throw Error("clearTimeout has not been defined")}function o(e){if(t===setTimeout)return setTimeout(e,0);if((t===s||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(r){try{return t.call(null,e,0)}catch(n){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:s}catch(e){t=s}try{n="function"==typeof clearTimeout?clearTimeout:a}catch(r){n=a}}();var l=[],u=!1,c=-1;function h(){u&&r&&(u=!1,r.length?l=r.concat(l):c=-1,l.length&&d())}function d(){if(!u){var e=o(h);u=!0;for(var t=l.length;t;){for(r=l,l=[];++c<t;)r&&r[c].run();c=-1,t=l.length}r=null,u=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===a||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{n(e)}catch(r){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(e)}}function f(e,t){this.fun=e,this.array=t}function p(){}i.nextTick=function(e){var t=Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];l.push(new f(e,t)),1!==l.length||u||o(d)},f.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=p,i.addListener=p,i.once=p,i.off=p,i.removeListener=p,i.removeAllListeners=p,i.emit=p,i.prependListener=p,i.prependOnceListener=p,i.listeners=function(e){return[]},i.binding=function(e){throw Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw Error("process.chdir is not supported")},i.umask=function(){return 0}}},n={};function r(e){var i=n[e];if(void 0!==i)return i.exports;var s=n[e]={exports:{}},a=!0;try{t[e](s,s.exports,r),a=!1}finally{a&&delete n[e]}return s.exports}r.ab="//";var i=r(229);e.exports=i}()},5152:function(e,t,n){e.exports=n(7645)},9008:function(e,t,n){e.exports=n(3121)},1163:function(e,t,n){e.exports=n(880)},9921:function(e,t){"use strict";/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */ var n="function"==typeof Symbol&&Symbol.for,r=n?Symbol.for("react.element"):60103,i=n?Symbol.for("react.portal"):60106,s=n?Symbol.for("react.fragment"):60107,a=n?Symbol.for("react.strict_mode"):60108,o=n?Symbol.for("react.profiler"):60114,l=n?Symbol.for("react.provider"):60109,u=n?Symbol.for("react.context"):60110,c=n?Symbol.for("react.async_mode"):60111,h=n?Symbol.for("react.concurrent_mode"):60111,d=n?Symbol.for("react.forward_ref"):60112,f=n?Symbol.for("react.suspense"):60113,p=n?Symbol.for("react.suspense_list"):60120,m=n?Symbol.for("react.memo"):60115,g=n?Symbol.for("react.lazy"):60116,y=n?Symbol.for("react.block"):60121,_=n?Symbol.for("react.fundamental"):60117,v=n?Symbol.for("react.responder"):60118,w=n?Symbol.for("react.scope"):60119;function b(e){if("object"==typeof e&&null!==e){var t=e.$$typeof;switch(t){case r:switch(e=e.type){case c:case h:case s:case o:case a:case f:return e;default:switch(e=e&&e.$$typeof){case u:case d:case g:case m:case l:return e;default:return t}}case i:return t}}}function E(e){return b(e)===h}t.AsyncMode=c,t.ConcurrentMode=h,t.ContextConsumer=u,t.ContextProvider=l,t.Element=r,t.ForwardRef=d,t.Fragment=s,t.Lazy=g,t.Memo=m,t.Portal=i,t.Profiler=o,t.StrictMode=a,t.Suspense=f,t.isAsyncMode=function(e){return E(e)||b(e)===c},t.isConcurrentMode=E,t.isContextConsumer=function(e){return b(e)===u},t.isContextProvider=function(e){return b(e)===l},t.isElement=function(e){return"object"==typeof e&&null!==e&&e.$$typeof===r},t.isForwardRef=function(e){return b(e)===d},t.isFragment=function(e){return b(e)===s},t.isLazy=function(e){return b(e)===g},t.isMemo=function(e){return b(e)===m},t.isPortal=function(e){return b(e)===i},t.isProfiler=function(e){return b(e)===o},t.isStrictMode=function(e){return b(e)===a},t.isSuspense=function(e){return b(e)===f},t.isValidElementType=function(e){return"string"==typeof e||"function"==typeof e||e===s||e===h||e===o||e===a||e===f||e===p||"object"==typeof e&&null!==e&&(e.$$typeof===g||e.$$typeof===m||e.$$typeof===l||e.$$typeof===u||e.$$typeof===d||e.$$typeof===_||e.$$typeof===v||e.$$typeof===w||e.$$typeof===y)},t.typeOf=b},9864:function(e,t,n){"use strict";e.exports=n(9921)},9473:function(e,t,n){"use strict";n.d(t,{zt:function(){return _},I0:function(){return b},v9:function(){return p}});var r=n(1688),i=n(2798),s=n(3935);let a=function(e){e()},o=()=>a;var l=n(7294);let u=(0,l.createContext)(null);function c(){let e=(0,l.useContext)(u);return e}let h=()=>{throw Error("uSES not initialized!")},d=h,f=(e,t)=>e===t,p=function(e=u){let t=e===u?c:()=>(0,l.useContext)(e);return function(e,n=f){let{store:r,subscription:i,getServerState:s}=t(),a=d(i.addNestedSub,r.getState,s||r.getState,e,n);return(0,l.useDebugValue)(a),a}}();n(8679),n(2973);let m={notify(){},get:()=>[]},g=!!("undefined"!=typeof window&&void 0!==window.document&&void 0!==window.document.createElement),y=g?l.useLayoutEffect:l.useEffect;var _=function({store:e,context:t,children:n,serverState:r}){let i=(0,l.useMemo)(()=>{let t=function(e,t){let n;let r=m;function i(){a.onStateChange&&a.onStateChange()}function s(){n||(n=t?t.addNestedSub(i):e.subscribe(i),r=function(){let e=o(),t=null,n=null;return{clear(){t=null,n=null},notify(){e(()=>{let e=t;for(;e;)e.callback(),e=e.next})},get(){let e=[],n=t;for(;n;)e.push(n),n=n.next;return e},subscribe(e){let r=!0,i=n={callback:e,next:null,prev:n};return i.prev?i.prev.next=i:t=i,function(){r&&null!==t&&(r=!1,i.next?i.next.prev=i.prev:n=i.prev,i.prev?i.prev.next=i.next:t=i.next)}}}}())}let a={addNestedSub:function(e){return s(),r.subscribe(e)},notifyNestedSubs:function(){r.notify()},handleChangeWrapper:i,isSubscribed:function(){return Boolean(n)},trySubscribe:s,tryUnsubscribe:function(){n&&(n(),n=void 0,r.clear(),r=m)},getListeners:()=>r};return a}(e);return{store:e,subscription:t,getServerState:r?()=>r:void 0}},[e,r]),s=(0,l.useMemo)(()=>e.getState(),[e]);return y(()=>{let{subscription:t}=i;return t.onStateChange=t.notifyNestedSubs,t.trySubscribe(),s!==e.getState()&&t.notifyNestedSubs(),()=>{t.tryUnsubscribe(),t.onStateChange=void 0}},[i,s]),l.createElement((t||u).Provider,{value:i},n)};function v(e=u){let t=e===u?c:()=>(0,l.useContext)(e);return function(){let{store:e}=t();return e}}let w=v(),b=function(e=u){let t=e===u?w:v(e);return function(){let e=t();return e.dispatch}}();d=i.useSyncExternalStoreWithSelector,r.useSyncExternalStore,a=s.unstable_batchedUpdates},8359:function(e,t){"use strict";Symbol.for("react.element"),Symbol.for("react.portal"),Symbol.for("react.fragment"),Symbol.for("react.strict_mode"),Symbol.for("react.profiler"),Symbol.for("react.provider"),Symbol.for("react.context"),Symbol.for("react.server_context"),Symbol.for("react.forward_ref"),Symbol.for("react.suspense"),Symbol.for("react.suspense_list"),Symbol.for("react.memo"),Symbol.for("react.lazy"),Symbol.for("react.offscreen"),Symbol.for("react.module.reference")},2973:function(e,t,n){"use strict";n(8359)},3250:function(e,t,n){"use strict";/**
 * @license React
 * use-sync-external-store-shim.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */ var r=n(7294),i="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},s=r.useState,a=r.useEffect,o=r.useLayoutEffect,l=r.useDebugValue;function u(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!i(e,n)}catch(r){return!0}}var c="undefined"==typeof window||void 0===window.document||void 0===window.document.createElement?function(e,t){return t()}:function(e,t){var n=t(),r=s({inst:{value:n,getSnapshot:t}}),i=r[0].inst,c=r[1];return o(function(){i.value=n,i.getSnapshot=t,u(i)&&c({inst:i})},[e,n,t]),a(function(){return u(i)&&c({inst:i}),e(function(){u(i)&&c({inst:i})})},[e]),l(n),n};t.useSyncExternalStore=void 0!==r.useSyncExternalStore?r.useSyncExternalStore:c},6742:function(e,t,n){"use strict";/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */ var r=n(7294),i=n(1688),s="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},a=i.useSyncExternalStore,o=r.useRef,l=r.useEffect,u=r.useMemo,c=r.useDebugValue;t.useSyncExternalStoreWithSelector=function(e,t,n,r,i){var h=o(null);if(null===h.current){var d={hasValue:!1,value:null};h.current=d}else d=h.current;h=u(function(){function e(e){if(!l){if(l=!0,a=e,e=r(e),void 0!==i&&d.hasValue){var t=d.value;if(i(t,e))return o=t}return o=e}if(t=o,s(a,e))return t;var n=r(e);return void 0!==i&&i(t,n)?t:(a=e,o=n)}var a,o,l=!1,u=void 0===n?null:n;return[function(){return e(t())},null===u?void 0:function(){return e(u())}]},[t,n,r,i]);var f=a(e,h[0],h[1]);return l(function(){d.hasValue=!0,d.value=f},[f]),c(f),f}},1688:function(e,t,n){"use strict";e.exports=n(3250)},2798:function(e,t,n){"use strict";e.exports=n(6742)},7456:function(e,t,n){"use strict";let r,i;n.d(t,{Jn:function(){return P},qX:function(){return R},Xd:function(){return N},Mq:function(){return M},C6:function(){return U},ZF:function(){return L},KN:function(){return F}});var s,a=n(8463),o=n(3333),l=n(4444);let u=(e,t)=>t.some(t=>e instanceof t),c=new WeakMap,h=new WeakMap,d=new WeakMap,f=new WeakMap,p=new WeakMap,m={get(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return h.get(e);if("objectStoreNames"===t)return e.objectStoreNames||d.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return g(e[t])},set:(e,t,n)=>(e[t]=n,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function g(e){var t;if(e instanceof IDBRequest)return function(e){let t=new Promise((t,n)=>{let r=()=>{e.removeEventListener("success",i),e.removeEventListener("error",s)},i=()=>{t(g(e.result)),r()},s=()=>{n(e.error),r()};e.addEventListener("success",i),e.addEventListener("error",s)});return t.then(t=>{t instanceof IDBCursor&&c.set(t,e)}).catch(()=>{}),p.set(t,e),t}(e);if(f.has(e))return f.get(e);let n="function"==typeof(t=e)?t!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(i||(i=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(t)?function(...e){return t.apply(y(this),e),g(c.get(this))}:function(...e){return g(t.apply(y(this),e))}:function(e,...n){let r=t.call(y(this),e,...n);return d.set(r,e.sort?e.sort():[e]),g(r)}:(t instanceof IDBTransaction&&function(e){if(h.has(e))return;let t=new Promise((t,n)=>{let r=()=>{e.removeEventListener("complete",i),e.removeEventListener("error",s),e.removeEventListener("abort",s)},i=()=>{t(),r()},s=()=>{n(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",i),e.addEventListener("error",s),e.addEventListener("abort",s)});h.set(e,t)}(t),u(t,r||(r=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])))?new Proxy(t,m):t;return n!==e&&(f.set(e,n),p.set(n,e)),n}let y=e=>p.get(e),_=["get","getKey","getAll","getAllKeys","count"],v=["put","add","delete","clear"],w=new Map;function b(e,t){if(!(e instanceof IDBDatabase&&!(t in e)&&"string"==typeof t))return;if(w.get(t))return w.get(t);let n=t.replace(/FromIndex$/,""),r=t!==n,i=v.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(i||_.includes(n)))return;let s=async function(e,...t){let s=this.transaction(e,i?"readwrite":"readonly"),a=s.store;return r&&(a=a.index(t.shift())),(await Promise.all([a[n](...t),i&&s.done]))[0]};return w.set(t,s),s}m={...s=m,get:(e,t,n)=>b(e,t)||s.get(e,t,n),has:(e,t)=>!!b(e,t)||s.has(e,t)};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ class E{constructor(e){this.container=e}getPlatformInfoString(){let e=this.container.getProviders();return e.map(e=>{if(!function(e){let t=e.getComponent();return(null==t?void 0:t.type)==="VERSION"}(e))return null;{let t=e.getImmediate();return`${t.library}/${t.version}`}}).filter(e=>e).join(" ")}}let I="@firebase/app",S="0.9.9",T=new o.Yd("@firebase/app"),D="[DEFAULT]",x={[I]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","fire-js":"fire-js",firebase:"fire-js-all"},k=new Map,C=new Map;function N(e){let t=e.name;if(C.has(t))return T.debug(`There were multiple attempts to register component ${t}.`),!1;for(let n of(C.set(t,e),k.values()))!function(e,t){try{e.container.addComponent(t)}catch(n){T.debug(`Component ${t.name} failed to register with FirebaseApp ${e.name}`,n)}}(n,e);return!0}function R(e,t){let n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}let A=new l.LL("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."});/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ class O{constructor(e,t,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new a.wA("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw A.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ let P="9.21.0";function L(e,t={}){let n=e;if("object"!=typeof t){let r=t;t={name:r}}let i=Object.assign({name:D,automaticDataCollectionEnabled:!1},t),s=i.name;if("string"!=typeof s||!s)throw A.create("bad-app-name",{appName:String(s)});if(n||(n=(0,l.aH)()),!n)throw A.create("no-options");let o=k.get(s);if(o){if((0,l.vZ)(n,o.options)&&(0,l.vZ)(i,o.config))return o;throw A.create("duplicate-app",{appName:s})}let u=new a.H0(s);for(let c of C.values())u.addComponent(c);let h=new O(n,i,u);return k.set(s,h),h}function M(e=D){let t=k.get(e);if(!t&&e===D)return L();if(!t)throw A.create("no-app",{appName:e});return t}function U(){return Array.from(k.values())}function F(e,t,n){var r;let i=null!==(r=x[e])&&void 0!==r?r:e;n&&(i+=`-${n}`);let s=i.match(/\s|\//),o=t.match(/\s|\//);if(s||o){let l=[`Unable to register library "${i}" with version "${t}":`];s&&l.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&o&&l.push("and"),o&&l.push(`version name "${t}" contains illegal characters (whitespace or "/")`),T.warn(l.join(" "));return}N(new a.wA(`${i}-version`,()=>({library:i,version:t}),"VERSION"))}let j="firebase-heartbeat-store",B=null;function $(){return B||(B=(function(e,t,{blocked:n,upgrade:r,blocking:i,terminated:s}={}){let a=indexedDB.open(e,1),o=g(a);return r&&a.addEventListener("upgradeneeded",e=>{r(g(a.result),e.oldVersion,e.newVersion,g(a.transaction),e)}),n&&a.addEventListener("blocked",e=>n(e.oldVersion,e.newVersion,e)),o.then(e=>{s&&e.addEventListener("close",()=>s()),i&&e.addEventListener("versionchange",e=>i(e.oldVersion,e.newVersion,e))}).catch(()=>{}),o})("firebase-heartbeat-database",0,{upgrade(e,t){0===t&&e.createObjectStore(j)}}).catch(e=>{throw A.create("idb-open",{originalErrorMessage:e.message})})),B}async function V(e){try{let t=await $();return t.transaction(j).objectStore(j).get(q(e))}catch(r){if(r instanceof l.ZR)T.warn(r.message);else{let n=A.create("idb-get",{originalErrorMessage:null==r?void 0:r.message});T.warn(n.message)}}}async function G(e,t){try{let n=await $(),r=n.transaction(j,"readwrite"),i=r.objectStore(j);return await i.put(t,q(e)),r.done}catch(a){if(a instanceof l.ZR)T.warn(a.message);else{let s=A.create("idb-set",{originalErrorMessage:null==a?void 0:a.message});T.warn(s.message)}}}function q(e){return`${e.name}!${e.options.appId}`}class z{constructor(e){this.container=e,this._heartbeatsCache=null;let t=this.container.getProvider("app").getImmediate();this._storage=new Y(t),this._heartbeatsCachePromise=this._storage.read().then(e=>(this._heartbeatsCache=e,e))}async triggerHeartbeat(){let e=this.container.getProvider("platform-logger").getImmediate(),t=e.getPlatformInfoString(),n=K();return(null===this._heartbeatsCache&&(this._heartbeatsCache=await this._heartbeatsCachePromise),this._heartbeatsCache.lastSentHeartbeatDate===n||this._heartbeatsCache.heartbeats.some(e=>e.date===n))?void 0:(this._heartbeatsCache.heartbeats.push({date:n,agent:t}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(e=>{let t=new Date(e.date).valueOf(),n=Date.now();return n-t<=2592e6}),this._storage.overwrite(this._heartbeatsCache))}async getHeartbeatsHeader(){if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,null===this._heartbeatsCache||0===this._heartbeatsCache.heartbeats.length)return"";let e=K(),{heartbeatsToSend:t,unsentEntries:n}=function(e,t=1024){let n=[],r=e.slice();for(let i of e){let s=n.find(e=>e.agent===i.agent);if(s){if(s.dates.push(i.date),H(n)>t){s.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),H(n)>t){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}(this._heartbeatsCache.heartbeats),r=(0,l.L)(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,n.length>0?(this._heartbeatsCache.heartbeats=n,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),r}}function K(){let e=new Date;return e.toISOString().substring(0,10)}class Y{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!(0,l.hl)()&&(0,l.eu)().then(()=>!0).catch(()=>!1)}async read(){let e=await this._canUseIndexedDBPromise;if(!e)return{heartbeats:[]};{let t=await V(this.app);return t||{heartbeats:[]}}}async overwrite(e){var t;let n=await this._canUseIndexedDBPromise;if(n){let r=await this.read();return G(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}}async add(e){var t;let n=await this._canUseIndexedDBPromise;if(n){let r=await this.read();return G(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}}}function H(e){return(0,l.L)(JSON.stringify({version:2,heartbeats:e})).length}N(new a.wA("platform-logger",e=>new E(e),"PRIVATE")),N(new a.wA("heartbeat",e=>new z(e),"PRIVATE")),F(I,S,""),F(I,S,"esm2017"),F("fire-js","")},8463:function(e,t,n){"use strict";n.d(t,{H0:function(){return o},wA:function(){return i}});var r=n(4444);class i{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ let s="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ class a{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){let t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){let n=new r.BH;if(this.instancesDeferred.set(t,n),this.isInitialized(t)||this.shouldAutoInitialize())try{let i=this.getOrInitializeService({instanceIdentifier:t});i&&n.resolve(i)}catch(s){}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;let n=this.normalizeInstanceIdentifier(null==e?void 0:e.identifier),r=null!==(t=null==e?void 0:e.optional)&&void 0!==t&&t;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(i){if(r)return null;throw i}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,this.shouldAutoInitialize()){if("EAGER"===e.instantiationMode)try{this.getOrInitializeService({instanceIdentifier:s})}catch(t){}for(let[n,r]of this.instancesDeferred.entries()){let i=this.normalizeInstanceIdentifier(n);try{let a=this.getOrInitializeService({instanceIdentifier:i});r.resolve(a)}catch(o){}}}}clearInstance(e=s){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){let e=Array.from(this.instances.values());await Promise.all([...e.filter(e=>"INTERNAL"in e).map(e=>e.INTERNAL.delete()),...e.filter(e=>"_delete"in e).map(e=>e._delete())])}isComponentSet(){return null!=this.component}isInitialized(e=s){return this.instances.has(e)}getOptions(e=s){return this.instancesOptions.get(e)||{}}initialize(e={}){let{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);let r=this.getOrInitializeService({instanceIdentifier:n,options:t});for(let[i,s]of this.instancesDeferred.entries()){let a=this.normalizeInstanceIdentifier(i);n===a&&s.resolve(r)}return r}onInit(e,t){var n;let r=this.normalizeInstanceIdentifier(t),i=null!==(n=this.onInitCallbacks.get(r))&&void 0!==n?n:new Set;i.add(e),this.onInitCallbacks.set(r,i);let s=this.instances.get(r);return s&&e(s,r),()=>{i.delete(e)}}invokeOnInitCallbacks(e,t){let n=this.onInitCallbacks.get(t);if(n)for(let r of n)try{r(e,t)}catch(i){}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:e===s?void 0:e,options:t}),this.instances.set(e,n),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch(r){}return n||null}normalizeInstanceIdentifier(e=s){return this.component?this.component.multipleInstances?e:s:e}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ class o{constructor(e){this.name=e,this.providers=new Map}addComponent(e){let t=this.getProvider(e.name);if(t.isComponentSet())throw Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){let t=this.getProvider(e.name);t.isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);let t=new a(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}},3333:function(e,t,n){"use strict";var r,i;n.d(t,{Yd:function(){return c},in:function(){return r}});/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ let s=[];(i=r||(r={}))[i.DEBUG=0]="DEBUG",i[i.VERBOSE=1]="VERBOSE",i[i.INFO=2]="INFO",i[i.WARN=3]="WARN",i[i.ERROR=4]="ERROR",i[i.SILENT=5]="SILENT";let a={debug:r.DEBUG,verbose:r.VERBOSE,info:r.INFO,warn:r.WARN,error:r.ERROR,silent:r.SILENT},o=r.INFO,l={[r.DEBUG]:"log",[r.VERBOSE]:"log",[r.INFO]:"info",[r.WARN]:"warn",[r.ERROR]:"error"},u=(e,t,...n)=>{if(t<e.logLevel)return;let r=new Date().toISOString(),i=l[t];if(i)console[i](`[${r}]  ${e.name}:`,...n);else throw Error(`Attempted to log a message with an invalid logType (value: ${t})`)};class c{constructor(e){this.name=e,this._logLevel=o,this._logHandler=u,this._userLogHandler=null,s.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in r))throw TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel="string"==typeof e?a[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!=typeof e)throw TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,r.DEBUG,...e),this._logHandler(this,r.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,r.VERBOSE,...e),this._logHandler(this,r.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,r.INFO,...e),this._logHandler(this,r.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,r.WARN,...e),this._logHandler(this,r.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,r.ERROR,...e),this._logHandler(this,r.ERROR,...e)}}},1151:function(e,t,n){"use strict";n.d(t,{Zo:function(){return o},ah:function(){return s}});var r=n(7294);let i=r.createContext({});function s(e){let t=r.useContext(i);return r.useMemo(()=>"function"==typeof e?e(t):{...t,...e},[t,e])}let a={};function o({components:e,children:t,disableParentContext:n}){let o;return o=n?"function"==typeof e?e({}):e||a:s(e),r.createElement(i.Provider,{value:o},t)}},841:function(e,t,n){"use strict";n.d(t,{hJ:function(){return eV},v0:function(){return t4},Aj:function(){return eJ},rh:function(){return tv},w7:function(){return eZ}});var r,i=n(4444),s=n(7456);function a(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&0>t.indexOf(r)&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)0>t.indexOf(r[i])&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n}var o=n(3333),l=n(8463);function u(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}let c=new i.LL("auth","Firebase",u()),h=new o.Yd("@firebase/auth");function d(e,...t){h.logLevel<=o.in.ERROR&&h.error(`Auth (${s.Jn}): ${e}`,...t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ function f(e,...t){throw g(e,...t)}function p(e,...t){return g(e,...t)}function m(e,t,n){let r=Object.assign(Object.assign({},u()),{[t]:n}),s=new i.LL("auth","Firebase",r);return s.create(t,{appName:e.name})}function g(e,...t){if("string"!=typeof e){let n=t[0],r=[...t.slice(1)];return r[0]&&(r[0].appName=e.name),e._errorFactory.create(n,...r)}return c.create(e,...t)}function y(e,t,...n){if(!e)throw g(t,...n)}function _(e){let t="INTERNAL ASSERTION FAILED: "+e;throw d(t),Error(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ function v(){var e;return"undefined"!=typeof self&&(null===(e=self.location)||void 0===e?void 0:e.href)||""}function w(){var e;return"undefined"!=typeof self&&(null===(e=self.location)||void 0===e?void 0:e.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ class b{constructor(e,t){this.shortDelay=e,this.longDelay=t,t>e||_("Short delay should be less than long delay!"),this.isMobile=(0,i.uI)()||(0,i.b$)()}get(){return!("undefined"!=typeof navigator&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&("http:"===w()||"https:"===w()||(0,i.ru)()||"connection"in navigator))||navigator.onLine?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ function E(e,t){e.emulator||_("Emulator should always be set here");let{url:n}=e.emulator;return t?`${n}${t.startsWith("/")?t.slice(1):t}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ class I{static initialize(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}static fetch(){return this.fetchImpl?this.fetchImpl:"undefined"!=typeof self&&"fetch"in self?self.fetch:void _("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"undefined"!=typeof self&&"Headers"in self?self.Headers:void _("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"undefined"!=typeof self&&"Response"in self?self.Response:void _("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ let S={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"},T=new b(3e4,6e4);function D(e,t){return e.tenantId&&!t.tenantId?Object.assign(Object.assign({},t),{tenantId:e.tenantId}):t}async function x(e,t,n,r,s={}){return k(e,s,async()=>{let s={},a={};r&&("GET"===t?a=r:s={body:JSON.stringify(r)});let o=(0,i.xO)(Object.assign({key:e.config.apiKey},a)).slice(1),l=await e._getAdditionalHeaders();return l["Content-Type"]="application/json",e.languageCode&&(l["X-Firebase-Locale"]=e.languageCode),I.fetch()(N(e,e.config.apiHost,n,o),Object.assign({method:t,headers:l,referrerPolicy:"no-referrer"},s))})}async function k(e,t,n){e._canInitEmulator=!1;let r=Object.assign(Object.assign({},S),t);try{let s=new R(e),a=await Promise.race([n(),s.promise]);s.clearNetworkTimeout();let o=await a.json();if("needConfirmation"in o)throw A(e,"account-exists-with-different-credential",o);if(a.ok&&!("errorMessage"in o))return o;{let l=a.ok?o.errorMessage:o.error.message,[u,c]=l.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===u)throw A(e,"credential-already-in-use",o);if("EMAIL_EXISTS"===u)throw A(e,"email-already-in-use",o);if("USER_DISABLED"===u)throw A(e,"user-disabled",o);let h=r[u]||u.toLowerCase().replace(/[_\s]+/g,"-");if(c)throw m(e,h,c);f(e,h)}}catch(d){if(d instanceof i.ZR)throw d;f(e,"network-request-failed",{message:String(d)})}}async function C(e,t,n,r,i={}){let s=await x(e,t,n,r,i);return"mfaPendingCredential"in s&&f(e,"multi-factor-auth-required",{_serverResponse:s}),s}function N(e,t,n,r){let i=`${t}${n}?${r}`;return e.config.emulator?E(e.config,i):`${e.config.apiScheme}://${i}`}class R{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((e,t)=>{this.timer=setTimeout(()=>t(p(this.auth,"network-request-failed")),T.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function A(e,t,n){let r={appName:e.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);let i=p(e,t,r);return i.customData._tokenResponse=n,i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ async function O(e,t){return x(e,"POST","/v1/accounts:delete",t)}async function P(e,t){return x(e,"POST","/v1/accounts:lookup",t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ function L(e){if(e)try{let t=new Date(Number(e));if(!isNaN(t.getTime()))return t.toUTCString()}catch(n){}}async function M(e,t=!1){let n=(0,i.m9)(e),r=await n.getIdToken(t),s=F(r);y(s&&s.exp&&s.auth_time&&s.iat,n.auth,"internal-error");let a="object"==typeof s.firebase?s.firebase:void 0,o=null==a?void 0:a.sign_in_provider;return{claims:s,token:r,authTime:L(U(s.auth_time)),issuedAtTime:L(U(s.iat)),expirationTime:L(U(s.exp)),signInProvider:o||null,signInSecondFactor:(null==a?void 0:a.sign_in_second_factor)||null}}function U(e){return 1e3*Number(e)}function F(e){let[t,n,r]=e.split(".");if(void 0===t||void 0===n||void 0===r)return d("JWT malformed, contained fewer than 3 sections"),null;try{let s=(0,i.tV)(n);if(!s)return d("Failed to decode base64 JWT payload"),null;return JSON.parse(s)}catch(a){return d("Caught error parsing JWT payload as JSON",null==a?void 0:a.toString()),null}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ async function j(e,t,n=!1){if(n)return t;try{return await t}catch(r){throw r instanceof i.ZR&&function({code:e}){return"auth/user-disabled"===e||"auth/user-token-expired"===e}(r)&&e.auth.currentUser===e&&await e.auth.signOut(),r}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ class B{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){let n=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),n}{this.errorBackoff=3e4;let r=null!==(t=this.user.stsTokenManager.expirationTime)&&void 0!==t?t:0,i=r-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;let t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(null==e?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ class ${constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=L(this.lastLoginAt),this.creationTime=L(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ async function V(e){var t;let n=e.auth,r=await e.getIdToken(),i=await j(e,P(n,{idToken:r}));y(null==i?void 0:i.users.length,n,"internal-error");let s=i.users[0];e._notifyReloadListener(s);let o=(null===(t=s.providerUserInfo)||void 0===t?void 0:t.length)?s.providerUserInfo.map(e=>{var{providerId:t}=e,n=a(e,["providerId"]);return{providerId:t,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}}):[],l=function(e,t){let n=e.filter(e=>!t.some(t=>t.providerId===e.providerId));return[...n,...t]}(e.providerData,o),u=e.isAnonymous,c=!(e.email&&s.passwordHash)&&!(null==l?void 0:l.length),h={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:l,metadata:new $(s.createdAt,s.lastLoginAt),isAnonymous:!!u&&c};Object.assign(e,h)}async function G(e){let t=(0,i.m9)(e);await V(t),await t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ async function q(e,t){let n=await k(e,{},async()=>{let n=(0,i.xO)({grant_type:"refresh_token",refresh_token:t}).slice(1),{tokenApiHost:r,apiKey:s}=e.config,a=N(e,r,"/v1/token",`key=${s}`),o=await e._getAdditionalHeaders();return o["Content-Type"]="application/x-www-form-urlencoded",I.fetch()(a,{method:"POST",headers:o,body:n})});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ class z{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){y(e.idToken,"internal-error"),y(void 0!==e.idToken,"internal-error"),y(void 0!==e.refreshToken,"internal-error");let t="expiresIn"in e&&void 0!==e.expiresIn?Number(e.expiresIn):function(e){let t=F(e);return y(t,"internal-error"),y(void 0!==t.exp,"internal-error"),y(void 0!==t.iat,"internal-error"),Number(t.exp)-Number(t.iat)}(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}async getToken(e,t=!1){return(y(!this.accessToken||this.refreshToken,e,"user-token-expired"),t||!this.accessToken||this.isExpired)?this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null:this.accessToken}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){let{accessToken:n,refreshToken:r,expiresIn:i}=await q(e,t);this.updateTokensAndExpiration(n,r,Number(i))}updateTokensAndExpiration(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+1e3*n}static fromJSON(e,t){let{refreshToken:n,accessToken:r,expirationTime:i}=t,s=new z;return n&&(y("string"==typeof n,"internal-error",{appName:e}),s.refreshToken=n),r&&(y("string"==typeof r,"internal-error",{appName:e}),s.accessToken=r),i&&(y("number"==typeof i,"internal-error",{appName:e}),s.expirationTime=i),s}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new z,this.toJSON())}_performRefresh(){return _("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ function K(e,t){y("string"==typeof e||void 0===e,"internal-error",{appName:t})}class Y{constructor(e){var{uid:t,auth:n,stsTokenManager:r}=e,i=a(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new B(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=n,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new $(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){let t=await j(this,this.stsTokenManager.getToken(this.auth,e));return y(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return M(this,e)}reload(){return G(this)}_assign(e){this!==e&&(y(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(e=>Object.assign({},e)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){let t=new Y(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){y(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),t&&await V(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){let e=await this.getIdToken();return await j(this,O(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var n,r,i,s,a,o,l,u;let c=null!==(n=t.displayName)&&void 0!==n?n:void 0,h=null!==(r=t.email)&&void 0!==r?r:void 0,d=null!==(i=t.phoneNumber)&&void 0!==i?i:void 0,f=null!==(s=t.photoURL)&&void 0!==s?s:void 0,p=null!==(a=t.tenantId)&&void 0!==a?a:void 0,m=null!==(o=t._redirectEventId)&&void 0!==o?o:void 0,g=null!==(l=t.createdAt)&&void 0!==l?l:void 0,_=null!==(u=t.lastLoginAt)&&void 0!==u?u:void 0,{uid:v,emailVerified:w,isAnonymous:b,providerData:E,stsTokenManager:I}=t;y(v&&I,e,"internal-error");let S=z.fromJSON(this.name,I);y("string"==typeof v,e,"internal-error"),K(c,e.name),K(h,e.name),y("boolean"==typeof w,e,"internal-error"),y("boolean"==typeof b,e,"internal-error"),K(d,e.name),K(f,e.name),K(p,e.name),K(m,e.name),K(g,e.name),K(_,e.name);let T=new Y({uid:v,auth:e,email:h,emailVerified:w,displayName:c,isAnonymous:b,photoURL:f,phoneNumber:d,tenantId:p,stsTokenManager:S,createdAt:g,lastLoginAt:_});return E&&Array.isArray(E)&&(T.providerData=E.map(e=>Object.assign({},e))),m&&(T._redirectEventId=m),T}static async _fromIdTokenResponse(e,t,n=!1){let r=new z;r.updateFromServerResponse(t);let i=new Y({uid:t.localId,auth:e,stsTokenManager:r,isAnonymous:n});return await V(i),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ let H=new Map;function W(e){e instanceof Function||_("Expected a class definition");let t=H.get(e);return t?(t instanceof e||_("Instance stored in cache mismatched with class"),t):(t=new e,H.set(e,t),t)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ class Q{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){let t=this.storage[e];return void 0===t?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ function X(e,t,n){return`firebase:${e}:${t}:${n}`}Q.type="NONE";class J{constructor(e,t,n){this.persistence=e,this.auth=t,this.userKey=n;let{config:r,name:i}=this.auth;this.fullUserKey=X(this.userKey,r.apiKey,i),this.fullPersistenceKey=X("persistence",r.apiKey,i),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){let e=await this.persistence._get(this.fullUserKey);return e?Y._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;let t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,n="authUser"){if(!t.length)return new J(W(Q),e,n);let r=(await Promise.all(t.map(async e=>{if(await e._isAvailable())return e}))).filter(e=>e),i=r[0]||W(Q),s=X(n,e.config.apiKey,e.name),a=null;for(let o of t)try{let l=await o._get(s);if(l){let u=Y._fromJSON(e,l);o!==i&&(a=u),i=o;break}}catch(c){}let h=r.filter(e=>e._shouldAllowMigration);return i._shouldAllowMigration&&h.length&&(i=h[0],a&&await i._set(s,a.toJSON()),await Promise.all(t.map(async e=>{if(e!==i)try{await e._remove(s)}catch(t){}}))),new J(i,e,n)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ function Z(e){let t=e.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(er(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";{if(t.includes("edge/"))return"Edge";if(ee(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(es(t))return"Blackberry";if(ea(t))return"Webos";if(et(t))return"Safari";if((t.includes("chrome/")||en(t))&&!t.includes("edge/"))return"Chrome";if(ei(t))return"Android";let n=e.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/);if((null==n?void 0:n.length)===2)return n[1]}return"Other"}function ee(e=(0,i.z$)()){return/firefox\//i.test(e)}function et(e=(0,i.z$)()){let t=e.toLowerCase();return t.includes("safari/")&&!t.includes("chrome/")&&!t.includes("crios/")&&!t.includes("android")}function en(e=(0,i.z$)()){return/crios\//i.test(e)}function er(e=(0,i.z$)()){return/iemobile/i.test(e)}function ei(e=(0,i.z$)()){return/android/i.test(e)}function es(e=(0,i.z$)()){return/blackberry/i.test(e)}function ea(e=(0,i.z$)()){return/webos/i.test(e)}function eo(e=(0,i.z$)()){return/iphone|ipad|ipod/i.test(e)||/macintosh/i.test(e)&&/mobile/i.test(e)}function el(e=(0,i.z$)()){return eo(e)||ei(e)||ea(e)||es(e)||/windows phone/i.test(e)||er(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ function eu(e,t=[]){let n;switch(e){case"Browser":n=Z((0,i.z$)());break;case"Worker":n=`${Z((0,i.z$)())}-${e}`;break;default:n=e}let r=t.length?t.join(","):"FirebaseCore-web";return`${n}/JsCore/${s.Jn}/${r}`}async function ec(e,t){return x(e,"GET","/v2/recaptchaConfig",D(e,t))}function eh(e){return void 0!==e&&void 0!==e.enterprise}class ed{constructor(e){if(this.siteKey="",this.emailPasswordEnabled=!1,void 0===e.recaptchaKey)throw Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.emailPasswordEnabled=e.recaptchaEnforcementState.some(e=>"EMAIL_PASSWORD_PROVIDER"===e.provider&&"OFF"!==e.enforcementState)}}function ef(e){return new Promise((t,n)=>{var r,i;let s=document.createElement("script");s.setAttribute("src",e),s.onload=t,s.onerror=e=>{let t=p("internal-error");t.customData=e,n(t)},s.type="text/javascript",s.charset="UTF-8",(null!==(i=null===(r=document.getElementsByTagName("head"))||void 0===r?void 0:r[0])&&void 0!==i?i:document).appendChild(s)})}function ep(e){return`__${e}${Math.floor(1e6*Math.random())}`}class em{constructor(e){this.type="recaptcha-enterprise",this.auth=ev(e)}async verify(e="verify",t=!1){async function n(e){if(!t){if(null==e.tenantId&&null!=e._agentRecaptchaConfig)return e._agentRecaptchaConfig.siteKey;if(null!=e.tenantId&&void 0!==e._tenantRecaptchaConfigs[e.tenantId])return e._tenantRecaptchaConfigs[e.tenantId].siteKey}return new Promise(async(t,n)=>{ec(e,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(r=>{if(void 0===r.recaptchaKey)n(Error("recaptcha Enterprise site key undefined"));else{let i=new ed(r);return null==e.tenantId?e._agentRecaptchaConfig=i:e._tenantRecaptchaConfigs[e.tenantId]=i,t(i.siteKey)}}).catch(e=>{n(e)})})}function r(t,n,r){let i=window.grecaptcha;eh(i)?i.enterprise.ready(()=>{i.enterprise.execute(t,{action:e}).then(e=>{n(e)}).catch(()=>{n("NO_RECAPTCHA")})}):r(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((e,i)=>{n(this.auth).then(n=>{if(!t&&eh(window.grecaptcha))r(n,e,i);else{if("undefined"==typeof window){i(Error("RecaptchaVerifier is only supported in browser"));return}ef("https://www.google.com/recaptcha/enterprise.js?render="+n).then(()=>{r(n,e,i)}).catch(e=>{i(e)})}}).catch(e=>{i(e)})})}}async function eg(e,t,n,r=!1){let i;let s=new em(e);try{i=await s.verify(n)}catch(a){i=await s.verify(n,!0)}let o=Object.assign({},t);return r?Object.assign(o,{captchaResp:i}):Object.assign(o,{captchaResponse:i}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ class ey{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){let n=t=>new Promise((n,r)=>{try{let i=e(t);n(i)}catch(s){r(s)}});n.onAbort=t,this.queue.push(n);let r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;let t=[];try{for(let n of this.queue)await n(e),n.onAbort&&t.push(n.onAbort)}catch(s){for(let r of(t.reverse(),t))try{r()}catch(i){}throw this.auth._errorFactory.create("login-blocked",{originalMessage:null==s?void 0:s.message})}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ class e_{constructor(e,t,n,r){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=n,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new ew(this),this.idTokenSubscription=new ew(this),this.beforeStateQueue=new ey(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=c,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=r.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=W(t)),this._initializationPromise=this.queue(async()=>{var n,r;if(!this._deleted&&(this.persistenceManager=await J.create(this,e),!this._deleted)){if(null===(n=this._popupRedirectResolver)||void 0===n?void 0:n._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch(i){}await this.initializeCurrentUser(t),this.lastNotifiedUid=(null===(r=this.currentUser)||void 0===r?void 0:r.uid)||null,this._deleted||(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;let e=await this.assertedPersistence.getCurrentUser();if(this.currentUser||e){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUser(e){var t;let n=await this.assertedPersistence.getCurrentUser(),r=n,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();let s=null===(t=this.redirectUser)||void 0===t?void 0:t._redirectEventId,a=null==r?void 0:r._redirectEventId,o=await this.tryRedirectSignIn(e);(!s||s===a)&&(null==o?void 0:o.user)&&(r=o.user,i=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(r)}catch(l){r=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(l))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return(y(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId)?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch(n){await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await V(e)}catch(t){if((null==t?void 0:t.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=function(){if("undefined"==typeof navigator)return null;let e=navigator;return e.languages&&e.languages[0]||e.language||null}()}async _delete(){this._deleted=!0}async updateCurrentUser(e){let t=e?(0,i.m9)(e):null;return t&&y(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&y(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0)}setPersistence(e){return this.queue(async()=>{await this.assertedPersistence.setPersistence(W(e))})}async initializeRecaptchaConfig(){let e=await ec(this,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}),t=new ed(e);if(null==this.tenantId?this._agentRecaptchaConfig=t:this._tenantRecaptchaConfigs[this.tenantId]=t,t.emailPasswordEnabled){let n=new em(this);n.verify()}}_getRecaptchaConfig(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new i.LL("auth","Firebase",e())}onAuthStateChanged(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(e=this._currentUser)||void 0===e?void 0:e.toJSON()}}async _setRedirectUser(e,t){let n=await this.getOrInitRedirectPersistenceManager(t);return null===e?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){let t=e&&W(e)||this._popupRedirectResolver;y(t,this,"argument-error"),this.redirectPersistenceManager=await J.create(this,[W(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,n;return(this._isInitialized&&await this.queue(async()=>{}),(null===(t=this._currentUser)||void 0===t?void 0:t._redirectEventId)===e)?this._currentUser:(null===(n=this.redirectUser)||void 0===n?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);let n=null!==(t=null===(e=this.currentUser)||void 0===e?void 0:e.uid)&&void 0!==t?t:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,n,r){if(this._deleted)return()=>{};let i="function"==typeof t?t:t.next.bind(t),s=this._isInitialized?Promise.resolve():this._initializationPromise;return(y(s,this,"internal-error"),s.then(()=>i(this.currentUser)),"function"==typeof t)?e.addObserver(t,n,r):e.addObserver(t)}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return y(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=eu(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;let t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);let n=await (null===(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getHeartbeatsHeader());n&&(t["X-Firebase-Client"]=n);let r=await this._getAppCheckToken();return r&&(t["X-Firebase-AppCheck"]=r),t}async _getAppCheckToken(){var e;let t=await (null===(e=this.appCheckServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getToken());return(null==t?void 0:t.error)&&function(e,...t){h.logLevel<=o.in.WARN&&h.warn(`Auth (${s.Jn}): ${e}`,...t)}(`Error while retrieving App Check token: ${t.error}`),null==t?void 0:t.token}}function ev(e){return(0,i.m9)(e)}class ew{constructor(e){this.auth=e,this.observer=null,this.addObserver=(0,i.ne)(e=>this.observer=e)}get next(){return y(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}function eb(e){let t=e.indexOf(":");return t<0?"":e.substr(0,t+1)}function eE(e){if(!e)return null;let t=Number(e);return isNaN(t)?null:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ class eI{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return _("not implemented")}_getIdTokenResponse(e){return _("not implemented")}_linkToIdToken(e,t){return _("not implemented")}_getReauthenticationResolver(e){return _("not implemented")}}async function eS(e,t){return x(e,"POST","/v1/accounts:update",t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ async function eT(e,t){return C(e,"POST","/v1/accounts:signInWithPassword",D(e,t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ async function eD(e,t){return C(e,"POST","/v1/accounts:signInWithEmailLink",D(e,t))}async function ex(e,t){return C(e,"POST","/v1/accounts:signInWithEmailLink",D(e,t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ class ek extends eI{constructor(e,t,n,r=null){super("password",n),this._email=e,this._password=t,this._tenantId=r}static _fromEmailAndPassword(e,t){return new ek(e,t,"password")}static _fromEmailAndCode(e,t,n=null){return new ek(e,t,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){let t="string"==typeof e?JSON.parse(e):e;if((null==t?void 0:t.email)&&(null==t?void 0:t.password)){if("password"===t.signInMethod)return this._fromEmailAndPassword(t.email,t.password);if("emailLink"===t.signInMethod)return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){var t;switch(this.signInMethod){case"password":let n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};if(null===(t=e._getRecaptchaConfig())||void 0===t||!t.emailPasswordEnabled)return eT(e,n).catch(async t=>{if("auth/missing-recaptcha-token"!==t.code)return Promise.reject(t);{console.log("Sign-in with email address and password is protected by reCAPTCHA for this project. Automatically triggering the reCAPTCHA flow and restarting the sign-in flow.");let r=await eg(e,n,"signInWithPassword");return eT(e,r)}});{let r=await eg(e,n,"signInWithPassword");return eT(e,r)}case"emailLink":return eD(e,{email:this._email,oobCode:this._password});default:f(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":return eS(e,{idToken:t,returnSecureToken:!0,email:this._email,password:this._password});case"emailLink":return ex(e,{idToken:t,email:this._email,oobCode:this._password});default:f(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ async function eC(e,t){return C(e,"POST","/v1/accounts:signInWithIdp",D(e,t))}class eN extends eI{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){let t=new eN(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):f("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){let t="string"==typeof e?JSON.parse(e):e,{providerId:n,signInMethod:r}=t,i=a(t,["providerId","signInMethod"]);if(!n||!r)return null;let s=new eN(n,r);return s.idToken=i.idToken||void 0,s.accessToken=i.accessToken||void 0,s.secret=i.secret,s.nonce=i.nonce,s.pendingToken=i.pendingToken||null,s}_getIdTokenResponse(e){let t=this.buildRequest();return eC(e,t)}_linkToIdToken(e,t){let n=this.buildRequest();return n.idToken=t,eC(e,n)}_getReauthenticationResolver(e){let t=this.buildRequest();return t.autoCreate=!1,eC(e,t)}buildRequest(){let e={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{let t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=(0,i.xO)(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ async function eR(e,t){return x(e,"POST","/v1/accounts:sendVerificationCode",D(e,t))}async function eA(e,t){return C(e,"POST","/v1/accounts:signInWithPhoneNumber",D(e,t))}async function eO(e,t){let n=await C(e,"POST","/v1/accounts:signInWithPhoneNumber",D(e,t));if(n.temporaryProof)throw A(e,"account-exists-with-different-credential",n);return n}let eP={USER_NOT_FOUND:"user-not-found"};async function eL(e,t){let n=Object.assign(Object.assign({},t),{operation:"REAUTH"});return C(e,"POST","/v1/accounts:signInWithPhoneNumber",D(e,n),eP)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ class eM extends eI{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,t){return new eM({verificationId:e,verificationCode:t})}static _fromTokenResponse(e,t){return new eM({phoneNumber:e,temporaryProof:t})}_getIdTokenResponse(e){return eA(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return eO(e,Object.assign({idToken:t},this._makeVerificationRequest()))}_getReauthenticationResolver(e){return eL(e,this._makeVerificationRequest())}_makeVerificationRequest(){let{temporaryProof:e,phoneNumber:t,verificationId:n,verificationCode:r}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:n,code:r}}toJSON(){let e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){"string"==typeof e&&(e=JSON.parse(e));let{verificationId:t,verificationCode:n,phoneNumber:r,temporaryProof:i}=e;return n||t||r||i?new eM({verificationId:t,verificationCode:n,phoneNumber:r,temporaryProof:i}):null}}class eU{constructor(e){var t,n,r,s,a,o;let l=(0,i.zd)((0,i.pd)(e)),u=null!==(t=l.apiKey)&&void 0!==t?t:null,c=null!==(n=l.oobCode)&&void 0!==n?n:null,h=/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ function(e){switch(e){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(r=l.mode)&&void 0!==r?r:null);y(u&&c&&h,"argument-error"),this.apiKey=u,this.operation=h,this.code=c,this.continueUrl=null!==(s=l.continueUrl)&&void 0!==s?s:null,this.languageCode=null!==(a=l.languageCode)&&void 0!==a?a:null,this.tenantId=null!==(o=l.tenantId)&&void 0!==o?o:null}static parseLink(e){let t=function(e){let t=(0,i.zd)((0,i.pd)(e)).link,n=t?(0,i.zd)((0,i.pd)(t)).deep_link_id:null,r=(0,i.zd)((0,i.pd)(e)).deep_link_id,s=r?(0,i.zd)((0,i.pd)(r)).link:null;return s||r||n||t||e}(e);try{return new eU(t)}catch(n){return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ class eF{constructor(){this.providerId=eF.PROVIDER_ID}static credential(e,t){return ek._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){let n=eU.parseLink(t);return y(n,"argument-error"),ek._fromEmailAndCode(e,n.code,n.tenantId)}}eF.PROVIDER_ID="password",eF.EMAIL_PASSWORD_SIGN_IN_METHOD="password",eF.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ class ej{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ class eB extends ej{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ class e$ extends eB{constructor(){super("facebook.com")}static credential(e){return eN._fromParams({providerId:e$.PROVIDER_ID,signInMethod:e$.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return e$.credentialFromTaggedObject(e)}static credentialFromError(e){return e$.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return e$.credential(e.oauthAccessToken)}catch(t){return null}}}e$.FACEBOOK_SIGN_IN_METHOD="facebook.com",e$.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ class eV extends eB{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return eN._fromParams({providerId:eV.PROVIDER_ID,signInMethod:eV.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return eV.credentialFromTaggedObject(e)}static credentialFromError(e){return eV.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;let{oauthIdToken:t,oauthAccessToken:n}=e;if(!t&&!n)return null;try{return eV.credential(t,n)}catch(r){return null}}}eV.GOOGLE_SIGN_IN_METHOD="google.com",eV.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ class eG extends eB{constructor(){super("github.com")}static credential(e){return eN._fromParams({providerId:eG.PROVIDER_ID,signInMethod:eG.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return eG.credentialFromTaggedObject(e)}static credentialFromError(e){return eG.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return eG.credential(e.oauthAccessToken)}catch(t){return null}}}eG.GITHUB_SIGN_IN_METHOD="github.com",eG.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ class eq extends eB{constructor(){super("twitter.com")}static credential(e,t){return eN._fromParams({providerId:eq.PROVIDER_ID,signInMethod:eq.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return eq.credentialFromTaggedObject(e)}static credentialFromError(e){return eq.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;let{oauthAccessToken:t,oauthTokenSecret:n}=e;if(!t||!n)return null;try{return eq.credential(t,n)}catch(r){return null}}}eq.TWITTER_SIGN_IN_METHOD="twitter.com",eq.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ class ez{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,n,r=!1){let i=await Y._fromIdTokenResponse(e,n,r),s=eK(n),a=new ez({user:i,providerId:s,_tokenResponse:n,operationType:t});return a}static async _forOperation(e,t,n){await e._updateTokensIfNecessary(n,!0);let r=eK(n);return new ez({user:e,providerId:r,_tokenResponse:n,operationType:t})}}function eK(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ class eY extends i.ZR{constructor(e,t,n,r){var i;super(t.code,t.message),this.operationType=n,this.user=r,Object.setPrototypeOf(this,eY.prototype),this.customData={appName:e.name,tenantId:null!==(i=e.tenantId)&&void 0!==i?i:void 0,_serverResponse:t.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,t,n,r){return new eY(e,t,n,r)}}function eH(e,t,n,r){let i="reauthenticate"===t?n._getReauthenticationResolver(e):n._getIdTokenResponse(e);return i.catch(n=>{if("auth/multi-factor-auth-required"===n.code)throw eY._fromErrorAndOperation(e,n,t,r);throw n})}async function eW(e,t,n=!1){let r=await j(e,t._linkToIdToken(e.auth,await e.getIdToken()),n);return ez._forOperation(e,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ async function eQ(e,t,n=!1){let{auth:r}=e,i="reauthenticate";try{let s=await j(e,eH(r,i,t,e),n);y(s.idToken,r,"internal-error");let a=F(s.idToken);y(a,r,"internal-error");let{sub:o}=a;return y(e.uid===o,r,"user-mismatch"),ez._forOperation(e,i,s)}catch(l){throw(null==l?void 0:l.code)==="auth/user-not-found"&&f(r,"user-mismatch"),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ async function eX(e,t,n=!1){let r="signIn",i=await eH(e,r,t),s=await ez._fromIdTokenResponse(e,r,i);return n||await e._updateCurrentUser(s.user),s}function eJ(e,t,n,r){return(0,i.m9)(e).onAuthStateChanged(t,n,r)}function eZ(e){return(0,i.m9)(e).signOut()}new WeakMap;let e0="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ class e1{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{if(!this.storage)return Promise.resolve(!1);return this.storage.setItem(e0,"1"),this.storage.removeItem(e0),Promise.resolve(!0)}catch(e){return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){let t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}class e2 extends e1{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ function(){let e=(0,i.z$)();return et(e)||eo(e)}()&&function(){try{return!!(window&&window!==window.top)}catch(e){return!1}}(),this.fallbackToPolling=el(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(let t of Object.keys(this.listeners)){let n=this.storage.getItem(t),r=this.localCache[t];n!==r&&e(t,r,n)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((e,t,n)=>{this.notifyListeners(e,n)});return}let n=e.key;if(t?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){let r=this.storage.getItem(n);if(e.newValue!==r)null!==e.newValue?this.storage.setItem(n,e.newValue):this.storage.removeItem(n);else if(this.localCache[n]===e.newValue&&!t)return}let s=()=>{let e=this.storage.getItem(n);(t||this.localCache[n]!==e)&&this.notifyListeners(n,e)},a=this.storage.getItem(n);(0,i.w1)()&&10===document.documentMode&&a!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,10):s()}notifyListeners(e,t){this.localCache[e]=t;let n=this.listeners[e];if(n)for(let r of Array.from(n))r(t?JSON.parse(t):t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:n}),!0)})},1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){let t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}e2.type="LOCAL";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ class e4 extends e1{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}e4.type="SESSION";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ class e9{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){let t=this.receivers.find(t=>t.isListeningto(e));if(t)return t;let n=new e9(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){let{eventId:t,eventType:n,data:r}=e.data,i=this.handlersMap[n];if(!(null==i?void 0:i.size))return;e.ports[0].postMessage({status:"ack",eventId:t,eventType:n});let s=Array.from(i).map(async t=>t(e.origin,r)),a=await Promise.all(s.map(async e=>{try{let t=await e;return{fulfilled:!0,value:t}}catch(n){return{fulfilled:!1,reason:n}}}));e.ports[0].postMessage({status:"done",eventId:t,eventType:n,response:a})}_subscribe(e,t){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),t&&0!==this.handlersMap[e].size||delete this.handlersMap[e],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ function e6(e="",t=10){let n="";for(let r=0;r<t;r++)n+=Math.floor(10*Math.random());return e+n}e9.receivers=[];/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ class e5{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,n=50){let r,i;let s="undefined"!=typeof MessageChannel?new MessageChannel:null;if(!s)throw Error("connection_unavailable");return new Promise((a,o)=>{let l=e6("",20);s.port1.start();let u=setTimeout(()=>{o(Error("unsupported_event"))},n);i={messageChannel:s,onMessage(e){if(e.data.eventId===l)switch(e.data.status){case"ack":clearTimeout(u),r=setTimeout(()=>{o(Error("timeout"))},3e3);break;case"done":clearTimeout(r),a(e.data.response);break;default:clearTimeout(u),clearTimeout(r),o(Error("invalid_response"))}}},this.handlers.add(i),s.port1.addEventListener("message",i.onMessage),this.target.postMessage({eventType:e,eventId:l,data:t},[s.port2])}).finally(()=>{i&&this.removeMessageHandler(i)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ function e3(){return window}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ function e7(){return void 0!==e3().WorkerGlobalScope&&"function"==typeof e3().importScripts}async function e8(){if(!(null==navigator?void 0:navigator.serviceWorker))return null;try{let e=await navigator.serviceWorker.ready;return e.active}catch(t){return null}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ let te="firebaseLocalStorageDb",tt="firebaseLocalStorage",tn="fbase_key";class tr{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function ti(e,t){return e.transaction([tt],t?"readwrite":"readonly").objectStore(tt)}function ts(){let e=indexedDB.open(te,1);return new Promise((t,n)=>{e.addEventListener("error",()=>{n(e.error)}),e.addEventListener("upgradeneeded",()=>{let t=e.result;try{t.createObjectStore(tt,{keyPath:tn})}catch(r){n(r)}}),e.addEventListener("success",async()=>{let n=e.result;n.objectStoreNames.contains(tt)?t(n):(n.close(),await function(){let e=indexedDB.deleteDatabase(te);return new tr(e).toPromise()}(),t(await ts()))})})}async function ta(e,t,n){let r=ti(e,!0).put({[tn]:t,value:n});return new tr(r).toPromise()}async function to(e,t){let n=ti(e,!1).get(t),r=await new tr(n).toPromise();return void 0===r?null:r.value}function tl(e,t){let n=ti(e,!0).delete(t);return new tr(n).toPromise()}class tu{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db||(this.db=await ts()),this.db}async _withRetries(e){let t=0;for(;;)try{let n=await this._openDb();return await e(n)}catch(r){if(t++>3)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return e7()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=e9._getInstance(e7()?self:null),this.receiver._subscribe("keyChanged",async(e,t)=>{let n=await this._poll();return{keyProcessed:n.includes(t.key)}}),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var e,t;if(this.activeServiceWorker=await e8(),!this.activeServiceWorker)return;this.sender=new e5(this.activeServiceWorker);let n=await this.sender._send("ping",{},800);n&&(null===(e=n[0])||void 0===e?void 0:e.fulfilled)&&(null===(t=n[0])||void 0===t?void 0:t.value.includes("keyChanged"))&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){var t;if(this.sender&&this.activeServiceWorker&&((null===(t=null==navigator?void 0:navigator.serviceWorker)||void 0===t?void 0:t.controller)||null)===this.activeServiceWorker)try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch(n){}}async _isAvailable(){try{if(!indexedDB)return!1;let e=await ts();return await ta(e,e0,"1"),await tl(e,e0),!0}catch(t){}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(n=>ta(n,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){let t=await this._withRetries(t=>to(t,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>tl(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){let e=await this._withRetries(e=>{let t=ti(e,!1).getAll();return new tr(t).toPromise()});if(!e||0!==this.pendingWrites)return[];let t=[],n=new Set;for(let{fbase_key:r,value:i}of e)n.add(r),JSON.stringify(this.localCache[r])!==JSON.stringify(i)&&(this.notifyListeners(r,i),t.push(r));for(let s of Object.keys(this.localCache))this.localCache[s]&&!n.has(s)&&(this.notifyListeners(s,null),t.push(s));return t}notifyListeners(e,t){this.localCache[e]=t;let n=this.listeners[e];if(n)for(let r of Array.from(n))r(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&this.stopPolling()}}async function tc(e,t,n){var r,i,s;let a=await n.verify();try{let o;if(y("string"==typeof a,e,"argument-error"),y("recaptcha"===n.type,e,"argument-error"),o="string"==typeof t?{phoneNumber:t}:t,"session"in o){let l=o.session;if("phoneNumber"in o){y("enroll"===l.type,e,"internal-error");let u=await (i={idToken:l.credential,phoneEnrollmentInfo:{phoneNumber:o.phoneNumber,recaptchaToken:a}},x(e,"POST","/v2/accounts/mfaEnrollment:start",D(e,i)));return u.phoneSessionInfo.sessionInfo}{y("signin"===l.type,e,"internal-error");let c=(null===(r=o.multiFactorHint)||void 0===r?void 0:r.uid)||o.multiFactorUid;y(c,e,"missing-multi-factor-info");let h=await (s={mfaPendingCredential:l.credential,mfaEnrollmentId:c,phoneSignInInfo:{recaptchaToken:a}},x(e,"POST","/v2/accounts/mfaSignIn:start",D(e,s)));return h.phoneResponseInfo.sessionInfo}}{let{sessionInfo:d}=await eR(e,{phoneNumber:o.phoneNumber,recaptchaToken:a});return d}}finally{n._reset()}}tu.type="LOCAL",ep("rcb"),new b(3e4,6e4);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ class th{constructor(e){this.providerId=th.PROVIDER_ID,this.auth=ev(e)}verifyPhoneNumber(e,t){return tc(this.auth,e,(0,i.m9)(t))}static credential(e,t){return eM._fromVerification(e,t)}static credentialFromResult(e){return th.credentialFromTaggedObject(e)}static credentialFromError(e){return th.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;let{phoneNumber:t,temporaryProof:n}=e;return t&&n?eM._fromTokenResponse(t,n):null}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ function td(e,t){return t?W(t):(y(e._popupRedirectResolver,e,"argument-error"),e._popupRedirectResolver)}th.PROVIDER_ID="phone",th.PHONE_SIGN_IN_METHOD="phone";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ class tf extends eI{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return eC(e,this._buildIdpRequest())}_linkToIdToken(e,t){return eC(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return eC(e,this._buildIdpRequest())}_buildIdpRequest(e){let t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function tp(e){return eX(e.auth,new tf(e),e.bypassAuthState)}function tm(e){let{auth:t,user:n}=e;return y(n,t,"internal-error"),eQ(n,new tf(e),e.bypassAuthState)}async function tg(e){let{auth:t,user:n}=e;return y(n,t,"internal-error"),eW(n,new tf(e),e.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ class ty{constructor(e,t,n,r,i=!1){this.auth=e,this.resolver=n,this.user=r,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){let{urlResponse:t,sessionId:n,postBody:r,tenantId:i,error:s,type:a}=e;if(s){this.reject(s);return}let o={auth:this.auth,requestUri:t,sessionId:n,tenantId:i||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(o))}catch(l){this.reject(l)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return tp;case"linkViaPopup":case"linkViaRedirect":return tg;case"reauthViaPopup":case"reauthViaRedirect":return tm;default:f(this.auth,"internal-error")}}resolve(e){this.pendingPromise||_("Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){this.pendingPromise||_("Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ let t_=new b(2e3,1e4);async function tv(e,t,n){let r=ev(e);!function(e,t,n){if(!(t instanceof n))throw n.name!==t.constructor.name&&f(e,"argument-error"),m(e,"argument-error",`Type of ${t.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}(e,t,ej);let i=td(r,n),s=new tw(r,"signInViaPopup",t,i);return s.executeNotNull()}class tw extends ty{constructor(e,t,n,r,i){super(e,t,r,i),this.provider=n,this.authWindow=null,this.pollId=null,tw.currentPopupAction&&tw.currentPopupAction.cancel(),tw.currentPopupAction=this}async executeNotNull(){let e=await this.execute();return y(e,this.auth,"internal-error"),e}async onExecution(){1===this.filter.length||_("Popup operations only handle one event");let e=e6();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(e=>{this.reject(e)}),this.resolver._isIframeWebStorageSupported(this.auth,e=>{e||this.reject(p(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return(null===(e=this.authWindow)||void 0===e?void 0:e.associatedEvent)||null}cancel(){this.reject(p(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,tw.currentPopupAction=null}pollUserCancellation(){let e=()=>{var t,n;if(null===(n=null===(t=this.authWindow)||void 0===t?void 0:t.window)||void 0===n?void 0:n.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(p(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,t_.get())};e()}}tw.currentPopupAction=null;let tb=new Map;class tE extends ty{constructor(e,t,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,n),this.eventId=null}async execute(){let e=tb.get(this.auth._key());if(!e){try{let t=await tI(this.resolver,this.auth),n=t?await super.execute():null;e=()=>Promise.resolve(n)}catch(r){e=()=>Promise.reject(r)}tb.set(this.auth._key(),e)}return this.bypassAuthState||tb.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if("signInViaRedirect"===e.type)return super.onAuthEvent(e);if("unknown"===e.type){this.resolve(null);return}if(e.eventId){let t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function tI(e,t){let n=X("pendingRedirect",t.config.apiKey,t.name),r=W(e._redirectPersistence);if(!await r._isAvailable())return!1;let i=await r._get(n)==="true";return await r._remove(n),i}function tS(e,t){tb.set(e._key(),t)}async function tT(e,t,n=!1){let r=ev(e),i=td(r,t),s=new tE(r,i,n),a=await s.execute();return a&&!n&&(delete a.user._redirectEventId,await r._persistUserIfCurrent(a.user),await r._setRedirectUser(null,t)),a}class tD{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(t=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!function(e){switch(e.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return tk(e);default:return!1}}(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var n;if(e.error&&!tk(e)){let r=(null===(n=e.error.code)||void 0===n?void 0:n.split("auth/")[1])||"internal-error";t.onError(p(this.auth,r))}else t.onAuthEvent(e)}isEventForConsumer(e,t){let n=null===t.eventId||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(tx(e))}saveEventToCache(e){this.cachedEventUids.add(tx(e)),this.lastProcessedEventTime=Date.now()}}function tx(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter(e=>e).join("-")}function tk({type:e,error:t}){return"unknown"===e&&(null==t?void 0:t.code)==="auth/no-auth-event"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ async function tC(e,t={}){return x(e,"GET","/v1/projects",t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ let tN=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,tR=/^https?/;async function tA(e){if(e.config.emulator)return;let{authorizedDomains:t}=await tC(e);for(let n of t)try{if(function(e){let t=v(),{protocol:n,hostname:r}=new URL(t);if(e.startsWith("chrome-extension://")){let i=new URL(e);return""===i.hostname&&""===r?"chrome-extension:"===n&&e.replace("chrome-extension://","")===t.replace("chrome-extension://",""):"chrome-extension:"===n&&i.hostname===r}if(!tR.test(n))return!1;if(tN.test(e))return r===e;let s=e.replace(/\./g,"\\."),a=RegExp("^(.+\\."+s+"|"+s+")$","i");return a.test(r)}(n))return}catch(r){}f(e,"unauthorized-domain")}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ let tO=new b(3e4,6e4);function tP(){let e=e3().___jsl;if(null==e?void 0:e.H){for(let t of Object.keys(e.H))if(e.H[t].r=e.H[t].r||[],e.H[t].L=e.H[t].L||[],e.H[t].r=[...e.H[t].L],e.CP)for(let n=0;n<e.CP.length;n++)e.CP[n]=null}}let tL=null,tM=new b(5e3,15e3),tU={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},tF=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);async function tj(e){let t=await (tL=tL||new Promise((t,n)=>{var r,i,s;function a(){tP(),gapi.load("gapi.iframes",{callback(){t(gapi.iframes.getContext())},ontimeout(){tP(),n(p(e,"network-request-failed"))},timeout:tO.get()})}if(null===(i=null===(r=e3().gapi)||void 0===r?void 0:r.iframes)||void 0===i?void 0:i.Iframe)t(gapi.iframes.getContext());else if(null===(s=e3().gapi)||void 0===s?void 0:s.load)a();else{let o=ep("iframefcb");return e3()[o]=()=>{gapi.load?a():n(p(e,"network-request-failed"))},ef(`https://apis.google.com/js/api.js?onload=${o}`).catch(e=>n(e))}}).catch(e=>{throw tL=null,e})),n=e3().gapi;return y(n,e,"internal-error"),t.open({where:document.body,url:function(e){let t=e.config;y(t.authDomain,e,"auth-domain-config-required");let n=t.emulator?E(t,"emulator/auth/iframe"):`https://${e.config.authDomain}/__/auth/iframe`,r={apiKey:t.apiKey,appName:e.name,v:s.Jn},a=tF.get(e.config.apiHost);a&&(r.eid=a);let o=e._getFrameworks();return o.length&&(r.fw=o.join(",")),`${n}?${(0,i.xO)(r).slice(1)}`}(e),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:tU,dontclear:!0},t=>new Promise(async(n,r)=>{await t.restyle({setHideOnLeave:!1});let i=p(e,"network-request-failed"),s=e3().setTimeout(()=>{r(i)},tM.get());function a(){e3().clearTimeout(s),n(t)}t.ping(a).then(a,()=>{r(i)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ let tB={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class t${constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch(e){}}}let tV=encodeURIComponent("fac");async function tG(e,t,n,r,a,o){y(e.config.authDomain,e,"auth-domain-config-required"),y(e.config.apiKey,e,"invalid-api-key");let l={apiKey:e.config.apiKey,appName:e.name,authType:n,redirectUrl:r,v:s.Jn,eventId:a};if(t instanceof ej)for(let[u,c]of(t.setDefaultLanguage(e.languageCode),l.providerId=t.providerId||"",(0,i.xb)(t.getCustomParameters())||(l.customParameters=JSON.stringify(t.getCustomParameters())),Object.entries(o||{})))l[u]=c;if(t instanceof eB){let h=t.getScopes().filter(e=>""!==e);h.length>0&&(l.scopes=h.join(","))}e.tenantId&&(l.tid=e.tenantId);let d=l;for(let f of Object.keys(d))void 0===d[f]&&delete d[f];let p=await e._getAppCheckToken(),m=p?`#${tV}=${encodeURIComponent(p)}`:"";return`${function({config:e}){return e.emulator?E(e,"emulator/auth/handler"):`https://${e.authDomain}/__/auth/handler`}(e)}?${(0,i.xO)(d).slice(1)}${m}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ let tq="webStorageSupport",tz=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=e4,this._completeRedirectFn=tT,this._overrideRedirectResult=tS}async _openPopup(e,t,n,r){var s;(null===(s=this.eventManagers[e._key()])||void 0===s?void 0:s.manager)||_("_initialize() not called before _openPopup()");let a=await tG(e,t,n,v(),r);return function(e,t,n,r=500,s=600){let a=Math.max((window.screen.availHeight-s)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString(),l="",u=Object.assign(Object.assign({},tB),{width:r.toString(),height:s.toString(),top:a,left:o}),c=(0,i.z$)().toLowerCase();n&&(l=en(c)?"_blank":n),ee(c)&&(t=t||"http://localhost",u.scrollbars="yes");let h=Object.entries(u).reduce((e,[t,n])=>`${e}${t}=${n},`,"");if(function(e=(0,i.z$)()){var t;return eo(e)&&!!(null===(t=window.navigator)||void 0===t?void 0:t.standalone)}(c)&&"_self"!==l)return function(e,t){let n=document.createElement("a");n.href=e,n.target=t;let r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}(t||"",l),new t$(null);let d=window.open(t||"",l,h);y(d,e,"popup-blocked");try{d.focus()}catch(f){}return new t$(d)}(e,a,e6())}async _openRedirect(e,t,n,r){await this._originValidation(e);let i=await tG(e,t,n,v(),r);return e3().location.href=i,new Promise(()=>{})}_initialize(e){let t=e._key();if(this.eventManagers[t]){let{manager:n,promise:r}=this.eventManagers[t];return n?Promise.resolve(n):(r||_("If manager is not set, promise should be"),r)}let i=this.initAndGetManager(e);return this.eventManagers[t]={promise:i},i.catch(()=>{delete this.eventManagers[t]}),i}async initAndGetManager(e){let t=await tj(e),n=new tD(e);return t.register("authEvent",t=>{y(null==t?void 0:t.authEvent,e,"invalid-auth-event");let r=n.onEvent(t.authEvent);return{status:r?"ACK":"ERROR"}},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=t,n}_isIframeWebStorageSupported(e,t){let n=this.iframes[e._key()];n.send(tq,{type:tq},n=>{var r;let i=null===(r=null==n?void 0:n[0])||void 0===r?void 0:r[tq];void 0!==i&&t(!!i),f(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){let t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=tA(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return el()||et()||eo()}};class tK{constructor(e){this.factorId=e}_process(e,t,n){switch(t.type){case"enroll":return this._finalizeEnroll(e,t.credential,n);case"signin":return this._finalizeSignIn(e,t.credential);default:return _("unexpected MultiFactorSessionType")}}}class tY extends tK{constructor(e){super("phone"),this.credential=e}static _fromCredential(e){return new tY(e)}_finalizeEnroll(e,t,n){return x(e,"POST","/v2/accounts/mfaEnrollment:finalize",D(e,{idToken:t,displayName:n,phoneVerificationInfo:this.credential._makeVerificationRequest()}))}_finalizeSignIn(e,t){return x(e,"POST","/v2/accounts/mfaSignIn:finalize",D(e,{mfaPendingCredential:t,phoneVerificationInfo:this.credential._makeVerificationRequest()}))}}class tH extends tK{constructor(e,t,n){super("totp"),this.otp=e,this.enrollmentId=t,this.secret=n}static _fromSecret(e,t){return new tH(t,void 0,e)}static _fromEnrollmentId(e,t){return new tH(t,e)}async _finalizeEnroll(e,t,n){return y(void 0!==this.secret,e,"argument-error"),x(e,"POST","/v2/accounts/mfaEnrollment:finalize",D(e,{idToken:t,displayName:n,totpVerificationInfo:this.secret._makeTotpVerificationInfo(this.otp)}))}async _finalizeSignIn(e,t){y(void 0!==this.enrollmentId&&void 0!==this.otp,e,"argument-error");let n={verificationCode:this.otp};return x(e,"POST","/v2/accounts/mfaSignIn:finalize",D(e,{mfaPendingCredential:t,mfaEnrollmentId:this.enrollmentId,totpVerificationInfo:n}))}}class tW{constructor(e,t,n,r,i,s,a){this.sessionInfo=s,this.auth=a,this.secretKey=e,this.hashingAlgorithm=t,this.codeLength=n,this.codeIntervalSeconds=r,this.enrollmentCompletionDeadline=i}static _fromStartTotpMfaEnrollmentResponse(e,t){return new tW(e.totpSessionInfo.sharedSecretKey,e.totpSessionInfo.hashingAlgorithm,e.totpSessionInfo.verificationCodeLength,e.totpSessionInfo.periodSec,new Date(e.totpSessionInfo.finalizeEnrollmentTime).toUTCString(),e.totpSessionInfo.sessionInfo,t)}_makeTotpVerificationInfo(e){return{sessionInfo:this.sessionInfo,verificationCode:e}}generateQrCodeUrl(e,t){var n;let r=!1;return(tQ(e)||tQ(t))&&(r=!0),r&&(tQ(e)&&(e=(null===(n=this.auth.currentUser)||void 0===n?void 0:n.email)||"unknownuser"),tQ(t)&&(t=this.auth.name)),`otpauth://totp/${t}:${e}?secret=${this.secretKey}&issuer=${t}&algorithm=${this.hashingAlgorithm}&digits=${this.codeLength}`}}function tQ(e){return void 0===e||(null==e?void 0:e.length)===0}var tX="@firebase/auth",tJ="0.23.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ class tZ{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),(null===(e=this.auth.currentUser)||void 0===e?void 0:e.uid)||null}async getToken(e){if(this.assertAuthConfigured(),await this.auth._initializationPromise,!this.auth.currentUser)return null;let t=await this.auth.currentUser.getIdToken(e);return{accessToken:t}}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;let t=this.auth.onIdTokenChanged(t=>{e((null==t?void 0:t.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();let t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){y(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}let t0=(0,i.Pz)("authIdTokenMaxAge")||300,t1=null,t2=e=>async t=>{let n=t&&await t.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>t0)return;let i=null==n?void 0:n.token;t1!==i&&(t1=i,await fetch(e,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function t4(e=(0,s.Mq)()){let t=(0,s.qX)(e,"auth");if(t.isInitialized())return t.getImmediate();let n=/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ function(e,t){let n=(0,s.qX)(e,"auth");if(n.isInitialized()){let r=n.getImmediate(),a=n.getOptions();if((0,i.vZ)(a,null!=t?t:{}))return r;f(r,"already-initialized")}let o=n.initialize({options:t});return o}(e,{popupRedirectResolver:tz,persistence:[tu,e2,e4]}),r=(0,i.Pz)("authTokenSyncURL");if(r){var a,o;let l=t2(r);a=()=>l(n.currentUser),(0,i.m9)(n).beforeAuthStateChanged(l,a),o=e=>l(e),(0,i.m9)(n).onIdTokenChanged(o,void 0,void 0)}let u=(0,i.q4)("auth");return u&&function(e,t,n){let r=ev(e);y(r._canInitEmulator,r,"emulator-config-failed"),y(/^https?:\/\//.test(t),r,"invalid-emulator-scheme");let i=!!(null==n?void 0:n.disableWarnings),s=eb(t),{host:a,port:o}=function(e){let t=eb(e),n=/(\/\/)?([^?#/]+)/.exec(e.substr(t.length));if(!n)return{host:"",port:null};let r=n[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){let s=i[1];return{host:s,port:eE(r.substr(s.length+1))}}{let[a,o]=r.split(":");return{host:a,port:eE(o)}}}(t),l=null===o?"":`:${o}`;r.config.emulator={url:`${s}//${a}${l}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:a,port:o,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})}),i||function(){function e(){let e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}"undefined"!=typeof console&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),"undefined"!=typeof window&&"undefined"!=typeof document&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",e):e())}()}(n,`http://${u}`),n}r="Browser",(0,s.Xd)(new l.wA("auth",(e,{options:t})=>{let n=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:a,authDomain:o}=n.options;y(a&&!a.includes(":"),"invalid-api-key",{appName:n.name}),y(!(null==o?void 0:o.includes(":")),"argument-error",{appName:n.name});let l={apiKey:a,authDomain:o,clientPlatform:r,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:eu(r)},u=new e_(n,i,s,l);return function(e,t){let n=(null==t?void 0:t.persistence)||[],r=(Array.isArray(n)?n:[n]).map(W);(null==t?void 0:t.errorMap)&&e._updateErrorMap(t.errorMap),e._initializeWithPersistence(r,null==t?void 0:t.popupRedirectResolver)}(u,t),u},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,n)=>{let r=e.getProvider("auth-internal");r.initialize()})),(0,s.Xd)(new l.wA("auth-internal",e=>{let t=ev(e.getProvider("auth").getImmediate());return new tZ(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),(0,s.KN)(tX,tJ,/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ function(e){switch(e){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}(r)),(0,s.KN)(tX,tJ,"esm2017")},6100:function(e,t,n){"use strict";n.d(t,{ET:function(){return he},hJ:function(){return u7},oe:function(){return c8},JU:function(){return u8},ST:function(){return ca},Yp:function(){return hi},QT:function(){return c9},PL:function(){return c5},ad:function(){return cr},b9:function(){return cz},cf:function(){return ht},Xo:function(){return cG},IO:function(){return cF},pl:function(){return c3},TQ:function(){return cY},r7:function(){return c7},ar:function(){return cB}});var r,i,s,a,o,l,u,c,h=n(7456),d=n(8463),f=n(3333),p=n(4444),m="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},g={},y=y||{},_=m||self;function v(){}function w(e){var t=typeof e;return"array"==(t="object"!=t?t:e?Array.isArray(e)?"array":t:"null")||"object"==t&&"number"==typeof e.length}function b(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}function E(e,t,n){return e.call.apply(e.bind,arguments)}function I(e,t,n){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),e.apply(t,n)}}return function(){return e.apply(t,arguments)}}function S(e,t,n){return(S=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?E:I).apply(null,arguments)}function T(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function D(e,t){function n(){}n.prototype=t.prototype,e.$=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.ac=function(e,n,r){for(var i=Array(arguments.length-2),s=2;s<arguments.length;s++)i[s-2]=arguments[s];return t.prototype[n].apply(e,i)}}function x(){this.s=this.s,this.o=this.o}x.prototype.s=!1,x.prototype.ra=function(){this.s||(this.s=!0,this.N())},x.prototype.N=function(){if(this.o)for(;this.o.length;)this.o.shift()()};let k=Array.prototype.indexOf?function(e,t){return Array.prototype.indexOf.call(e,t,void 0)}:function(e,t){if("string"==typeof e)return"string"!=typeof t||1!=t.length?-1:e.indexOf(t,0);for(let n=0;n<e.length;n++)if(n in e&&e[n]===t)return n;return -1};function C(e){let t=e.length;if(0<t){let n=Array(t);for(let r=0;r<t;r++)n[r]=e[r];return n}return[]}function N(e,t){for(let n=1;n<arguments.length;n++){let r=arguments[n];if(w(r)){let i=e.length||0,s=r.length||0;e.length=i+s;for(let a=0;a<s;a++)e[i+a]=r[a]}else e.push(r)}}function R(e,t){this.type=e,this.g=this.target=t,this.defaultPrevented=!1}R.prototype.h=function(){this.defaultPrevented=!0};var A=function(){if(!_.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{_.addEventListener("test",v,t),_.removeEventListener("test",v,t)}catch(n){}return e}();function O(e){return/^[\s\xa0]*$/.test(e)}var P=String.prototype.trim?function(e){return e.trim()}:function(e){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(e)[1]};function L(e,t){return e<t?-1:e>t?1:0}function M(){var e=_.navigator;return e&&(e=e.userAgent)?e:""}function U(e){return -1!=M().indexOf(e)}function F(e){return F[" "](e),e}function j(e,t,n){return Object.prototype.hasOwnProperty.call(e,t)?e[t]:e[t]=n(t)}F[" "]=v;var B=U("Opera"),$=U("Trident")||U("MSIE"),V=U("Edge"),G=V||$,q=U("Gecko")&&!(-1!=M().toLowerCase().indexOf("webkit")&&!U("Edge"))&&!(U("Trident")||U("MSIE"))&&!U("Edge"),z=-1!=M().toLowerCase().indexOf("webkit")&&!U("Edge");function K(){var e=_.document;return e?e.documentMode:void 0}e:{var Y,H="",W=(Y=M(),q?/rv:([^\);]+)(\)|;)/.exec(Y):V?/Edge\/([\d\.]+)/.exec(Y):$?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(Y):z?/WebKit\/(\S+)/.exec(Y):B?/(?:Version)[ \/]?(\S+)/.exec(Y):void 0);if(W&&(H=W?W[1]:""),$){var Q=K();if(null!=Q&&Q>parseFloat(H)){i=String(Q);break e}}i=H}var X={},J=_.document&&$&&(K()||parseInt(i,10))||void 0;function Z(e,t){if(R.call(this,e?e.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,e){var n=this.type=e.type,r=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.g=t,t=e.relatedTarget){if(q){e:{try{F(t.nodeName);var i=!0;break e}catch(s){}i=!1}i||(t=null)}}else"mouseover"==n?t=e.fromElement:"mouseout"==n&&(t=e.toElement);this.relatedTarget=t,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType="string"==typeof e.pointerType?e.pointerType:ee[e.pointerType]||"",this.state=e.state,this.i=e,e.defaultPrevented&&Z.$.h.call(this)}}D(Z,R);var ee={2:"touch",3:"pen",4:"mouse"};Z.prototype.h=function(){Z.$.h.call(this);var e=this.i;e.preventDefault?e.preventDefault():e.returnValue=!1};var et="closure_listenable_"+(1e6*Math.random()|0),en=0;function er(e,t,n,r,i){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!r,this.la=i,this.key=++en,this.fa=this.ia=!1}function ei(e){e.fa=!0,e.listener=null,e.proxy=null,e.src=null,e.la=null}function es(e,t,n){for(let r in e)t.call(n,e[r],r,e)}function ea(e){let t={};for(let n in e)t[n]=e[n];return t}let eo="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function el(e,t){let n,r;for(let i=1;i<arguments.length;i++){for(n in r=arguments[i])e[n]=r[n];for(let s=0;s<eo.length;s++)n=eo[s],Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}}function eu(e){this.src=e,this.g={},this.h=0}function ec(e,t){var n=t.type;if(n in e.g){var r,i=e.g[n],s=k(i,t);(r=0<=s)&&Array.prototype.splice.call(i,s,1),r&&(ei(t),0==e.g[n].length&&(delete e.g[n],e.h--))}}function eh(e,t,n,r){for(var i=0;i<e.length;++i){var s=e[i];if(!s.fa&&s.listener==t&&!!n==s.capture&&s.la==r)return i}return -1}eu.prototype.add=function(e,t,n,r,i){var s=e.toString();(e=this.g[s])||(e=this.g[s]=[],this.h++);var a=eh(e,t,r,i);return -1<a?(t=e[a],n||(t.ia=!1)):((t=new er(t,this.src,s,!!r,i)).ia=n,e.push(t)),t};var ed="closure_lm_"+(1e6*Math.random()|0),ef={};function ep(e,t,n,r,i,s){if(!t)throw Error("Invalid event type");var a=b(i)?!!i.capture:!!i,o=e_(e);if(o||(e[ed]=o=new eu(e)),(n=o.add(t,n,r,a,s)).proxy)return n;if(r=function e(t){return ey.call(e.src,e.listener,t)},n.proxy=r,r.src=e,r.listener=n,e.addEventListener)A||(i=a),void 0===i&&(i=!1),e.addEventListener(t.toString(),r,i);else if(e.attachEvent)e.attachEvent(eg(t.toString()),r);else if(e.addListener&&e.removeListener)e.addListener(r);else throw Error("addEventListener and attachEvent are unavailable.");return n}function em(e){if("number"!=typeof e&&e&&!e.fa){var t=e.src;if(t&&t[et])ec(t.i,e);else{var n=e.type,r=e.proxy;t.removeEventListener?t.removeEventListener(n,r,e.capture):t.detachEvent?t.detachEvent(eg(n),r):t.addListener&&t.removeListener&&t.removeListener(r),(n=e_(t))?(ec(n,e),0==n.h&&(n.src=null,t[ed]=null)):ei(e)}}}function eg(e){return e in ef?ef[e]:ef[e]="on"+e}function ey(e,t){if(e.fa)e=!0;else{t=new Z(t,this);var n=e.listener,r=e.la||e.src;e.ia&&em(e),e=n.call(r,t)}return e}function e_(e){return(e=e[ed])instanceof eu?e:null}var ev="__closure_events_fn_"+(1e9*Math.random()>>>0);function ew(e){return"function"==typeof e?e:(e[ev]||(e[ev]=function(t){return e.handleEvent(t)}),e[ev])}function eb(){x.call(this),this.i=new eu(this),this.S=this,this.J=null}function eE(e,t){var n,r=e.J;if(r)for(n=[];r;r=r.J)n.push(r);if(e=e.S,r=t.type||t,"string"==typeof t)t=new R(t,e);else if(t instanceof R)t.target=t.target||e;else{var i=t;el(t=new R(r,e),i)}if(i=!0,n)for(var s=n.length-1;0<=s;s--){var a=t.g=n[s];i=eI(a,r,!0,t)&&i}if(i=eI(a=t.g=e,r,!0,t)&&i,i=eI(a,r,!1,t)&&i,n)for(s=0;s<n.length;s++)i=eI(a=t.g=n[s],r,!1,t)&&i}function eI(e,t,n,r){if(!(t=e.i.g[String(t)]))return!0;t=t.concat();for(var i=!0,s=0;s<t.length;++s){var a=t[s];if(a&&!a.fa&&a.capture==n){var o=a.listener,l=a.la||a.src;a.ia&&ec(e.i,a),i=!1!==o.call(l,r)&&i}}return i&&!r.defaultPrevented}D(eb,x),eb.prototype[et]=!0,eb.prototype.removeEventListener=function(e,t,n,r){!function e(t,n,r,i,s){if(Array.isArray(n))for(var a=0;a<n.length;a++)e(t,n[a],r,i,s);else(i=b(i)?!!i.capture:!!i,r=ew(r),t&&t[et])?(t=t.i,(n=String(n).toString())in t.g&&-1<(r=eh(a=t.g[n],r,i,s))&&(ei(a[r]),Array.prototype.splice.call(a,r,1),0==a.length&&(delete t.g[n],t.h--))):t&&(t=e_(t))&&(n=t.g[n.toString()],t=-1,n&&(t=eh(n,r,i,s)),(r=-1<t?n[t]:null)&&em(r))}(this,e,t,n,r)},eb.prototype.N=function(){if(eb.$.N.call(this),this.i){var e,t=this.i;for(e in t.g){for(var n=t.g[e],r=0;r<n.length;r++)ei(n[r]);delete t.g[e],t.h--}}this.J=null},eb.prototype.O=function(e,t,n,r){return this.i.add(String(e),t,!1,n,r)},eb.prototype.P=function(e,t,n,r){return this.i.add(String(e),t,!0,n,r)};var eS=_.JSON.stringify,eT=new class{constructor(e,t){this.i=e,this.j=t,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}(()=>new eD,e=>e.reset());class eD{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}function ex(e,t){var n;a||(n=_.Promise.resolve(void 0),a=function(){n.then(eN)}),ek||(a(),ek=!0),eC.add(e,t)}var ek=!1,eC=new class{constructor(){this.h=this.g=null}add(e,t){let n=eT.get();n.set(e,t),this.h?this.h.next=n:this.g=n,this.h=n}};function eN(){let e;for(;e=null,(n=eC).g&&(e=n.g,n.g=n.g.next,n.g||(n.h=null),e.next=null),r=e;){try{r.h.call(r.g)}catch(t){!function(e){_.setTimeout(()=>{throw e},0)}(t)}var n,r,i=eT;i.j(r),100>i.h&&(i.h++,r.next=i.g,i.g=r)}ek=!1}function eR(e,t){eb.call(this),this.h=e||1,this.g=t||_,this.j=S(this.qb,this),this.l=Date.now()}function eA(e){e.ga=!1,e.T&&(e.g.clearTimeout(e.T),e.T=null)}function eO(e,t,n){if("function"==typeof e)n&&(e=S(e,n));else if(e&&"function"==typeof e.handleEvent)e=S(e.handleEvent,e);else throw Error("Invalid listener argument");return 2147483647<Number(t)?-1:_.setTimeout(e,t||0)}D(eR,eb),(c=eR.prototype).ga=!1,c.T=null,c.qb=function(){if(this.ga){var e=Date.now()-this.l;0<e&&e<.8*this.h?this.T=this.g.setTimeout(this.j,this.h-e):(this.T&&(this.g.clearTimeout(this.T),this.T=null),eE(this,"tick"),this.ga&&(eA(this),this.start()))}},c.start=function(){this.ga=!0,this.T||(this.T=this.g.setTimeout(this.j,this.h),this.l=Date.now())},c.N=function(){eR.$.N.call(this),eA(this),delete this.g};class eP extends x{constructor(e,t){super(),this.m=e,this.j=t,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:function e(t){t.g=eO(()=>{t.g=null,t.i&&(t.i=!1,e(t))},t.j);let n=t.h;t.h=null,t.m.apply(null,n)}(this)}N(){super.N(),this.g&&(_.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function eL(e){x.call(this),this.h=e,this.g={}}D(eL,x);var eM=[];function eU(e,t,n,r){Array.isArray(n)||(n&&(eM[0]=n.toString()),n=eM);for(var i=0;i<n.length;i++){var s=function e(t,n,r,i,s){if(i&&i.once)return function e(t,n,r,i,s){if(Array.isArray(n)){for(var a=0;a<n.length;a++)e(t,n[a],r,i,s);return null}return r=ew(r),t&&t[et]?t.P(n,r,b(i)?!!i.capture:!!i,s):ep(t,n,r,!0,i,s)}(t,n,r,i,s);if(Array.isArray(n)){for(var a=0;a<n.length;a++)e(t,n[a],r,i,s);return null}return r=ew(r),t&&t[et]?t.O(n,r,b(i)?!!i.capture:!!i,s):ep(t,n,r,!1,i,s)}(t,n[i],r||e.handleEvent,!1,e.h||e);if(!s)break;e.g[s.key]=s}}function eF(e){es(e.g,function(e,t){this.g.hasOwnProperty(t)&&em(e)},e),e.g={}}function ej(){this.g=!0}function eB(e,t,n,r){e.info(function(){return"XMLHTTP TEXT ("+t+"): "+function(e,t){if(!e.g)return t;if(!t)return null;try{var n=JSON.parse(t);if(n){for(e=0;e<n.length;e++)if(Array.isArray(n[e])){var r=n[e];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var s=i[0];if("noop"!=s&&"stop"!=s&&"close"!=s)for(var a=1;a<i.length;a++)i[a]=""}}}}return eS(n)}catch(o){return t}}(e,n)+(r?" "+r:"")})}eL.prototype.N=function(){eL.$.N.call(this),eF(this)},eL.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},ej.prototype.Ea=function(){this.g=!1},ej.prototype.info=function(){};var e$={},eV=null;function eG(){return eV=eV||new eb}function eq(e){R.call(this,e$.Ta,e)}function ez(e){let t=eG();eE(t,new eq(t))}function eK(e,t){R.call(this,e$.STAT_EVENT,e),this.stat=t}function eY(e){let t=eG();eE(t,new eK(t,e))}function eH(e,t){R.call(this,e$.Ua,e),this.size=t}function eW(e,t){if("function"!=typeof e)throw Error("Fn must not be null and must be a function");return _.setTimeout(function(){e()},t)}e$.Ta="serverreachability",D(eq,R),e$.STAT_EVENT="statevent",D(eK,R),e$.Ua="timingevent",D(eH,R);var eQ={NO_ERROR:0,rb:1,Eb:2,Db:3,yb:4,Cb:5,Fb:6,Qa:7,TIMEOUT:8,Ib:9},eX={wb:"complete",Sb:"success",Ra:"error",Qa:"abort",Kb:"ready",Lb:"readystatechange",TIMEOUT:"timeout",Gb:"incrementaldata",Jb:"progress",zb:"downloadprogress",$b:"uploadprogress"};function eJ(){}function eZ(e){return e.h||(e.h=e.i())}function e0(){}eJ.prototype.h=null;var e1={OPEN:"a",vb:"b",Ra:"c",Hb:"d"};function e2(){R.call(this,"d")}function e4(){R.call(this,"c")}function e9(){}function e6(e,t,n,r){this.l=e,this.j=t,this.m=n,this.W=r||1,this.U=new eL(this),this.P=e3,e=G?125:void 0,this.V=new eR(e),this.I=null,this.i=!1,this.s=this.A=this.v=this.L=this.G=this.Y=this.B=null,this.F=[],this.g=null,this.C=0,this.o=this.u=null,this.aa=-1,this.J=!1,this.O=0,this.M=null,this.ca=this.K=this.ba=this.S=!1,this.h=new e5}function e5(){this.i=null,this.g="",this.h=!1}D(e2,R),D(e4,R),D(e9,eJ),e9.prototype.g=function(){return new XMLHttpRequest},e9.prototype.i=function(){return{}},o=new e9;var e3=45e3,e7={},e8={};function te(e,t,n){e.L=1,e.v=t_(tf(t)),e.s=n,e.S=!0,tt(e,null)}function tt(e,t){e.G=Date.now(),ti(e),e.A=tf(e.v);var n=e.A,r=e.W;Array.isArray(r)||(r=[String(r)]),tR(n.i,"t",r),e.C=0,n=e.l.I,e.h=new e5,e.g=nw(e.l,n?t:null,!e.s),0<e.O&&(e.M=new eP(S(e.Pa,e,e.g),e.O)),eU(e.U,e.g,"readystatechange",e.nb),t=e.I?ea(e.I):{},e.s?(e.u||(e.u="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.g.ha(e.A,e.u,e.s,t)):(e.u="GET",e.g.ha(e.A,e.u,null,t)),ez(),function(e,t,n,r,i,s){e.info(function(){if(e.g){if(s)for(var a="",o=s.split("&"),l=0;l<o.length;l++){var u=o[l].split("=");if(1<u.length){var c=u[0];u=u[1];var h=c.split("_");a=2<=h.length&&"type"==h[1]?a+(c+"=")+u+"&":a+(c+"=redacted&")}}else a=null}else a=s;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+t+"\n"+n+"\n"+a})}(e.j,e.u,e.A,e.m,e.W,e.s)}function tn(e){return!!e.g&&"GET"==e.u&&2!=e.L&&e.l.Ha}function tr(e,t,n){let r=!0,i;for(;!e.J&&e.C<n.length;)if((i=function(e,t){var n=e.C,r=t.indexOf("\n",n);return -1==r?e8:isNaN(n=Number(t.substring(n,r)))?e7:(r+=1)+n>t.length?e8:(t=t.substr(r,n),e.C=r+n,t)}(e,n))==e8){4==t&&(e.o=4,eY(14),r=!1),eB(e.j,e.m,null,"[Incomplete Response]");break}else if(i==e7){e.o=4,eY(15),eB(e.j,e.m,n,"[Invalid Chunk]"),r=!1;break}else eB(e.j,e.m,i,null),tu(e,i);tn(e)&&i!=e8&&i!=e7&&(e.h.g="",e.C=0),4!=t||0!=n.length||e.h.h||(e.o=1,eY(16),r=!1),e.i=e.i&&r,r?0<n.length&&!e.ca&&(e.ca=!0,(t=e.l).g==e&&t.ca&&!t.L&&(t.j.info("Great, no buffering proxy detected. Bytes received: "+n.length),nd(t),t.L=!0,eY(11))):(eB(e.j,e.m,n,"[Invalid Chunked Response]"),tl(e),to(e))}function ti(e){e.Y=Date.now()+e.P,ts(e,e.P)}function ts(e,t){if(null!=e.B)throw Error("WatchDog timer not null");e.B=eW(S(e.lb,e),t)}function ta(e){e.B&&(_.clearTimeout(e.B),e.B=null)}function to(e){0==e.l.H||e.J||nm(e.l,e)}function tl(e){ta(e);var t=e.M;t&&"function"==typeof t.ra&&t.ra(),e.M=null,eA(e.V),eF(e.U),e.g&&(t=e.g,e.g=null,t.abort(),t.ra())}function tu(e,t){try{var n=e.l;if(0!=n.H&&(n.g==e||tF(n.h,e))){if(!e.K&&tF(n.h,e)&&3==n.H){try{var r=n.Ja.g.parse(t)}catch(i){r=null}if(Array.isArray(r)&&3==r.length){var s=r;if(0==s[0]){e:if(!n.u){if(n.g){if(n.g.G+3e3<e.G)np(n),ni(n);else break e}nh(n),eY(18)}}else n.Fa=s[1],0<n.Fa-n.V&&37500>s[2]&&n.M&&0==n.A&&!n.v&&(n.v=eW(S(n.ib,n),6e3));if(1>=tU(n.h)&&n.na){try{n.na()}catch(a){}n.na=void 0}}else ny(n,11)}else if((e.K||n.g==e)&&np(n),!O(t))for(s=n.Ja.g.parse(t),t=0;t<s.length;t++){let o=s[t];if(n.V=o[0],o=o[1],2==n.H){if("c"==o[0]){n.J=o[1],n.oa=o[2];let l=o[3];null!=l&&(n.qa=l,n.j.info("VER="+n.qa));let u=o[4];null!=u&&(n.Ga=u,n.j.info("SVER="+n.Ga));let c=o[5];null!=c&&"number"==typeof c&&0<c&&(r=1.5*c,n.K=r,n.j.info("backChannelRequestTimeoutMs_="+r)),r=n;let h=e.g;if(h){let d=h.g?h.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(d){var f=r.h;f.g||-1==d.indexOf("spdy")&&-1==d.indexOf("quic")&&-1==d.indexOf("h2")||(f.j=f.l,f.g=new Set,f.h&&(tj(f,f.h),f.h=null))}if(r.F){let p=h.g?h.g.getResponseHeader("X-HTTP-Session-Id"):null;p&&(r.Da=p,ty(r.G,r.F,p))}}if(n.H=3,n.l&&n.l.Ba(),n.ca&&(n.S=Date.now()-e.G,n.j.info("Handshake RTT: "+n.S+"ms")),(r=n).wa=nv(r,r.I?r.oa:null,r.Y),e.K){tB(r.h,e);var m=r.K;m&&e.setTimeout(m),e.B&&(ta(e),ti(e)),r.g=e}else nc(r);0<n.i.length&&na(n)}else"stop"!=o[0]&&"close"!=o[0]||ny(n,7)}else 3==n.H&&("stop"==o[0]||"close"==o[0]?"stop"==o[0]?ny(n,7):nr(n):"noop"!=o[0]&&n.l&&n.l.Aa(o),n.A=0)}}ez(4)}catch(g){}}function tc(e,t){if(e.forEach&&"function"==typeof e.forEach)e.forEach(t,void 0);else if(w(e)||"string"==typeof e)Array.prototype.forEach.call(e,t,void 0);else for(var n=function(e){if(e.sa&&"function"==typeof e.sa)return e.sa();if(!e.Z||"function"!=typeof e.Z){if("undefined"!=typeof Map&&e instanceof Map)return Array.from(e.keys());if(!("undefined"!=typeof Set&&e instanceof Set)){if(w(e)||"string"==typeof e){var t=[];e=e.length;for(var n=0;n<e;n++)t.push(n);return t}for(let r in t=[],n=0,e)t[n++]=r;return t}}}(e),r=function(e){if(e.Z&&"function"==typeof e.Z)return e.Z();if("undefined"!=typeof Map&&e instanceof Map||"undefined"!=typeof Set&&e instanceof Set)return Array.from(e.values());if("string"==typeof e)return e.split("");if(w(e)){for(var t=[],n=e.length,r=0;r<n;r++)t.push(e[r]);return t}for(r in t=[],n=0,e)t[n++]=e[r];return t}(e),i=r.length,s=0;s<i;s++)t.call(void 0,r[s],n&&n[s],e)}(c=e6.prototype).setTimeout=function(e){this.P=e},c.nb=function(e){e=e.target;let t=this.M;t&&3==t3(e)?t.l():this.Pa(e)},c.Pa=function(e){try{if(e==this.g)e:{let t=t3(this.g);var n=this.g.Ia();let r=this.g.da();if(!(3>t)&&(3!=t||G||this.g&&(this.h.h||this.g.ja()||t7(this.g)))){this.J||4!=t||7==n||(8==n||0>=r?ez(3):ez(2)),ta(this);var i=this.g.da();this.aa=i;t:if(tn(this)){var s=t7(this.g);e="";var a=s.length,o=4==t3(this.g);if(!this.h.i){if("undefined"==typeof TextDecoder){tl(this),to(this);var l="";break t}this.h.i=new _.TextDecoder}for(n=0;n<a;n++)this.h.h=!0,e+=this.h.i.decode(s[n],{stream:o&&n==a-1});s.splice(0,a),this.h.g+=e,this.C=0,l=this.h.g}else l=this.g.ja();if(this.i=200==i,function(e,t,n,r,i,s,a){e.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+t+"\n"+n+"\n"+s+" "+a})}(this.j,this.u,this.A,this.m,this.W,t,i),this.i){if(this.ba&&!this.K){t:{if(this.g){var u,c=this.g;if((u=c.g?c.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!O(u)){var h=u;break t}}h=null}if(i=h)eB(this.j,this.m,i,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,tu(this,i);else{this.i=!1,this.o=3,eY(12),tl(this),to(this);break e}}this.S?(tr(this,t,l),G&&this.i&&3==t&&(eU(this.U,this.V,"tick",this.mb),this.V.start())):(eB(this.j,this.m,l,null),tu(this,l)),4==t&&tl(this),this.i&&!this.J&&(4==t?nm(this.l,this):(this.i=!1,ti(this)))}else 400==i&&0<l.indexOf("Unknown SID")?(this.o=3,eY(12)):(this.o=0,eY(13)),tl(this),to(this)}}}catch(d){}finally{}},c.mb=function(){if(this.g){var e=t3(this.g),t=this.g.ja();this.C<t.length&&(ta(this),tr(this,e,t),this.i&&4!=e&&ti(this))}},c.cancel=function(){this.J=!0,tl(this)},c.lb=function(){this.B=null;let e=Date.now();0<=e-this.Y?(function(e,t){e.info(function(){return"TIMEOUT: "+t})}(this.j,this.A),2!=this.L&&(ez(),eY(17)),tl(this),this.o=2,to(this)):ts(this,this.Y-e)};var th=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function td(e,t){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,e instanceof td){this.h=void 0!==t?t:e.h,tp(this,e.j),this.s=e.s,this.g=e.g,tm(this,e.m),this.l=e.l,t=e.i;var n=new tx;n.i=t.i,t.g&&(n.g=new Map(t.g),n.h=t.h),tg(this,n),this.o=e.o}else e&&(n=String(e).match(th))?(this.h=!!t,tp(this,n[1]||"",!0),this.s=tv(n[2]||""),this.g=tv(n[3]||"",!0),tm(this,n[4]),this.l=tv(n[5]||"",!0),tg(this,n[6]||"",!0),this.o=tv(n[7]||"")):(this.h=!!t,this.i=new tx(null,this.h))}function tf(e){return new td(e)}function tp(e,t,n){e.j=n?tv(t,!0):t,e.j&&(e.j=e.j.replace(/:$/,""))}function tm(e,t){if(t){if(isNaN(t=Number(t))||0>t)throw Error("Bad port number "+t);e.m=t}else e.m=null}function tg(e,t,n){var r,i;t instanceof tx?(e.i=t,r=e.i,(i=e.h)&&!r.j&&(tk(r),r.i=null,r.g.forEach(function(e,t){var n=t.toLowerCase();t!=n&&(tC(this,t),tR(this,n,e))},r)),r.j=i):(n||(t=tw(t,tT)),e.i=new tx(t,e.h))}function ty(e,t,n){e.i.set(t,n)}function t_(e){return ty(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),e}function tv(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function tw(e,t,n){return"string"==typeof e?(e=encodeURI(e).replace(t,tb),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function tb(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}td.prototype.toString=function(){var e=[],t=this.j;t&&e.push(tw(t,tE,!0),":");var n=this.g;return(n||"file"==t)&&(e.push("//"),(t=this.s)&&e.push(tw(t,tE,!0),"@"),e.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.m)&&e.push(":",String(n))),(n=this.l)&&(this.g&&"/"!=n.charAt(0)&&e.push("/"),e.push(tw(n,"/"==n.charAt(0)?tS:tI,!0))),(n=this.i.toString())&&e.push("?",n),(n=this.o)&&e.push("#",tw(n,tD)),e.join("")};var tE=/[#\/\?@]/g,tI=/[#\?:]/g,tS=/[#\?]/g,tT=/[#\?@]/g,tD=/#/g;function tx(e,t){this.h=this.g=null,this.i=e||null,this.j=!!t}function tk(e){e.g||(e.g=new Map,e.h=0,e.i&&function(e,t){if(e){e=e.split("&");for(var n=0;n<e.length;n++){var r=e[n].indexOf("="),i=null;if(0<=r){var s=e[n].substring(0,r);i=e[n].substring(r+1)}else s=e[n];t(s,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(e.i,function(t,n){e.add(decodeURIComponent(t.replace(/\+/g," ")),n)}))}function tC(e,t){tk(e),t=tA(e,t),e.g.has(t)&&(e.i=null,e.h-=e.g.get(t).length,e.g.delete(t))}function tN(e,t){return tk(e),t=tA(e,t),e.g.has(t)}function tR(e,t,n){tC(e,t),0<n.length&&(e.i=null,e.g.set(tA(e,t),C(n)),e.h+=n.length)}function tA(e,t){return t=String(t),e.j&&(t=t.toLowerCase()),t}(c=tx.prototype).add=function(e,t){tk(this),this.i=null,e=tA(this,e);var n=this.g.get(e);return n||this.g.set(e,n=[]),n.push(t),this.h+=1,this},c.forEach=function(e,t){tk(this),this.g.forEach(function(n,r){n.forEach(function(n){e.call(t,n,r,this)},this)},this)},c.sa=function(){tk(this);let e=Array.from(this.g.values()),t=Array.from(this.g.keys()),n=[];for(let r=0;r<t.length;r++){let i=e[r];for(let s=0;s<i.length;s++)n.push(t[r])}return n},c.Z=function(e){tk(this);let t=[];if("string"==typeof e)tN(this,e)&&(t=t.concat(this.g.get(tA(this,e))));else{e=Array.from(this.g.values());for(let n=0;n<e.length;n++)t=t.concat(e[n])}return t},c.set=function(e,t){return tk(this),this.i=null,tN(this,e=tA(this,e))&&(this.h-=this.g.get(e).length),this.g.set(e,[t]),this.h+=1,this},c.get=function(e,t){return e&&0<(e=this.Z(e)).length?String(e[0]):t},c.toString=function(){if(this.i)return this.i;if(!this.g)return"";let e=[],t=Array.from(this.g.keys());for(var n=0;n<t.length;n++){var r=t[n];let i=encodeURIComponent(String(r)),s=this.Z(r);for(r=0;r<s.length;r++){var a=i;""!==s[r]&&(a+="="+encodeURIComponent(String(s[r]))),e.push(a)}}return this.i=e.join("&")};var tO=class{constructor(e,t){this.h=e,this.g=t}};function tP(e){this.l=e||tL,e=_.PerformanceNavigationTiming?0<(e=_.performance.getEntriesByType("navigation")).length&&("hq"==e[0].nextHopProtocol||"h2"==e[0].nextHopProtocol):!!(_.g&&_.g.Ka&&_.g.Ka()&&_.g.Ka().ec),this.j=e?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var tL=10;function tM(e){return!!e.h||!!e.g&&e.g.size>=e.j}function tU(e){return e.h?1:e.g?e.g.size:0}function tF(e,t){return e.h?e.h==t:!!e.g&&e.g.has(t)}function tj(e,t){e.g?e.g.add(t):e.h=t}function tB(e,t){e.h&&e.h==t?e.h=null:e.g&&e.g.has(t)&&e.g.delete(t)}function t$(e){if(null!=e.h)return e.i.concat(e.h.F);if(null!=e.g&&0!==e.g.size){let t=e.i;for(let n of e.g.values())t=t.concat(n.F);return t}return C(e.i)}function tV(){}function tG(){this.g=new tV}function tq(e,t,n,r,i){try{t.onload=null,t.onerror=null,t.onabort=null,t.ontimeout=null,i(r)}catch(s){}}function tz(e){this.l=e.fc||null,this.j=e.ob||!1}function tK(e,t){eb.call(this),this.F=e,this.u=t,this.m=void 0,this.readyState=tY,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}tP.prototype.cancel=function(){if(this.i=t$(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(let e of this.g.values())e.cancel();this.g.clear()}},tV.prototype.stringify=function(e){return _.JSON.stringify(e,void 0)},tV.prototype.parse=function(e){return _.JSON.parse(e,void 0)},D(tz,eJ),tz.prototype.g=function(){return new tK(this.l,this.j)},tz.prototype.i=(r={},function(){return r}),D(tK,eb);var tY=0;function tH(e){e.j.read().then(e.Xa.bind(e)).catch(e.ka.bind(e))}function tW(e){e.readyState=4,e.l=null,e.j=null,e.A=null,tQ(e)}function tQ(e){e.onreadystatechange&&e.onreadystatechange.call(e)}(c=tK.prototype).open=function(e,t){if(this.readyState!=tY)throw this.abort(),Error("Error reopening a connection");this.C=e,this.B=t,this.readyState=1,tQ(this)},c.send=function(e){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;let t={headers:this.v,method:this.C,credentials:this.m,cache:void 0};e&&(t.body=e),(this.F||_).fetch(new Request(this.B,t)).then(this.$a.bind(this),this.ka.bind(this))},c.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,tW(this)),this.readyState=tY},c.$a=function(e){if(this.g&&(this.l=e,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=e.headers,this.readyState=2,tQ(this)),this.g&&(this.readyState=3,tQ(this),this.g))){if("arraybuffer"===this.responseType)e.arrayBuffer().then(this.Ya.bind(this),this.ka.bind(this));else if(void 0!==_.ReadableStream&&"body"in e){if(this.j=e.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;tH(this)}else e.text().then(this.Za.bind(this),this.ka.bind(this))}},c.Xa=function(e){if(this.g){if(this.u&&e.value)this.response.push(e.value);else if(!this.u){var t=e.value?e.value:new Uint8Array(0);(t=this.A.decode(t,{stream:!e.done}))&&(this.response=this.responseText+=t)}e.done?tW(this):tQ(this),3==this.readyState&&tH(this)}},c.Za=function(e){this.g&&(this.response=this.responseText=e,tW(this))},c.Ya=function(e){this.g&&(this.response=e,tW(this))},c.ka=function(){this.g&&tW(this)},c.setRequestHeader=function(e,t){this.v.append(e,t)},c.getResponseHeader=function(e){return this.h&&this.h.get(e.toLowerCase())||""},c.getAllResponseHeaders=function(){if(!this.h)return"";let e=[],t=this.h.entries();for(var n=t.next();!n.done;)e.push((n=n.value)[0]+": "+n[1]),n=t.next();return e.join("\r\n")},Object.defineProperty(tK.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(e){this.m=e?"include":"same-origin"}});var tX=_.JSON.parse;function tJ(e){eb.call(this),this.headers=new Map,this.u=e||null,this.h=!1,this.C=this.g=null,this.I="",this.m=0,this.j="",this.l=this.G=this.v=this.F=!1,this.B=0,this.A=null,this.K=tZ,this.L=this.M=!1}D(tJ,eb);var tZ="",t0=/^https?$/i,t1=["POST","PUT"];function t2(e,t){e.h=!1,e.g&&(e.l=!0,e.g.abort(),e.l=!1),e.j=t,e.m=5,t4(e),t6(e)}function t4(e){e.F||(e.F=!0,eE(e,"complete"),eE(e,"error"))}function t9(e){if(e.h&&void 0!==y&&(!e.C[1]||4!=t3(e)||2!=e.da())){if(e.v&&4==t3(e))eO(e.La,0,e);else if(eE(e,"readystatechange"),4==t3(e)){e.h=!1;try{let t=e.da();e:switch(t){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var n,r,i=!0;break e;default:i=!1}if(!(n=i)){if(r=0===t){var s=String(e.I).match(th)[1]||null;if(!s&&_.self&&_.self.location){var a=_.self.location.protocol;s=a.substr(0,a.length-1)}r=!t0.test(s?s.toLowerCase():"")}n=r}if(n)eE(e,"complete"),eE(e,"success");else{e.m=6;try{var o=2<t3(e)?e.g.statusText:""}catch(l){o=""}e.j=o+" ["+e.da()+"]",t4(e)}}finally{t6(e)}}}}function t6(e,t){if(e.g){t5(e);let n=e.g,r=e.C[0]?v:null;e.g=null,e.C=null,t||eE(e,"ready");try{n.onreadystatechange=r}catch(i){}}}function t5(e){e.g&&e.L&&(e.g.ontimeout=null),e.A&&(_.clearTimeout(e.A),e.A=null)}function t3(e){return e.g?e.g.readyState:0}function t7(e){try{if(!e.g)return null;if("response"in e.g)return e.g.response;switch(e.K){case tZ:case"text":return e.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in e.g)return e.g.mozResponseArrayBuffer}return null}catch(t){return null}}function t8(e){let t="";return es(e,function(e,n){t+=n,t+=":",t+=e,t+="\r\n"}),t}function ne(e,t,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=t8(n),"string"==typeof e?null!=n&&encodeURIComponent(String(n)):ty(e,t,n))}function nt(e,t,n){return n&&n.internalChannelParams&&n.internalChannelParams[e]||t}function nn(e){this.Ga=0,this.i=[],this.j=new ej,this.oa=this.wa=this.G=this.Y=this.g=this.Da=this.F=this.ma=this.o=this.U=this.s=null,this.fb=this.W=0,this.cb=nt("failFast",!1,e),this.M=this.v=this.u=this.m=this.l=null,this.aa=!0,this.ta=this.Fa=this.V=-1,this.ba=this.A=this.C=0,this.ab=nt("baseRetryDelayMs",5e3,e),this.hb=nt("retryDelaySeedMs",1e4,e),this.eb=nt("forwardChannelMaxRetries",2,e),this.xa=nt("forwardChannelRequestTimeoutMs",2e4,e),this.va=e&&e.xmlHttpFactory||void 0,this.Ha=e&&e.dc||!1,this.K=void 0,this.I=e&&e.supportsCrossDomainXhr||!1,this.J="",this.h=new tP(e&&e.concurrentRequestLimit),this.Ja=new tG,this.P=e&&e.fastHandshake||!1,this.O=e&&e.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.bb=e&&e.bc||!1,e&&e.Ea&&this.j.Ea(),e&&e.forceLongPolling&&(this.aa=!1),this.ca=!this.P&&this.aa&&e&&e.detectBufferingProxy||!1,this.na=void 0,this.S=0,this.L=!1,this.pa=this.B=null}function nr(e){if(ns(e),3==e.H){var t=e.W++,n=tf(e.G);ty(n,"SID",e.J),ty(n,"RID",t),ty(n,"TYPE","terminate"),nl(e,n),(t=new e6(e,e.j,t,void 0)).L=2,t.v=t_(tf(n)),n=!1,_.navigator&&_.navigator.sendBeacon&&(n=_.navigator.sendBeacon(t.v.toString(),"")),!n&&_.Image&&((new Image).src=t.v,n=!0),n||(t.g=nw(t.l,null),t.g.ha(t.v)),t.G=Date.now(),ti(t)}n_(e)}function ni(e){e.g&&(nd(e),e.g.cancel(),e.g=null)}function ns(e){ni(e),e.u&&(_.clearTimeout(e.u),e.u=null),np(e),e.h.cancel(),e.m&&("number"==typeof e.m&&_.clearTimeout(e.m),e.m=null)}function na(e){tM(e.h)||e.m||(e.m=!0,ex(e.Na,e),e.C=0)}function no(e,t){var n;n=t?t.m:e.W++;let r=tf(e.G);ty(r,"SID",e.J),ty(r,"RID",n),ty(r,"AID",e.V),nl(e,r),e.o&&e.s&&ne(r,e.o,e.s),n=new e6(e,e.j,n,e.C+1),null===e.o&&(n.I=e.s),t&&(e.i=t.F.concat(e.i)),t=nu(e,n,1e3),n.setTimeout(Math.round(.5*e.xa)+Math.round(.5*e.xa*Math.random())),tj(e.h,n),te(n,r,t)}function nl(e,t){e.ma&&es(e.ma,function(e,n){ty(t,n,e)}),e.l&&tc({},function(e,n){ty(t,n,e)})}function nu(e,t,n){n=Math.min(e.i.length,n);var r=e.l?S(e.l.Va,e.l,e):null;e:{var i=e.i;let s=-1;for(;;){let a=["count="+n];-1==s?0<n?(s=i[0].h,a.push("ofs="+s)):s=0:a.push("ofs="+s);let o=!0;for(let l=0;l<n;l++){let u=i[l].h,c=i[l].g;if(0>(u-=s))s=Math.max(0,i[l].h-100),o=!1;else try{!function(e,t,n){let r=n||"";try{tc(e,function(e,n){let i=e;b(e)&&(i=eS(e)),t.push(r+n+"="+encodeURIComponent(i))})}catch(i){throw t.push(r+"type="+encodeURIComponent("_badmap")),i}}(c,a,"req"+u+"_")}catch(h){r&&r(c)}}if(o){r=a.join("&");break e}}}return e=e.i.splice(0,n),t.F=e,r}function nc(e){e.g||e.u||(e.ba=1,ex(e.Ma,e),e.A=0)}function nh(e){return!e.g&&!e.u&&!(3<=e.A)&&(e.ba++,e.u=eW(S(e.Ma,e),ng(e,e.A)),e.A++,!0)}function nd(e){null!=e.B&&(_.clearTimeout(e.B),e.B=null)}function nf(e){e.g=new e6(e,e.j,"rpc",e.ba),null===e.o&&(e.g.I=e.s),e.g.O=0;var t=tf(e.wa);ty(t,"RID","rpc"),ty(t,"SID",e.J),ty(t,"CI",e.M?"0":"1"),ty(t,"AID",e.V),ty(t,"TYPE","xmlhttp"),nl(e,t),e.o&&e.s&&ne(t,e.o,e.s),e.K&&e.g.setTimeout(e.K);var n=e.g;e=e.oa,n.L=1,n.v=t_(tf(t)),n.s=null,n.S=!0,tt(n,e)}function np(e){null!=e.v&&(_.clearTimeout(e.v),e.v=null)}function nm(e,t){var n=null;if(e.g==t){np(e),nd(e),e.g=null;var r=2}else{if(!tF(e.h,t))return;n=t.F,tB(e.h,t),r=1}if(0!=e.H){if(e.ta=t.aa,t.i){if(1==r){n=t.s?t.s.length:0,t=Date.now()-t.G;var i,s,a=e.C;eE(r=eG(),new eH(r,n)),na(e)}else nc(e)}else if(3==(a=t.o)||0==a&&0<e.ta||!(1==r&&(i=e,s=t,!(tU(i.h)>=i.h.j-(i.m?1:0))&&(i.m?(i.i=s.F.concat(i.i),!0):1!=i.H&&2!=i.H&&!(i.C>=(i.cb?0:i.eb))&&(i.m=eW(S(i.Na,i,s),ng(i,i.C)),i.C++,!0)))||2==r&&nh(e)))switch(n&&0<n.length&&((t=e.h).i=t.i.concat(n)),a){case 1:ny(e,5);break;case 4:ny(e,10);break;case 3:ny(e,6);break;default:ny(e,2)}}}function ng(e,t){let n=e.ab+Math.floor(Math.random()*e.hb);return e.l||(n*=2),n*t}function ny(e,t){if(e.j.info("Error code "+t),2==t){var n=null;e.l&&(n=null);var r=S(e.pb,e);n||(n=new td("//www.google.com/images/cleardot.gif"),_.location&&"http"==_.location.protocol||tp(n,"https"),t_(n)),function(e,t){let n=new ej;if(_.Image){let r=new Image;r.onload=T(tq,n,r,"TestLoadImage: loaded",!0,t),r.onerror=T(tq,n,r,"TestLoadImage: error",!1,t),r.onabort=T(tq,n,r,"TestLoadImage: abort",!1,t),r.ontimeout=T(tq,n,r,"TestLoadImage: timeout",!1,t),_.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=e}else t(!1)}(n.toString(),r)}else eY(2);e.H=0,e.l&&e.l.za(t),n_(e),ns(e)}function n_(e){if(e.H=0,e.pa=[],e.l){let t=t$(e.h);(0!=t.length||0!=e.i.length)&&(N(e.pa,t),N(e.pa,e.i),e.h.i.length=0,C(e.i),e.i.length=0),e.l.ya()}}function nv(e,t,n){var r=n instanceof td?tf(n):new td(n,void 0);if(""!=r.g)t&&(r.g=t+"."+r.g),tm(r,r.m);else{var i=_.location;r=i.protocol,t=t?t+"."+i.hostname:i.hostname,i=+i.port;var s=new td(null,void 0);r&&tp(s,r),t&&(s.g=t),i&&tm(s,i),n&&(s.l=n),r=s}return n=e.F,t=e.Da,n&&t&&ty(r,n,t),ty(r,"VER",e.qa),nl(e,r),r}function nw(e,t,n){if(t&&!e.I)throw Error("Can't create secondary domain capable XhrIo object.");return(t=new tJ(n&&e.Ha&&!e.va?new tz({ob:!0}):e.va)).Oa(e.I),t}function nb(){}function nE(){if($&&!(10<=Number(J)))throw Error("Environmental error: no available transport.")}function nI(e,t){eb.call(this),this.g=new nn(t),this.l=e,this.h=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.g.s=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.Ca&&(e?e["X-WebChannel-Client-Profile"]=t.Ca:e={"X-WebChannel-Client-Profile":t.Ca}),this.g.U=e,(e=t&&t.cc)&&!O(e)&&(this.g.o=e),this.A=t&&t.supportsCrossDomainXhr||!1,this.v=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!O(t)&&(this.g.F=t,null!==(e=this.h)&&t in e&&t in(e=this.h)&&delete e[t]),this.j=new nD(this)}function nS(e){e2.call(this);var t=e.__sm__;if(t){e:{for(let n in t){e=n;break e}e=void 0}(this.i=e)&&(e=this.i,t=null!==t&&e in t?t[e]:void 0),this.data=t}else this.data=e}function nT(){e4.call(this),this.status=1}function nD(e){this.g=e}function nx(){this.blockSize=-1,this.blockSize=64,this.g=[,,,,],this.m=Array(this.blockSize),this.i=this.h=0,this.reset()}function nk(e,t,n){n||(n=0);var r=Array(16);if("string"==typeof t)for(var i=0;16>i;++i)r[i]=t.charCodeAt(n++)|t.charCodeAt(n++)<<8|t.charCodeAt(n++)<<16|t.charCodeAt(n++)<<24;else for(i=0;16>i;++i)r[i]=t[n++]|t[n++]<<8|t[n++]<<16|t[n++]<<24;t=e.g[0],n=e.g[1],i=e.g[2];var s=e.g[3],a=t+(s^n&(i^s))+r[0]+3614090360&4294967295;a=s+(i^(t=n+(a<<7&4294967295|a>>>25))&(n^i))+r[1]+3905402710&4294967295,a=i+(n^(s=t+(a<<12&4294967295|a>>>20))&(t^n))+r[2]+606105819&4294967295,a=n+(t^(i=s+(a<<17&4294967295|a>>>15))&(s^t))+r[3]+3250441966&4294967295,a=t+(s^(n=i+(a<<22&4294967295|a>>>10))&(i^s))+r[4]+4118548399&4294967295,a=s+(i^(t=n+(a<<7&4294967295|a>>>25))&(n^i))+r[5]+1200080426&4294967295,a=i+(n^(s=t+(a<<12&4294967295|a>>>20))&(t^n))+r[6]+2821735955&4294967295,a=n+(t^(i=s+(a<<17&4294967295|a>>>15))&(s^t))+r[7]+4249261313&4294967295,a=t+(s^(n=i+(a<<22&4294967295|a>>>10))&(i^s))+r[8]+1770035416&4294967295,a=s+(i^(t=n+(a<<7&4294967295|a>>>25))&(n^i))+r[9]+2336552879&4294967295,a=i+(n^(s=t+(a<<12&4294967295|a>>>20))&(t^n))+r[10]+4294925233&4294967295,a=n+(t^(i=s+(a<<17&4294967295|a>>>15))&(s^t))+r[11]+2304563134&4294967295,a=t+(s^(n=i+(a<<22&4294967295|a>>>10))&(i^s))+r[12]+1804603682&4294967295,a=s+(i^(t=n+(a<<7&4294967295|a>>>25))&(n^i))+r[13]+4254626195&4294967295,a=i+(n^(s=t+(a<<12&4294967295|a>>>20))&(t^n))+r[14]+2792965006&4294967295,a=n+(t^(i=s+(a<<17&4294967295|a>>>15))&(s^t))+r[15]+1236535329&4294967295,n=i+(a<<22&4294967295|a>>>10),a=t+(i^s&(n^i))+r[1]+4129170786&4294967295,t=n+(a<<5&4294967295|a>>>27),a=s+(n^i&(t^n))+r[6]+3225465664&4294967295,s=t+(a<<9&4294967295|a>>>23),a=i+(t^n&(s^t))+r[11]+643717713&4294967295,i=s+(a<<14&4294967295|a>>>18),a=n+(s^t&(i^s))+r[0]+3921069994&4294967295,n=i+(a<<20&4294967295|a>>>12),a=t+(i^s&(n^i))+r[5]+3593408605&4294967295,t=n+(a<<5&4294967295|a>>>27),a=s+(n^i&(t^n))+r[10]+38016083&4294967295,s=t+(a<<9&4294967295|a>>>23),a=i+(t^n&(s^t))+r[15]+3634488961&4294967295,i=s+(a<<14&4294967295|a>>>18),a=n+(s^t&(i^s))+r[4]+3889429448&4294967295,n=i+(a<<20&4294967295|a>>>12),a=t+(i^s&(n^i))+r[9]+568446438&4294967295,t=n+(a<<5&4294967295|a>>>27),a=s+(n^i&(t^n))+r[14]+3275163606&4294967295,s=t+(a<<9&4294967295|a>>>23),a=i+(t^n&(s^t))+r[3]+4107603335&4294967295,i=s+(a<<14&4294967295|a>>>18),a=n+(s^t&(i^s))+r[8]+1163531501&4294967295,n=i+(a<<20&4294967295|a>>>12),a=t+(i^s&(n^i))+r[13]+2850285829&4294967295,t=n+(a<<5&4294967295|a>>>27),a=s+(n^i&(t^n))+r[2]+4243563512&4294967295,s=t+(a<<9&4294967295|a>>>23),a=i+(t^n&(s^t))+r[7]+1735328473&4294967295,i=s+(a<<14&4294967295|a>>>18),a=n+(s^t&(i^s))+r[12]+2368359562&4294967295,a=t+((n=i+(a<<20&4294967295|a>>>12))^i^s)+r[5]+4294588738&4294967295,a=s+((t=n+(a<<4&4294967295|a>>>28))^n^i)+r[8]+2272392833&4294967295,a=i+((s=t+(a<<11&4294967295|a>>>21))^t^n)+r[11]+1839030562&4294967295,a=n+((i=s+(a<<16&4294967295|a>>>16))^s^t)+r[14]+4259657740&4294967295,a=t+((n=i+(a<<23&4294967295|a>>>9))^i^s)+r[1]+2763975236&4294967295,a=s+((t=n+(a<<4&4294967295|a>>>28))^n^i)+r[4]+1272893353&4294967295,a=i+((s=t+(a<<11&4294967295|a>>>21))^t^n)+r[7]+4139469664&4294967295,a=n+((i=s+(a<<16&4294967295|a>>>16))^s^t)+r[10]+3200236656&4294967295,a=t+((n=i+(a<<23&4294967295|a>>>9))^i^s)+r[13]+681279174&4294967295,a=s+((t=n+(a<<4&4294967295|a>>>28))^n^i)+r[0]+3936430074&4294967295,a=i+((s=t+(a<<11&4294967295|a>>>21))^t^n)+r[3]+3572445317&4294967295,a=n+((i=s+(a<<16&4294967295|a>>>16))^s^t)+r[6]+76029189&4294967295,a=t+((n=i+(a<<23&4294967295|a>>>9))^i^s)+r[9]+3654602809&4294967295,a=s+((t=n+(a<<4&4294967295|a>>>28))^n^i)+r[12]+3873151461&4294967295,a=i+((s=t+(a<<11&4294967295|a>>>21))^t^n)+r[15]+530742520&4294967295,a=n+((i=s+(a<<16&4294967295|a>>>16))^s^t)+r[2]+3299628645&4294967295,n=i+(a<<23&4294967295|a>>>9),a=t+(i^(n|~s))+r[0]+4096336452&4294967295,t=n+(a<<6&4294967295|a>>>26),a=s+(n^(t|~i))+r[7]+1126891415&4294967295,s=t+(a<<10&4294967295|a>>>22),a=i+(t^(s|~n))+r[14]+2878612391&4294967295,i=s+(a<<15&4294967295|a>>>17),a=n+(s^(i|~t))+r[5]+4237533241&4294967295,n=i+(a<<21&4294967295|a>>>11),a=t+(i^(n|~s))+r[12]+1700485571&4294967295,t=n+(a<<6&4294967295|a>>>26),a=s+(n^(t|~i))+r[3]+2399980690&4294967295,s=t+(a<<10&4294967295|a>>>22),a=i+(t^(s|~n))+r[10]+4293915773&4294967295,i=s+(a<<15&4294967295|a>>>17),a=n+(s^(i|~t))+r[1]+2240044497&4294967295,n=i+(a<<21&4294967295|a>>>11),a=t+(i^(n|~s))+r[8]+1873313359&4294967295,t=n+(a<<6&4294967295|a>>>26),a=s+(n^(t|~i))+r[15]+4264355552&4294967295,s=t+(a<<10&4294967295|a>>>22),a=i+(t^(s|~n))+r[6]+2734768916&4294967295,i=s+(a<<15&4294967295|a>>>17),a=n+(s^(i|~t))+r[13]+1309151649&4294967295,n=i+(a<<21&4294967295|a>>>11),a=t+(i^(n|~s))+r[4]+4149444226&4294967295,t=n+(a<<6&4294967295|a>>>26),a=s+(n^(t|~i))+r[11]+3174756917&4294967295,s=t+(a<<10&4294967295|a>>>22),a=i+(t^(s|~n))+r[2]+718787259&4294967295,i=s+(a<<15&4294967295|a>>>17),a=n+(s^(i|~t))+r[9]+3951481745&4294967295,e.g[0]=e.g[0]+t&4294967295,e.g[1]=e.g[1]+(i+(a<<21&4294967295|a>>>11))&4294967295,e.g[2]=e.g[2]+i&4294967295,e.g[3]=e.g[3]+s&4294967295}function nC(e,t){this.h=t;for(var n=[],r=!0,i=e.length-1;0<=i;i--){var s=0|e[i];r&&s==t||(n[i]=s,r=!1)}this.g=n}(c=tJ.prototype).Oa=function(e){this.M=e},c.ha=function(e,t,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.I+"; newUri="+e);t=t?t.toUpperCase():"GET",this.I=e,this.j="",this.m=0,this.F=!1,this.h=!0,this.g=this.u?this.u.g():o.g(),this.C=this.u?eZ(this.u):eZ(o),this.g.onreadystatechange=S(this.La,this);try{this.G=!0,this.g.open(t,String(e),!0),this.G=!1}catch(s){t2(this,s);return}if(e=n||"",n=new Map(this.headers),r){if(Object.getPrototypeOf(r)===Object.prototype)for(var a in r)n.set(a,r[a]);else if("function"==typeof r.keys&&"function"==typeof r.get)for(let l of r.keys())n.set(l,r.get(l));else throw Error("Unknown input type for opt_headers: "+String(r))}for(let[u,c]of(r=Array.from(n.keys()).find(e=>"content-type"==e.toLowerCase()),a=_.FormData&&e instanceof _.FormData,!(0<=k(t1,t))||r||a||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),n))this.g.setRequestHeader(u,c);this.K&&(this.g.responseType=this.K),"withCredentials"in this.g&&this.g.withCredentials!==this.M&&(this.g.withCredentials=this.M);try{var h;t5(this),0<this.B&&((this.L=(h=this.g,$&&j(X,9,function(){let e=0,t=P(String(i)).split("."),n=P("9").split("."),r=Math.max(t.length,n.length);for(let s=0;0==e&&s<r;s++){var a=t[s]||"",o=n[s]||"";do{if(a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""],o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],0==a[0].length&&0==o[0].length)break;e=L(0==a[1].length?0:parseInt(a[1],10),0==o[1].length?0:parseInt(o[1],10))||L(0==a[2].length,0==o[2].length)||L(a[2],o[2]),a=a[3],o=o[3]}while(0==e)}return 0<=e})&&"number"==typeof h.timeout&&void 0!==h.ontimeout))?(this.g.timeout=this.B,this.g.ontimeout=S(this.ua,this)):this.A=eO(this.ua,this.B,this)),this.v=!0,this.g.send(e),this.v=!1}catch(d){t2(this,d)}},c.ua=function(){void 0!==y&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,eE(this,"timeout"),this.abort(8))},c.abort=function(e){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=e||7,eE(this,"complete"),eE(this,"abort"),t6(this))},c.N=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),t6(this,!0)),tJ.$.N.call(this)},c.La=function(){this.s||(this.G||this.v||this.l?t9(this):this.kb())},c.kb=function(){t9(this)},c.da=function(){try{return 2<t3(this)?this.g.status:-1}catch(e){return -1}},c.ja=function(){try{return this.g?this.g.responseText:""}catch(e){return""}},c.Wa=function(e){if(this.g){var t=this.g.responseText;return e&&0==t.indexOf(e)&&(t=t.substring(e.length)),tX(t)}},c.Ia=function(){return this.m},c.Sa=function(){return"string"==typeof this.j?this.j:String(this.j)},(c=nn.prototype).qa=8,c.H=1,c.Na=function(e){if(this.m){if(this.m=null,1==this.H){if(!e){this.W=Math.floor(1e5*Math.random()),e=this.W++;let t=new e6(this,this.j,e,void 0),n=this.s;if(this.U&&(n?el(n=ea(n),this.U):n=this.U),null!==this.o||this.O||(t.I=n,n=null),this.P)e:{for(var r=0,i=0;i<this.i.length;i++){t:{var s=this.i[i];if("__data__"in s.g&&"string"==typeof(s=s.g.__data__)){s=s.length;break t}s=void 0}if(void 0===s)break;if(4096<(r+=s)){r=i;break e}if(4096===r||i===this.i.length-1){r=i+1;break e}}r=1e3}else r=1e3;r=nu(this,t,r),ty(i=tf(this.G),"RID",e),ty(i,"CVER",22),this.F&&ty(i,"X-HTTP-Session-Id",this.F),nl(this,i),n&&(this.O?r="headers="+encodeURIComponent(String(t8(n)))+"&"+r:this.o&&ne(i,this.o,n)),tj(this.h,t),this.bb&&ty(i,"TYPE","init"),this.P?(ty(i,"$req",r),ty(i,"SID","null"),t.ba=!0,te(t,i,null)):te(t,i,r),this.H=2}}else 3==this.H&&(e?no(this,e):0==this.i.length||tM(this.h)||no(this))}},c.Ma=function(){if(this.u=null,nf(this),this.ca&&!(this.L||null==this.g||0>=this.S)){var e=2*this.S;this.j.info("BP detection timer enabled: "+e),this.B=eW(S(this.jb,this),e)}},c.jb=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.M=!1,this.L=!0,eY(10),ni(this),nf(this))},c.ib=function(){null!=this.v&&(this.v=null,ni(this),nh(this),eY(19))},c.pb=function(e){e?(this.j.info("Successfully pinged google.com"),eY(2)):(this.j.info("Failed to ping google.com"),eY(1))},(c=nb.prototype).Ba=function(){},c.Aa=function(){},c.za=function(){},c.ya=function(){},c.Va=function(){},nE.prototype.g=function(e,t){return new nI(e,t)},D(nI,eb),nI.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.I=!0);var e=this.g,t=this.l,n=this.h||void 0;eY(0),e.Y=t,e.ma=n||{},e.M=e.aa,e.G=nv(e,null,e.Y),na(e)},nI.prototype.close=function(){nr(this.g)},nI.prototype.u=function(e){var t=this.g;if("string"==typeof e){var n={};n.__data__=e,e=n}else this.v&&((n={}).__data__=eS(e),e=n);t.i.push(new tO(t.fb++,e)),3==t.H&&na(t)},nI.prototype.N=function(){this.g.l=null,delete this.j,nr(this.g),delete this.g,nI.$.N.call(this)},D(nS,e2),D(nT,e4),D(nD,nb),nD.prototype.Ba=function(){eE(this.g,"a")},nD.prototype.Aa=function(e){eE(this.g,new nS(e))},nD.prototype.za=function(e){eE(this.g,new nT)},nD.prototype.ya=function(){eE(this.g,"b")},D(nx,function(){this.blockSize=-1}),nx.prototype.reset=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.i=this.h=0},nx.prototype.j=function(e,t){void 0===t&&(t=e.length);for(var n=t-this.blockSize,r=this.m,i=this.h,s=0;s<t;){if(0==i)for(;s<=n;)nk(this,e,s),s+=this.blockSize;if("string"==typeof e){for(;s<t;)if(r[i++]=e.charCodeAt(s++),i==this.blockSize){nk(this,r),i=0;break}}else for(;s<t;)if(r[i++]=e[s++],i==this.blockSize){nk(this,r),i=0;break}}this.h=i,this.i+=t},nx.prototype.l=function(){var e=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);e[0]=128;for(var t=1;t<e.length-8;++t)e[t]=0;var n=8*this.i;for(t=e.length-8;t<e.length;++t)e[t]=255&n,n/=256;for(this.j(e),e=Array(16),t=n=0;4>t;++t)for(var r=0;32>r;r+=8)e[n++]=this.g[t]>>>r&255;return e};var nN={};function nR(e){return -128<=e&&128>e?j(nN,e,function(e){return new nC([0|e],0>e?-1:0)}):new nC([0|e],0>e?-1:0)}function nA(e){if(isNaN(e)||!isFinite(e))return nP;if(0>e)return nj(nA(-e));for(var t=[],n=1,r=0;e>=n;r++)t[r]=e/n|0,n*=nO;return new nC(t,0)}var nO=4294967296,nP=nR(0),nL=nR(1),nM=nR(16777216);function nU(e){if(0!=e.h)return!1;for(var t=0;t<e.g.length;t++)if(0!=e.g[t])return!1;return!0}function nF(e){return -1==e.h}function nj(e){for(var t=e.g.length,n=[],r=0;r<t;r++)n[r]=~e.g[r];return new nC(n,~e.h).add(nL)}function nB(e,t){return e.add(nj(t))}function n$(e,t){for(;(65535&e[t])!=e[t];)e[t+1]+=e[t]>>>16,e[t]&=65535,t++}function nV(e,t){this.g=e,this.h=t}function nG(e,t){if(nU(t))throw Error("division by zero");if(nU(e))return new nV(nP,nP);if(nF(e))return t=nG(nj(e),t),new nV(nj(t.g),nj(t.h));if(nF(t))return t=nG(e,nj(t)),new nV(nj(t.g),t.h);if(30<e.g.length){if(nF(e)||nF(t))throw Error("slowDivide_ only works with positive integers.");for(var n=nL,r=t;0>=r.X(e);)n=nq(n),r=nq(r);var i=nz(n,1),s=nz(r,1);for(r=nz(r,2),n=nz(n,2);!nU(r);){var a=s.add(r);0>=a.X(e)&&(i=i.add(n),s=a),r=nz(r,1),n=nz(n,1)}return t=nB(e,i.R(t)),new nV(i,t)}for(i=nP;0<=e.X(t);){for(r=48>=(r=Math.ceil(Math.log(n=Math.max(1,Math.floor(e.ea()/t.ea())))/Math.LN2))?1:Math.pow(2,r-48),a=(s=nA(n)).R(t);nF(a)||0<a.X(e);)n-=r,a=(s=nA(n)).R(t);nU(s)&&(s=nL),i=i.add(s),e=nB(e,a)}return new nV(i,e)}function nq(e){for(var t=e.g.length+1,n=[],r=0;r<t;r++)n[r]=e.D(r)<<1|e.D(r-1)>>>31;return new nC(n,e.h)}function nz(e,t){var n=t>>5;t%=32;for(var r=e.g.length-n,i=[],s=0;s<r;s++)i[s]=0<t?e.D(s+n)>>>t|e.D(s+n+1)<<32-t:e.D(s+n);return new nC(i,e.h)}(c=nC.prototype).ea=function(){if(nF(this))return-nj(this).ea();for(var e=0,t=1,n=0;n<this.g.length;n++){var r=this.D(n);e+=(0<=r?r:nO+r)*t,t*=nO}return e},c.toString=function(e){if(2>(e=e||10)||36<e)throw Error("radix out of range: "+e);if(nU(this))return"0";if(nF(this))return"-"+nj(this).toString(e);for(var t=nA(Math.pow(e,6)),n=this,r="";;){var i=nG(n,t).g,s=((0<(n=nB(n,i.R(t))).g.length?n.g[0]:n.h)>>>0).toString(e);if(nU(n=i))return s+r;for(;6>s.length;)s="0"+s;r=s+r}},c.D=function(e){return 0>e?0:e<this.g.length?this.g[e]:this.h},c.X=function(e){return nF(e=nB(this,e))?-1:nU(e)?0:1},c.abs=function(){return nF(this)?nj(this):this},c.add=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0,i=0;i<=t;i++){var s=r+(65535&this.D(i))+(65535&e.D(i)),a=(s>>>16)+(this.D(i)>>>16)+(e.D(i)>>>16);r=a>>>16,s&=65535,a&=65535,n[i]=a<<16|s}return new nC(n,-2147483648&n[n.length-1]?-1:0)},c.R=function(e){if(nU(this)||nU(e))return nP;if(nF(this))return nF(e)?nj(this).R(nj(e)):nj(nj(this).R(e));if(nF(e))return nj(this.R(nj(e)));if(0>this.X(nM)&&0>e.X(nM))return nA(this.ea()*e.ea());for(var t=this.g.length+e.g.length,n=[],r=0;r<2*t;r++)n[r]=0;for(r=0;r<this.g.length;r++)for(var i=0;i<e.g.length;i++){var s=this.D(r)>>>16,a=65535&this.D(r),o=e.D(i)>>>16,l=65535&e.D(i);n[2*r+2*i]+=a*l,n$(n,2*r+2*i),n[2*r+2*i+1]+=s*l,n$(n,2*r+2*i+1),n[2*r+2*i+1]+=a*o,n$(n,2*r+2*i+1),n[2*r+2*i+2]+=s*o,n$(n,2*r+2*i+2)}for(r=0;r<t;r++)n[r]=n[2*r+1]<<16|n[2*r];for(r=t;r<2*t;r++)n[r]=0;return new nC(n,0)},c.gb=function(e){return nG(this,e).h},c.and=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0;r<t;r++)n[r]=this.D(r)&e.D(r);return new nC(n,this.h&e.h)},c.or=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0;r<t;r++)n[r]=this.D(r)|e.D(r);return new nC(n,this.h|e.h)},c.xor=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0;r<t;r++)n[r]=this.D(r)^e.D(r);return new nC(n,this.h^e.h)},nE.prototype.createWebChannel=nE.prototype.g,nI.prototype.send=nI.prototype.u,nI.prototype.open=nI.prototype.m,nI.prototype.close=nI.prototype.close,eQ.NO_ERROR=0,eQ.TIMEOUT=8,eQ.HTTP_ERROR=6,eX.COMPLETE="complete",e0.EventType=e1,e1.OPEN="a",e1.CLOSE="b",e1.ERROR="c",e1.MESSAGE="d",eb.prototype.listen=eb.prototype.O,tJ.prototype.listenOnce=tJ.prototype.P,tJ.prototype.getLastError=tJ.prototype.Sa,tJ.prototype.getLastErrorCode=tJ.prototype.Ia,tJ.prototype.getStatus=tJ.prototype.da,tJ.prototype.getResponseJson=tJ.prototype.Wa,tJ.prototype.getResponseText=tJ.prototype.ja,tJ.prototype.send=tJ.prototype.ha,tJ.prototype.setWithCredentials=tJ.prototype.Oa,nx.prototype.digest=nx.prototype.l,nx.prototype.reset=nx.prototype.reset,nx.prototype.update=nx.prototype.j,nC.prototype.add=nC.prototype.add,nC.prototype.multiply=nC.prototype.R,nC.prototype.modulo=nC.prototype.gb,nC.prototype.compare=nC.prototype.X,nC.prototype.toNumber=nC.prototype.ea,nC.prototype.toString=nC.prototype.toString,nC.prototype.getBits=nC.prototype.D,nC.fromNumber=nA,nC.fromString=function e(t,n){if(0==t.length)throw Error("number format error: empty string");if(2>(n=n||10)||36<n)throw Error("radix out of range: "+n);if("-"==t.charAt(0))return nj(e(t.substring(1),n));if(0<=t.indexOf("-"))throw Error('number format error: interior "-" character');for(var r=nA(Math.pow(n,8)),i=nP,s=0;s<t.length;s+=8){var a=Math.min(8,t.length-s),o=parseInt(t.substring(s,s+a),n);8>a?(a=nA(Math.pow(n,a)),i=i.R(a).add(nA(o))):i=(i=i.R(r)).add(nA(o))}return i};var nK=g.createWebChannelTransport=function(){return new nE},nY=g.getStatEventTarget=function(){return eG()},nH=g.ErrorCode=eQ,nW=g.EventType=eX,nQ=g.Event=e$,nX=g.Stat={xb:0,Ab:1,Bb:2,Ub:3,Zb:4,Wb:5,Xb:6,Vb:7,Tb:8,Yb:9,PROXY:10,NOPROXY:11,Rb:12,Nb:13,Ob:14,Mb:15,Pb:16,Qb:17,tb:18,sb:19,ub:20},nJ=g.FetchXmlHttpFactory=tz,nZ=g.WebChannel=e0,n0=g.XhrIo=tJ,n1=g.Md5=nx,n2=g.Integer=nC,n4=n(3454);let n9="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ class n6{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}n6.UNAUTHENTICATED=new n6(null),n6.GOOGLE_CREDENTIALS=new n6("google-credentials-uid"),n6.FIRST_PARTY=new n6("first-party-uid"),n6.MOCK_USER=new n6("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ let n5="9.21.0",n3=new f.Yd("@firebase/firestore");function n7(){return n3.logLevel}function n8(e,...t){if(n3.logLevel<=f.in.DEBUG){let n=t.map(rn);n3.debug(`Firestore (${n5}): ${e}`,...n)}}function re(e,...t){if(n3.logLevel<=f.in.ERROR){let n=t.map(rn);n3.error(`Firestore (${n5}): ${e}`,...n)}}function rt(e,...t){if(n3.logLevel<=f.in.WARN){let n=t.map(rn);n3.warn(`Firestore (${n5}): ${e}`,...n)}}function rn(e){if("string"==typeof e)return e;try{return JSON.stringify(e)}catch(t){return e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ function rr(e="Unexpected state"){let t=`FIRESTORE (${n5}) INTERNAL ASSERTION FAILED: `+e;throw re(t),Error(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ let ri={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class rs extends p.ZR{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ class ra{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ class ro{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class rl{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(n6.UNAUTHENTICATED))}shutdown(){}}class ru{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class rc{constructor(e){this.t=e,this.currentUser=n6.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){let n=this.i,r=e=>this.i!==n?(n=this.i,t(e)):Promise.resolve(),i=new ra;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new ra,e.enqueueRetryable(()=>r(this.currentUser))};let s=()=>{let t=i;e.enqueueRetryable(async()=>{await t.promise,await r(this.currentUser)})},a=e=>{n8("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=e,this.auth.addAuthTokenListener(this.o),s()};this.t.onInit(e=>a(e)),setTimeout(()=>{if(!this.auth){let e=this.t.getImmediate({optional:!0});e?a(e):(n8("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new ra)}},0),s()}getToken(){let e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(t=>this.i!==e?(n8("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):t?("string"==typeof t.accessToken||rr(),new ro(t.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){let e=this.auth&&this.auth.getUid();return null===e||"string"==typeof e||rr(),new n6(e)}}class rh{constructor(e,t,n){this.h=e,this.l=t,this.m=n,this.type="FirstParty",this.user=n6.FIRST_PARTY,this.g=new Map}p(){return this.m?this.m():null}get headers(){this.g.set("X-Goog-AuthUser",this.h);let e=this.p();return e&&this.g.set("Authorization",e),this.l&&this.g.set("X-Goog-Iam-Authorization-Token",this.l),this.g}}class rd{constructor(e,t,n){this.h=e,this.l=t,this.m=n}getToken(){return Promise.resolve(new rh(this.h,this.l,this.m))}start(e,t){e.enqueueRetryable(()=>t(n6.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class rf{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class rp{constructor(e){this.I=e,this.forceRefresh=!1,this.appCheck=null,this.T=null}start(e,t){let n=e=>{null!=e.error&&n8("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${e.error.message}`);let n=e.token!==this.T;return this.T=e.token,n8("FirebaseAppCheckTokenProvider",`Received ${n?"new":"existing"} token.`),n?t(e.token):Promise.resolve()};this.o=t=>{e.enqueueRetryable(()=>n(t))};let r=e=>{n8("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=e,this.appCheck.addTokenListener(this.o)};this.I.onInit(e=>r(e)),setTimeout(()=>{if(!this.appCheck){let e=this.I.getImmediate({optional:!0});e?r(e):n8("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(e=>e?("string"==typeof e.token||rr(),this.T=e.token,new rf(e.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ class rm{static A(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length,n="";for(;n.length<20;){let r=/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ function(e){let t="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(n);else for(let r=0;r<e;r++)n[r]=Math.floor(256*Math.random());return n}(40);for(let i=0;i<r.length;++i)n.length<20&&r[i]<t&&(n+=e.charAt(r[i]%e.length))}return n}}function rg(e,t){return e<t?-1:e>t?1:0}function ry(e,t,n){return e.length===t.length&&e.every((e,r)=>n(e,t[r]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ class r_{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0||t>=1e9)throw new rs(ri.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800||e>=253402300800)throw new rs(ri.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return r_.fromMillis(Date.now())}static fromDate(e){return r_.fromMillis(e.getTime())}static fromMillis(e){let t=Math.floor(e/1e3);return new r_(t,Math.floor(1e6*(e-1e3*t)))}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?rg(this.nanoseconds,e.nanoseconds):rg(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){let e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ class rv{constructor(e){this.timestamp=e}static fromTimestamp(e){return new rv(e)}static min(){return new rv(new r_(0,0))}static max(){return new rv(new r_(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ class rw{constructor(e,t,n){void 0===t?t=0:t>e.length&&rr(),void 0===n?n=e.length-t:n>e.length-t&&rr(),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return 0===rw.comparator(this,e)}child(e){let t=this.segments.slice(this.offset,this.limit());return e instanceof rw?e.forEach(e=>{t.push(e)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=void 0===e?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){let n=Math.min(e.length,t.length);for(let r=0;r<n;r++){let i=e.get(r),s=t.get(r);if(i<s)return -1;if(i>s)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class rb extends rw{construct(e,t,n){return new rb(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...e){let t=[];for(let n of e){if(n.indexOf("//")>=0)throw new rs(ri.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);t.push(...n.split("/").filter(e=>e.length>0))}return new rb(t)}static emptyPath(){return new rb([])}}let rE=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class rI extends rw{construct(e,t,n){return new rI(e,t,n)}static isValidIdentifier(e){return rE.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),rI.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new rI(["__name__"])}static fromServerFormat(e){let t=[],n="",r=0,i=()=>{if(0===n.length)throw new rs(ri.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(n),n=""},s=!1;for(;r<e.length;){let a=e[r];if("\\"===a){if(r+1===e.length)throw new rs(ri.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let o=e[r+1];if("\\"!==o&&"."!==o&&"`"!==o)throw new rs(ri.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=o,r+=2}else"`"===a?(s=!s,r++):"."!==a||s?(n+=a,r++):(i(),r++)}if(i(),s)throw new rs(ri.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new rI(t)}static emptyPath(){return new rI([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ class rS{constructor(e){this.path=e}static fromPath(e){return new rS(rb.fromString(e))}static fromName(e){return new rS(rb.fromString(e).popFirst(5))}static empty(){return new rS(rb.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===rb.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return rb.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new rS(new rb(e.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ class rT{constructor(e,t,n,r){this.indexId=e,this.collectionGroup=t,this.fields=n,this.indexState=r}}function rD(e){return e.fields.find(e=>2===e.kind)}function rx(e){return e.fields.filter(e=>2!==e.kind)}rT.UNKNOWN_ID=-1;class rk{constructor(e,t){this.fieldPath=e,this.kind=t}}class rC{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new rC(0,rR.min())}}function rN(e){return new rR(e.readTime,e.key,-1)}class rR{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new rR(rv.min(),rS.empty(),-1)}static max(){return new rR(rv.max(),rS.empty(),-1)}}function rA(e,t){let n=e.readTime.compareTo(t.readTime);return 0!==n?n:0!==(n=rS.comparator(e.documentKey,t.documentKey))?n:rg(e.largestBatchId,t.largestBatchId)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ let rO="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class rP{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ async function rL(e){if(e.code!==ri.FAILED_PRECONDITION||e.message!==rO)throw e;n8("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ class rM{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)},e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&rr(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new rM((n,r)=>{this.nextCallback=t=>{this.wrapSuccess(e,t).next(n,r)},this.catchCallback=e=>{this.wrapFailure(t,e).next(n,r)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{let t=e();return t instanceof rM?t:rM.resolve(t)}catch(n){return rM.reject(n)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):rM.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):rM.reject(t)}static resolve(e){return new rM((t,n)=>{t(e)})}static reject(e){return new rM((t,n)=>{n(e)})}static waitFor(e){return new rM((t,n)=>{let r=0,i=0,s=!1;e.forEach(e=>{++r,e.next(()=>{++i,s&&i===r&&t()},e=>n(e))}),s=!0,i===r&&t()})}static or(e){let t=rM.resolve(!1);for(let n of e)t=t.next(e=>e?rM.resolve(e):n());return t}static forEach(e,t){let n=[];return e.forEach((e,r)=>{n.push(t.call(this,e,r))}),this.waitFor(n)}static mapArray(e,t){return new rM((n,r)=>{let i=e.length,s=Array(i),a=0;for(let o=0;o<i;o++){let l=o;t(e[l]).next(e=>{s[l]=e,++a===i&&n(s)},e=>r(e))}})}static doWhile(e,t){return new rM((n,r)=>{let i=()=>{!0===e()?t().next(()=>{i()},r):n()};i()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ class rU{constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.R=new ra,this.transaction.oncomplete=()=>{this.R.resolve()},this.transaction.onabort=()=>{t.error?this.R.reject(new rB(e,t.error)):this.R.resolve()},this.transaction.onerror=t=>{let n=rz(t.target.error);this.R.reject(new rB(e,n))}}static open(e,t,n,r){try{return new rU(t,e.transaction(r,n))}catch(i){throw new rB(t,i)}}get v(){return this.R.promise}abort(e){e&&this.R.reject(e),this.aborted||(n8("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}P(){let e=this.transaction;this.aborted||"function"!=typeof e.commit||e.commit()}store(e){let t=this.transaction.objectStore(e);return new rV(t)}}class rF{constructor(e,t,n){this.name=e,this.version=t,this.V=n,12.2===rF.S((0,p.z$)())&&re("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return n8("SimpleDb","Removing database:",e),rG(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!(0,p.hl)())return!1;if(rF.C())return!0;let e=(0,p.z$)(),t=rF.S(e),n=rF.N(e);return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||0<t&&t<10||0<n&&n<4.5)}static C(){var e;return void 0!==n4&&"YES"===(null===(e=n4.env)||void 0===e?void 0:e.k)}static M(e,t){return e.store(t)}static S(e){let t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(n)}static N(e){let t=e.match(/Android ([\d.]+)/i),n=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(n)}async O(e){return this.db||(n8("SimpleDb","Opening database:",this.name),this.db=await new Promise((t,n)=>{let r=indexedDB.open(this.name,this.version);r.onsuccess=e=>{let n=e.target.result;t(n)},r.onblocked=()=>{n(new rB(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},r.onerror=t=>{let r=t.target.error;"VersionError"===r.name?n(new rs(ri.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):"InvalidStateError"===r.name?n(new rs(ri.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+r)):n(new rB(e,r))},r.onupgradeneeded=e=>{n8("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',e.oldVersion);let t=e.target.result;this.V.$(t,r.transaction,e.oldVersion,this.version).next(()=>{n8("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.F&&(this.db.onversionchange=e=>this.F(e)),this.db}B(e){this.F=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,n,r){let i="readonly"===t,s=0;for(;;){++s;try{this.db=await this.O(e);let a=rU.open(this.db,e,i?"readonly":"readwrite",n),o=r(a).next(e=>(a.P(),e)).catch(e=>(a.abort(e),rM.reject(e))).toPromise();return o.catch(()=>{}),await a.v,o}catch(u){let l="FirebaseError"!==u.name&&s<3;if(n8("SimpleDb","Transaction failed with error:",u.message,"Retrying:",l),this.close(),!l)return Promise.reject(u)}}}close(){this.db&&this.db.close(),this.db=void 0}}class rj{constructor(e){this.L=e,this.q=!1,this.U=null}get isDone(){return this.q}get K(){return this.U}set cursor(e){this.L=e}done(){this.q=!0}G(e){this.U=e}delete(){return rG(this.L.delete())}}class rB extends rs{constructor(e,t){super(ri.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function r$(e){return"IndexedDbTransactionError"===e.name}class rV{constructor(e){this.store=e}put(e,t){let n;return void 0!==t?(n8("SimpleDb","PUT",this.store.name,e,t),n=this.store.put(t,e)):(n8("SimpleDb","PUT",this.store.name,"<auto-key>",e),n=this.store.put(e)),rG(n)}add(e){return n8("SimpleDb","ADD",this.store.name,e,e),rG(this.store.add(e))}get(e){return rG(this.store.get(e)).next(t=>(void 0===t&&(t=null),n8("SimpleDb","GET",this.store.name,e,t),t))}delete(e){return n8("SimpleDb","DELETE",this.store.name,e),rG(this.store.delete(e))}count(){return n8("SimpleDb","COUNT",this.store.name),rG(this.store.count())}j(e,t){let n=this.options(e,t);if(n.index||"function"!=typeof this.store.getAll){let r=this.cursor(n),i=[];return this.W(r,(e,t)=>{i.push(t)}).next(()=>i)}{let s=this.store.getAll(n.range);return new rM((e,t)=>{s.onerror=e=>{t(e.target.error)},s.onsuccess=t=>{e(t.target.result)}})}}H(e,t){let n=this.store.getAll(e,null===t?void 0:t);return new rM((e,t)=>{n.onerror=e=>{t(e.target.error)},n.onsuccess=t=>{e(t.target.result)}})}J(e,t){n8("SimpleDb","DELETE ALL",this.store.name);let n=this.options(e,t);n.Y=!1;let r=this.cursor(n);return this.W(r,(e,t,n)=>n.delete())}X(e,t){let n;t?n=e:(n={},t=e);let r=this.cursor(n);return this.W(r,t)}Z(e){let t=this.cursor({});return new rM((n,r)=>{t.onerror=e=>{let t=rz(e.target.error);r(t)},t.onsuccess=t=>{let r=t.target.result;r?e(r.primaryKey,r.value).next(e=>{e?r.continue():n()}):n()}})}W(e,t){let n=[];return new rM((r,i)=>{e.onerror=e=>{i(e.target.error)},e.onsuccess=e=>{let i=e.target.result;if(!i)return void r();let s=new rj(i),a=t(i.primaryKey,i.value,s);if(a instanceof rM){let o=a.catch(e=>(s.done(),rM.reject(e)));n.push(o)}s.isDone?r():null===s.K?i.continue():i.continue(s.K)}}).next(()=>rM.waitFor(n))}options(e,t){let n;return void 0!==e&&("string"==typeof e?n=e:t=e),{index:n,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){let n=this.store.index(e.index);return e.Y?n.openKeyCursor(e.range,t):n.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function rG(e){return new rM((t,n)=>{e.onsuccess=e=>{let n=e.target.result;t(n)},e.onerror=e=>{let t=rz(e.target.error);n(t)}})}let rq=!1;function rz(e){let t=rF.S((0,p.z$)());if(t>=12.2&&t<13){let n="An internal error was encountered in the Indexed Database server";if(e.message.indexOf(n)>=0){let r=new rs("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${n}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return rq||(rq=!0,setTimeout(()=>{throw r},0)),r}}return e}class rK{constructor(e,t){this.asyncQueue=e,this.tt=t,this.task=null}start(){this.et(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return null!==this.task}et(e){n8("IndexBackiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{n8("IndexBackiller",`Documents written: ${await this.tt.nt()}`)}catch(e){r$(e)?n8("IndexBackiller","Ignoring IndexedDB error during index backfill: ",e):await rL(e)}await this.et(6e4)})}}class rY{constructor(e,t){this.localStore=e,this.persistence=t}async nt(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",t=>this.st(t,e))}st(e,t){let n=new Set,r=t,i=!0;return rM.doWhile(()=>!0===i&&r>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(t=>{if(null!==t&&!n.has(t))return n8("IndexBackiller",`Processing collection: ${t}`),this.it(e,t,r).next(e=>{r-=e,n.add(t)});i=!1})).next(()=>t-r)}it(e,t,n){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next(r=>this.localStore.localDocuments.getNextDocuments(e,t,r,n).next(n=>{let i=n.changes;return this.localStore.indexManager.updateIndexEntries(e,i).next(()=>this.rt(r,n)).next(n=>(n8("IndexBackiller",`Updating offset: ${n}`),this.localStore.indexManager.updateCollectionGroup(e,t,n))).next(()=>i.size)}))}rt(e,t){let n=e;return t.changes.forEach((e,t)=>{let r=rN(t);rA(r,n)>0&&(n=r)}),new rR(n.readTime,n.documentKey,Math.max(t.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ class rH{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=e=>this.ot(e),this.ut=e=>t.writeSequenceNumber(e))}ot(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){let e=++this.previousValue;return this.ut&&this.ut(e),e}}function rW(e){return 0===e&&1/e==-1/0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ function rQ(e){var t,n;let r="";for(let i=0;i<e.length;i++)r.length>0&&(r+="\x01\x01"),r=function(e,t){let n=t,r=e.length;for(let i=0;i<r;i++){let s=e.charAt(i);switch(s){case"\0":n+="\x01\x10";break;case"\x01":n+="\x01\x11";break;default:n+=s}}return n}(e.get(i),r);return r+"\x01\x01"}function rX(e){let t=e.length;if(t>=2||rr(),2===t)return"\x01"===e.charAt(0)&&"\x01"===e.charAt(1)||rr(),rb.emptyPath();let n=t-2,r=[],i="";for(let s=0;s<t;){let a=e.indexOf("\x01",s);switch((a<0||a>n)&&rr(),e.charAt(a+1)){case"\x01":let o;let l=e.substring(s,a);0===i.length?o=l:(i+=l,o=i,i=""),r.push(o);break;case"\x10":i+=e.substring(s,a),i+="\0";break;case"\x11":i+=e.substring(s,a+1);break;default:rr()}s=a+2}return new rb(r)}rH.ct=-1;/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ let rJ=["userId","batchId"],rZ={},r0=["prefixPath","collectionGroup","readTime","documentId"],r1=["prefixPath","collectionGroup","documentId"],r2=["collectionGroup","readTime","prefixPath","documentId"],r4=["canonicalId","targetId"],r9=["targetId","path"],r6=["path","targetId"],r5=["collectionId","parent"],r3=["indexId","uid"],r7=["uid","sequenceNumber"],r8=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],ie=["indexId","uid","orderedDocumentKey"],it=["userId","collectionPath","documentId"],ir=["userId","collectionPath","largestBatchId"],ii=["userId","collectionGroup","largestBatchId"],is=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],ia=[...is,"documentOverlays"],io=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],il=[...io,"indexConfiguration","indexState","indexEntries"];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ class iu extends rP{constructor(e,t){super(),this.at=e,this.currentSequenceNumber=t}}function ic(e,t){return rF.M(e.at,t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ function ih(e){let t=0;for(let n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function id(e,t){for(let n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function ip(e){for(let t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ class im{constructor(e,t){this.comparator=e,this.root=t||iy.EMPTY}insert(e,t){return new im(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,iy.BLACK,null,null))}remove(e){return new im(this.comparator,this.root.remove(e,this.comparator).copy(null,null,iy.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){let n=this.comparator(e,t.key);if(0===n)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){let r=this.comparator(e,n.key);if(0===r)return t+n.left.size;r<0?n=n.left:(t+=n.left.size+1,n=n.right)}return -1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,n)=>(e(t,n),!1))}toString(){let e=[];return this.inorderTraversal((t,n)=>(e.push(`${t}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new ig(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new ig(this.root,e,this.comparator,!1)}getReverseIterator(){return new ig(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new ig(this.root,e,this.comparator,!0)}}class ig{constructor(e,t,n,r){this.isReverse=r,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=t?n(e.key,t):1,t&&r&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(0===i){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class iy{constructor(e,t,n,r,i){this.key=e,this.value=t,this.color=null!=n?n:iy.RED,this.left=null!=r?r:iy.EMPTY,this.right=null!=i?i:iy.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,r,i){return new iy(null!=e?e:this.key,null!=t?t:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let r=this,i=n(e,r.key);return(r=i<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===i?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n))).fixUp()}removeMin(){if(this.left.isEmpty())return iy.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),(e=e.copy(null,null,null,e.left.removeMin(),null)).fixUp()}remove(e,t){let n,r=this;if(0>t(e,r.key))r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),0===t(e,r.key)){if(r.right.isEmpty())return iy.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=(e=(e=e.copy(null,null,null,null,e.right.rotateRight())).rotateLeft()).colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=(e=e.rotateRight()).colorFlip()),e}rotateLeft(){let e=this.copy(null,null,iy.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,iy.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){let e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw rr();let e=this.left.check();if(e!==this.right.check())throw rr();return e+(this.isRed()?0:1)}}iy.EMPTY=null,iy.RED=!0,iy.BLACK=!1,iy.EMPTY=new class{constructor(){this.size=0}get key(){throw rr()}get value(){throw rr()}get color(){throw rr()}get left(){throw rr()}get right(){throw rr()}copy(e,t,n,r,i){return this}insert(e,t,n){return new iy(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ class i_{constructor(e){this.comparator=e,this.data=new im(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,n)=>(e(t),!1))}forEachInRange(e,t){let n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){let r=n.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let n;for(n=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){let t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new iv(this.data.getIterator())}getIteratorFrom(e){return new iv(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(e=>{t=t.add(e)}),t}isEqual(e){if(!(e instanceof i_)||this.size!==e.size)return!1;let t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){let r=t.getNext().key,i=n.getNext().key;if(0!==this.comparator(r,i))return!1}return!0}toArray(){let e=[];return this.forEach(t=>{e.push(t)}),e}toString(){let e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){let t=new i_(this.comparator);return t.data=e,t}}class iv{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function iw(e){return e.hasNext()?e.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ class ib{constructor(e){this.fields=e,e.sort(rI.comparator)}static empty(){return new ib([])}unionWith(e){let t=new i_(rI.comparator);for(let n of this.fields)t=t.add(n);for(let r of e)t=t.add(r);return new ib(t.toArray())}covers(e){for(let t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return ry(this.fields,e.fields,(e,t)=>e.isEqual(t))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ class iE extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ class iI{constructor(e){this.binaryString=e}static fromBase64String(e){let t=function(e){try{return atob(e)}catch(t){throw"undefined"!=typeof DOMException&&t instanceof DOMException?new iE("Invalid base64 string: "+t):t}}(e);return new iI(t)}static fromUint8Array(e){let t=function(e){let t="";for(let n=0;n<e.length;++n)t+=String.fromCharCode(e[n]);return t}(e);return new iI(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return btoa(this.binaryString)}toUint8Array(){return function(e){let t=new Uint8Array(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return rg(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}iI.EMPTY_BYTE_STRING=new iI("");let iS=RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function iT(e){if(e||rr(),"string"==typeof e){let t=0,n=iS.exec(e);if(n||rr(),n[1]){let r=n[1];t=Number(r=(r+"000000000").substr(0,9))}let i=new Date(e);return{seconds:Math.floor(i.getTime()/1e3),nanos:t}}return{seconds:iD(e.seconds),nanos:iD(e.nanos)}}function iD(e){return"number"==typeof e?e:"string"==typeof e?Number(e):0}function ix(e){return"string"==typeof e?iI.fromBase64String(e):iI.fromUint8Array(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ function ik(e){var t,n;return"server_timestamp"===(null===(n=((null===(t=null==e?void 0:e.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function iC(e){let t=e.mapValue.fields.__previous_value__;return ik(t)?iC(t):t}function iN(e){let t=iT(e.mapValue.fields.__local_write_time__.timestampValue);return new r_(t.seconds,t.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ class iR{constructor(e,t,n,r,i,s,a,o){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=r,this.ssl=i,this.forceLongPolling=s,this.autoDetectLongPolling=a,this.useFetchStreams=o}}class iA{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new iA("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(e){return e instanceof iA&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ let iO={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},iP={nullValue:"NULL_VALUE"};function iL(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?ik(e)?4:iH(e)?9007199254740991:10:rr()}function iM(e,t){if(e===t)return!0;let n=iL(e);if(n!==iL(t))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return iN(e).isEqual(iN(t));case 3:return function(e,t){if("string"==typeof e.timestampValue&&"string"==typeof t.timestampValue&&e.timestampValue.length===t.timestampValue.length)return e.timestampValue===t.timestampValue;let n=iT(e.timestampValue),r=iT(t.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return ix(e.bytesValue).isEqual(ix(t.bytesValue));case 7:return e.referenceValue===t.referenceValue;case 8:return iD(e.geoPointValue.latitude)===iD(t.geoPointValue.latitude)&&iD(e.geoPointValue.longitude)===iD(t.geoPointValue.longitude);case 2:return function(e,t){if("integerValue"in e&&"integerValue"in t)return iD(e.integerValue)===iD(t.integerValue);if("doubleValue"in e&&"doubleValue"in t){let n=iD(e.doubleValue),r=iD(t.doubleValue);return n===r?rW(n)===rW(r):isNaN(n)&&isNaN(r)}return!1}(e,t);case 9:return ry(e.arrayValue.values||[],t.arrayValue.values||[],iM);case 10:return function(e,t){let n=e.mapValue.fields||{},r=t.mapValue.fields||{};if(ih(n)!==ih(r))return!1;for(let i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!iM(n[i],r[i])))return!1;return!0}(e,t);default:return rr()}}function iU(e,t){return void 0!==(e.values||[]).find(e=>iM(e,t))}function iF(e,t){if(e===t)return 0;let n=iL(e),r=iL(t);if(n!==r)return rg(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return rg(e.booleanValue,t.booleanValue);case 2:return function(e,t){let n=iD(e.integerValue||e.doubleValue),r=iD(t.integerValue||t.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(e,t);case 3:return ij(e.timestampValue,t.timestampValue);case 4:return ij(iN(e),iN(t));case 5:return rg(e.stringValue,t.stringValue);case 6:return function(e,t){let n=ix(e),r=ix(t);return n.compareTo(r)}(e.bytesValue,t.bytesValue);case 7:return function(e,t){let n=e.split("/"),r=t.split("/");for(let i=0;i<n.length&&i<r.length;i++){let s=rg(n[i],r[i]);if(0!==s)return s}return rg(n.length,r.length)}(e.referenceValue,t.referenceValue);case 8:return function(e,t){let n=rg(iD(e.latitude),iD(t.latitude));return 0!==n?n:rg(iD(e.longitude),iD(t.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return function(e,t){let n=e.values||[],r=t.values||[];for(let i=0;i<n.length&&i<r.length;++i){let s=iF(n[i],r[i]);if(s)return s}return rg(n.length,r.length)}(e.arrayValue,t.arrayValue);case 10:return function(e,t){if(e===iO.mapValue&&t===iO.mapValue)return 0;if(e===iO.mapValue)return 1;if(t===iO.mapValue)return -1;let n=e.fields||{},r=Object.keys(n),i=t.fields||{},s=Object.keys(i);r.sort(),s.sort();for(let a=0;a<r.length&&a<s.length;++a){let o=rg(r[a],s[a]);if(0!==o)return o;let l=iF(n[r[a]],i[s[a]]);if(0!==l)return l}return rg(r.length,s.length)}(e.mapValue,t.mapValue);default:throw rr()}}function ij(e,t){if("string"==typeof e&&"string"==typeof t&&e.length===t.length)return rg(e,t);let n=iT(e),r=iT(t),i=rg(n.seconds,r.seconds);return 0!==i?i:rg(n.nanos,r.nanos)}function iB(e){var t,n;return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(e){let t=iT(e);return`time(${t.seconds},${t.nanos})`}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?ix(e.bytesValue).toBase64():"referenceValue"in e?(n=e.referenceValue,rS.fromName(n).toString()):"geoPointValue"in e?`geo(${(t=e.geoPointValue).latitude},${t.longitude})`:"arrayValue"in e?function(e){let t="[",n=!0;for(let r of e.values||[])n?n=!1:t+=",",t+=iB(r);return t+"]"}(e.arrayValue):"mapValue"in e?function(e){let t=Object.keys(e.fields||{}).sort(),n="{",r=!0;for(let i of t)r?r=!1:n+=",",n+=`${i}:${iB(e.fields[i])}`;return n+"}"}(e.mapValue):rr()}function i$(e,t){return{referenceValue:`projects/${e.projectId}/databases/${e.database}/documents/${t.path.canonicalString()}`}}function iV(e){return!!e&&"integerValue"in e}function iG(e){return!!e&&"arrayValue"in e}function iq(e){return!!e&&"nullValue"in e}function iz(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function iK(e){return!!e&&"mapValue"in e}function iY(e){if(e.geoPointValue)return{geoPointValue:Object.assign({},e.geoPointValue)};if(e.timestampValue&&"object"==typeof e.timestampValue)return{timestampValue:Object.assign({},e.timestampValue)};if(e.mapValue){let t={mapValue:{fields:{}}};return id(e.mapValue.fields,(e,n)=>t.mapValue.fields[e]=iY(n)),t}if(e.arrayValue){let n={arrayValue:{values:[]}};for(let r=0;r<(e.arrayValue.values||[]).length;++r)n.arrayValue.values[r]=iY(e.arrayValue.values[r]);return n}return Object.assign({},e)}function iH(e){return"__max__"===(((e.mapValue||{}).fields||{}).__type__||{}).stringValue}function iW(e,t){let n=iF(e.value,t.value);return 0!==n?n:e.inclusive&&!t.inclusive?-1:!e.inclusive&&t.inclusive?1:0}function iQ(e,t){let n=iF(e.value,t.value);return 0!==n?n:e.inclusive&&!t.inclusive?1:!e.inclusive&&t.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ class iX{constructor(e){this.value=e}static empty(){return new iX({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(!iK(t=(t.mapValue.fields||{})[e.get(n)]))return null;return(t=(t.mapValue.fields||{})[e.lastSegment()])||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=iY(t)}setAll(e){let t=rI.emptyPath(),n={},r=[];e.forEach((e,i)=>{if(!t.isImmediateParentOf(i)){let s=this.getFieldsMap(t);this.applyChanges(s,n,r),n={},r=[],t=i.popLast()}e?n[i.lastSegment()]=iY(e):r.push(i.lastSegment())});let i=this.getFieldsMap(t);this.applyChanges(i,n,r)}delete(e){let t=this.field(e.popLast());iK(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return iM(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let r=t.mapValue.fields[e.get(n)];iK(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,n){for(let r of(id(t,(t,n)=>e[t]=n),n))delete e[r]}clone(){return new iX(iY(this.value))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ class iJ{constructor(e,t,n,r,i,s,a){this.key=e,this.documentType=t,this.version=n,this.readTime=r,this.createTime=i,this.data=s,this.documentState=a}static newInvalidDocument(e){return new iJ(e,0,rv.min(),rv.min(),rv.min(),iX.empty(),0)}static newFoundDocument(e,t,n,r){return new iJ(e,1,t,rv.min(),n,r,0)}static newNoDocument(e,t){return new iJ(e,2,t,rv.min(),rv.min(),iX.empty(),0)}static newUnknownDocument(e,t){return new iJ(e,3,t,rv.min(),rv.min(),iX.empty(),2)}convertToFoundDocument(e,t){return this.createTime.isEqual(rv.min())&&(2===this.documentType||0===this.documentType)&&(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=iX.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=iX.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=rv.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof iJ&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new iJ(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ class iZ{constructor(e,t){this.position=e,this.inclusive=t}}function i0(e,t,n){let r=0;for(let i=0;i<e.position.length;i++){let s=t[i],a=e.position[i];if(r=s.field.isKeyField()?rS.comparator(rS.fromName(a.referenceValue),n.key):iF(a,n.data.field(s.field)),"desc"===s.dir&&(r*=-1),0!==r)break}return r}function i1(e,t){if(null===e)return null===t;if(null===t||e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(let n=0;n<e.position.length;n++)if(!iM(e.position[n],t.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ class i2{constructor(e,t="asc"){this.field=e,this.dir=t}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ class i4{}class i9 extends i4{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?"in"===t||"not-in"===t?this.createKeyFieldInFilter(e,t,n):new st(e,t,n):"array-contains"===t?new ss(e,n):"in"===t?new sa(e,n):"not-in"===t?new so(e,n):"array-contains-any"===t?new sl(e,n):new i9(e,t,n)}static createKeyFieldInFilter(e,t,n){return"in"===t?new sn(e,n):new sr(e,n)}matches(e){let t=e.data.field(this.field);return"!="===this.op?null!==t&&this.matchesComparison(iF(t,this.value)):null!==t&&iL(this.value)===iL(t)&&this.matchesComparison(iF(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return rr()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}getFirstInequalityField(){return this.isInequality()?this.field:null}}class i6 extends i4{constructor(e,t){super(),this.filters=e,this.op=t,this.ht=null}static create(e,t){return new i6(e,t)}matches(e){return i5(this)?void 0===this.filters.find(t=>!t.matches(e)):void 0!==this.filters.find(t=>t.matches(e))}getFlattenedFilters(){return null!==this.ht||(this.ht=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ht}getFilters(){return Object.assign([],this.filters)}getFirstInequalityField(){let e=this.lt(e=>e.isInequality());return null!==e?e.field:null}lt(e){for(let t of this.getFlattenedFilters())if(e(t))return t;return null}}function i5(e){return"and"===e.op}function i3(e){return"or"===e.op}function i7(e){return i8(e)&&i5(e)}function i8(e){for(let t of e.filters)if(t instanceof i6)return!1;return!0}function se(e,t){let n=e.filters.concat(t);return i6.create(n,e.op)}class st extends i9{constructor(e,t,n){super(e,t,n),this.key=rS.fromName(n.referenceValue)}matches(e){let t=rS.comparator(e.key,this.key);return this.matchesComparison(t)}}class sn extends i9{constructor(e,t){super(e,"in",t),this.keys=si("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class sr extends i9{constructor(e,t){super(e,"not-in",t),this.keys=si("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function si(e,t){var n;return((null===(n=t.arrayValue)||void 0===n?void 0:n.values)||[]).map(e=>rS.fromName(e.referenceValue))}class ss extends i9{constructor(e,t){super(e,"array-contains",t)}matches(e){let t=e.data.field(this.field);return iG(t)&&iU(t.arrayValue,this.value)}}class sa extends i9{constructor(e,t){super(e,"in",t)}matches(e){let t=e.data.field(this.field);return null!==t&&iU(this.value.arrayValue,t)}}class so extends i9{constructor(e,t){super(e,"not-in",t)}matches(e){if(iU(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let t=e.data.field(this.field);return null!==t&&!iU(this.value.arrayValue,t)}}class sl extends i9{constructor(e,t){super(e,"array-contains-any",t)}matches(e){let t=e.data.field(this.field);return!(!iG(t)||!t.arrayValue.values)&&t.arrayValue.values.some(e=>iU(this.value.arrayValue,e))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ class su{constructor(e,t=null,n=[],r=[],i=null,s=null,a=null){this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=s,this.endAt=a,this.ft=null}}function sc(e,t=null,n=[],r=[],i=null,s=null,a=null){return new su(e,t,n,r,i,s,a)}function sh(e){let t=e;if(null===t.ft){let n=t.path.canonicalString();null!==t.collectionGroup&&(n+="|cg:"+t.collectionGroup),n+="|f:",n+=t.filters.map(e=>(function e(t){if(t instanceof i9)return t.field.canonicalString()+t.op.toString()+iB(t.value);if(i7(t))return t.filters.map(t=>e(t)).join(",");{let n=t.filters.map(t=>e(t)).join(",");return`${t.op}(${n})`}})(e)).join(","),n+="|ob:",n+=t.orderBy.map(e=>e.field.canonicalString()+e.dir).join(","),null==t.limit||(n+="|l:",n+=t.limit),t.startAt&&(n+="|lb:",n+=t.startAt.inclusive?"b:":"a:",n+=t.startAt.position.map(e=>iB(e)).join(",")),t.endAt&&(n+="|ub:",n+=t.endAt.inclusive?"a:":"b:",n+=t.endAt.position.map(e=>iB(e)).join(",")),t.ft=n}return t.ft}function sd(e,t){if(e.limit!==t.limit||e.orderBy.length!==t.orderBy.length)return!1;for(let n=0;n<e.orderBy.length;n++){var r,i;if(r=e.orderBy[n],i=t.orderBy[n],!(r.dir===i.dir&&r.field.isEqual(i.field)))return!1}if(e.filters.length!==t.filters.length)return!1;for(let s=0;s<e.filters.length;s++)if(!function e(t,n){return t instanceof i9?n instanceof i9&&t.op===n.op&&t.field.isEqual(n.field)&&iM(t.value,n.value):t instanceof i6?n instanceof i6&&t.op===n.op&&t.filters.length===n.filters.length&&t.filters.reduce((t,r,i)=>t&&e(r,n.filters[i]),!0):void rr()}(e.filters[s],t.filters[s]))return!1;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!i1(e.startAt,t.startAt)&&i1(e.endAt,t.endAt)}function sf(e){return rS.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}function sp(e,t){return e.filters.filter(e=>e instanceof i9&&e.field.isEqual(t))}function sm(e,t,n){let r=iP,i=!0;for(let s of sp(e,t)){let a=iP,o=!0;switch(s.op){case"<":case"<=":var l;a="nullValue"in(l=s.value)?iP:"booleanValue"in l?{booleanValue:!1}:"integerValue"in l||"doubleValue"in l?{doubleValue:NaN}:"timestampValue"in l?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in l?{stringValue:""}:"bytesValue"in l?{bytesValue:""}:"referenceValue"in l?i$(iA.empty(),rS.empty()):"geoPointValue"in l?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in l?{arrayValue:{}}:"mapValue"in l?{mapValue:{}}:rr();break;case"==":case"in":case">=":a=s.value;break;case">":a=s.value,o=!1;break;case"!=":case"not-in":a=iP}0>iW({value:r,inclusive:i},{value:a,inclusive:o})&&(r=a,i=o)}if(null!==n){for(let u=0;u<e.orderBy.length;++u)if(e.orderBy[u].field.isEqual(t)){let c=n.position[u];0>iW({value:r,inclusive:i},{value:c,inclusive:n.inclusive})&&(r=c,i=n.inclusive);break}}return{value:r,inclusive:i}}function sg(e,t,n){let r=iO,i=!0;for(let s of sp(e,t)){let a=iO,o=!0;switch(s.op){case">=":case">":var l;a="nullValue"in(l=s.value)?{booleanValue:!1}:"booleanValue"in l?{doubleValue:NaN}:"integerValue"in l||"doubleValue"in l?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in l?{stringValue:""}:"stringValue"in l?{bytesValue:""}:"bytesValue"in l?i$(iA.empty(),rS.empty()):"referenceValue"in l?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in l?{arrayValue:{}}:"arrayValue"in l?{mapValue:{}}:"mapValue"in l?iO:rr(),o=!1;break;case"==":case"in":case"<=":a=s.value;break;case"<":a=s.value,o=!1;break;case"!=":case"not-in":a=iO}iQ({value:r,inclusive:i},{value:a,inclusive:o})>0&&(r=a,i=o)}if(null!==n){for(let u=0;u<e.orderBy.length;++u)if(e.orderBy[u].field.isEqual(t)){let c=n.position[u];iQ({value:r,inclusive:i},{value:c,inclusive:n.inclusive})>0&&(r=c,i=n.inclusive);break}}return{value:r,inclusive:i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ class sy{constructor(e,t=null,n=[],r=[],i=null,s="F",a=null,o=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=r,this.limit=i,this.limitType=s,this.startAt=a,this.endAt=o,this.dt=null,this._t=null,this.startAt,this.endAt}}function s_(e){return new sy(e)}function sv(e){return 0===e.filters.length&&null===e.limit&&null==e.startAt&&null==e.endAt&&(0===e.explicitOrderBy.length||1===e.explicitOrderBy.length&&e.explicitOrderBy[0].field.isKeyField())}function sw(e){return e.explicitOrderBy.length>0?e.explicitOrderBy[0].field:null}function sb(e){for(let t of e.filters){let n=t.getFirstInequalityField();if(null!==n)return n}return null}function sE(e){return null!==e.collectionGroup}function sI(e){let t=e;if(null===t.dt){t.dt=[];let n=sb(t),r=sw(t);if(null!==n&&null===r)n.isKeyField()||t.dt.push(new i2(n)),t.dt.push(new i2(rI.keyField(),"asc"));else{let i=!1;for(let s of t.explicitOrderBy)t.dt.push(s),s.field.isKeyField()&&(i=!0);if(!i){let a=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";t.dt.push(new i2(rI.keyField(),a))}}}return t.dt}function sS(e){let t=e;if(!t._t){if("F"===t.limitType)t._t=sc(t.path,t.collectionGroup,sI(t),t.filters,t.limit,t.startAt,t.endAt);else{let n=[];for(let r of sI(t)){let i="desc"===r.dir?"asc":"desc";n.push(new i2(r.field,i))}let s=t.endAt?new iZ(t.endAt.position,t.endAt.inclusive):null,a=t.startAt?new iZ(t.startAt.position,t.startAt.inclusive):null;t._t=sc(t.path,t.collectionGroup,n,t.filters,t.limit,s,a)}}return t._t}function sT(e,t){t.getFirstInequalityField(),sb(e);let n=e.filters.concat([t]);return new sy(e.path,e.collectionGroup,e.explicitOrderBy.slice(),n,e.limit,e.limitType,e.startAt,e.endAt)}function sD(e,t,n){return new sy(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function sx(e,t){return sd(sS(e),sS(t))&&e.limitType===t.limitType}function sk(e){return`${sh(sS(e))}|lt:${e.limitType}`}function sC(e){var t;let n;return`Query(target=${n=(t=sS(e)).path.canonicalString(),null!==t.collectionGroup&&(n+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(n+=`, filters: [${t.filters.map(e=>(function e(t){return t instanceof i9?`${t.field.canonicalString()} ${t.op} ${iB(t.value)}`:t instanceof i6?t.op.toString()+" {"+t.getFilters().map(e).join(" ,")+"}":"Filter"})(e)).join(", ")}]`),null==t.limit||(n+=", limit: "+t.limit),t.orderBy.length>0&&(n+=`, orderBy: [${t.orderBy.map(e=>`${e.field.canonicalString()} (${e.dir})`).join(", ")}]`),t.startAt&&(n+=", startAt: ",n+=t.startAt.inclusive?"b:":"a:",n+=t.startAt.position.map(e=>iB(e)).join(",")),t.endAt&&(n+=", endAt: ",n+=t.endAt.inclusive?"a:":"b:",n+=t.endAt.position.map(e=>iB(e)).join(",")),`Target(${n})`}; limitType=${e.limitType})`}function sN(e,t){return t.isFoundDocument()&&function(e,t){let n=t.key.path;return null!==e.collectionGroup?t.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(n):rS.isDocumentKey(e.path)?e.path.isEqual(n):e.path.isImmediateParentOf(n)}(e,t)&&function(e,t){for(let n of sI(e))if(!n.field.isKeyField()&&null===t.data.field(n.field))return!1;return!0}(e,t)&&function(e,t){for(let n of e.filters)if(!n.matches(t))return!1;return!0}(e,t)&&(!e.startAt||!!function(e,t,n){let r=i0(e,t,n);return e.inclusive?r<=0:r<0}(e.startAt,sI(e),t))&&(!e.endAt||!!function(e,t,n){let r=i0(e,t,n);return e.inclusive?r>=0:r>0}(e.endAt,sI(e),t))}function sR(e){return(t,n)=>{let r=!1;for(let i of sI(e)){let s=function(e,t,n){let r=e.field.isKeyField()?rS.comparator(t.key,n.key):function(e,t,n){let r=t.data.field(e),i=n.data.field(e);return null!==r&&null!==i?iF(r,i):rr()}(e.field,t,n);switch(e.dir){case"asc":return r;case"desc":return -1*r;default:return rr()}}(i,t,n);if(0!==s)return s;r=r||i.field.isKeyField()}return 0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ class sA{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){let t=this.mapKeyFn(e),n=this.inner[t];if(void 0!==n){for(let[r,i]of n)if(this.equalsFn(r,e))return i}}has(e){return void 0!==this.get(e)}set(e,t){let n=this.mapKeyFn(e),r=this.inner[n];if(void 0===r)return this.inner[n]=[[e,t]],void this.innerSize++;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return void(r[i]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){let t=this.mapKeyFn(e),n=this.inner[t];if(void 0===n)return!1;for(let r=0;r<n.length;r++)if(this.equalsFn(n[r][0],e))return 1===n.length?delete this.inner[t]:n.splice(r,1),this.innerSize--,!0;return!1}forEach(e){id(this.inner,(t,n)=>{for(let[r,i]of n)e(r,i)})}isEmpty(){return ip(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ let sO=new im(rS.comparator),sP=new im(rS.comparator);function sL(...e){let t=sP;for(let n of e)t=t.insert(n.key,n);return t}function sM(e){let t=sP;return e.forEach((e,n)=>t=t.insert(e,n.overlayedDocument)),t}function sU(){return new sA(e=>e.toString(),(e,t)=>e.isEqual(t))}let sF=new im(rS.comparator),sj=new i_(rS.comparator);function sB(...e){let t=sj;for(let n of e)t=t.add(n);return t}let s$=new i_(rg);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ function sV(e,t){if(e.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:rW(t)?"-0":t}}function sG(e){return{integerValue:""+e}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ class sq{constructor(){this._=void 0}}function sz(e,t){return e instanceof sX?iV(t)||t&&"doubleValue"in t?t:{integerValue:0}:null}class sK extends sq{}class sY extends sq{constructor(e){super(),this.elements=e}}function sH(e,t){let n=sZ(t);for(let r of e.elements)n.some(e=>iM(e,r))||n.push(r);return{arrayValue:{values:n}}}class sW extends sq{constructor(e){super(),this.elements=e}}function sQ(e,t){let n=sZ(t);for(let r of e.elements)n=n.filter(e=>!iM(e,r));return{arrayValue:{values:n}}}class sX extends sq{constructor(e,t){super(),this.serializer=e,this.wt=t}}function sJ(e){return iD(e.integerValue||e.doubleValue)}function sZ(e){return iG(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ class s0{constructor(e,t){this.field=e,this.transform=t}}class s1{constructor(e,t){this.version=e,this.transformResults=t}}class s2{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new s2}static exists(e){return new s2(void 0,e)}static updateTime(e){return new s2(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function s4(e,t){return void 0!==e.updateTime?t.isFoundDocument()&&t.version.isEqual(e.updateTime):void 0===e.exists||e.exists===t.isFoundDocument()}class s9{}function s6(e,t){if(!e.hasLocalMutations||t&&0===t.fields.length)return null;if(null===t)return e.isNoDocument()?new ar(e.key,s2.none()):new s7(e.key,e.data,s2.none());{let n=e.data,r=iX.empty(),i=new i_(rI.comparator);for(let s of t.fields)if(!i.has(s)){let a=n.field(s);null===a&&s.length>1&&(s=s.popLast(),a=n.field(s)),null===a?r.delete(s):r.set(s,a),i=i.add(s)}return new s8(e.key,r,new ib(i.toArray()),s2.none())}}function s5(e,t,n,r){return e instanceof s7?function(e,t,n,r){if(!s4(e.precondition,t))return n;let i=e.value.clone(),s=an(e.fieldTransforms,r,t);return i.setAll(s),t.convertToFoundDocument(t.version,i).setHasLocalMutations(),null}(e,t,n,r):e instanceof s8?function(e,t,n,r){if(!s4(e.precondition,t))return n;let i=an(e.fieldTransforms,r,t),s=t.data;return(s.setAll(ae(e)),s.setAll(i),t.convertToFoundDocument(t.version,s).setHasLocalMutations(),null===n)?null:n.unionWith(e.fieldMask.fields).unionWith(e.fieldTransforms.map(e=>e.field))}(e,t,n,r):s4(e.precondition,t)?(t.convertToNoDocument(t.version).setHasLocalMutations(),null):n}function s3(e,t){var n,r;return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&(n=e.fieldTransforms,r=t.fieldTransforms,!!(void 0===n&&void 0===r||!(!n||!r)&&ry(n,r,(e,t)=>{var n,r;return e.field.isEqual(t.field)&&(n=e.transform,r=t.transform,n instanceof sY&&r instanceof sY||n instanceof sW&&r instanceof sW?ry(n.elements,r.elements,iM):n instanceof sX&&r instanceof sX?iM(n.wt,r.wt):n instanceof sK&&r instanceof sK)})))&&(0===e.type?e.value.isEqual(t.value):1!==e.type||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}class s7 extends s9{constructor(e,t,n,r=[]){super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class s8 extends s9{constructor(e,t,n,r,i=[]){super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=r,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function ae(e){let t=new Map;return e.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){let r=e.data.field(n);t.set(n,r)}}),t}function at(e,t,n){var r;let i=new Map;e.length===n.length||rr();for(let s=0;s<n.length;s++){let a=e[s],o=a.transform,l=t.data.field(a.field);i.set(a.field,(r=n[s],o instanceof sY?sH(o,l):o instanceof sW?sQ(o,l):r))}return i}function an(e,t,n){let r=new Map;for(let i of e){let s=i.transform,a=n.data.field(i.field);r.set(i.field,s instanceof sK?function(e,t){let n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}};return t&&ik(t)&&(t=iC(t)),t&&(n.fields.__previous_value__=t),{mapValue:n}}(t,a):s instanceof sY?sH(s,a):s instanceof sW?sQ(s,a):function(e,t){let n=sz(e,t),r=sJ(n)+sJ(e.wt);return iV(n)&&iV(e.wt)?sG(r):sV(e.serializer,r)}(s,a))}return r}class ar extends s9{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class ai extends s9{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ class as{constructor(e,t,n,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=r}applyToRemoteDocument(e,t){let n=t.mutationResults;for(let r=0;r<this.mutations.length;r++){let i=this.mutations[r];if(i.key.isEqual(e.key)){var s;s=n[r],i instanceof s7?function(e,t,n){let r=e.value.clone(),i=at(e.fieldTransforms,t,n.transformResults);r.setAll(i),t.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(i,e,s):i instanceof s8?function(e,t,n){if(!s4(e.precondition,t))return void t.convertToUnknownDocument(n.version);let r=at(e.fieldTransforms,t,n.transformResults),i=t.data;i.setAll(ae(e)),i.setAll(r),t.convertToFoundDocument(n.version,i).setHasCommittedMutations()}(i,e,s):function(e,t,n){t.convertToNoDocument(n.version).setHasCommittedMutations()}(0,e,s)}}}applyToLocalView(e,t){for(let n of this.baseMutations)n.key.isEqual(e.key)&&(t=s5(n,e,t,this.localWriteTime));for(let r of this.mutations)r.key.isEqual(e.key)&&(t=s5(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){let n=sU();return this.mutations.forEach(r=>{let i=e.get(r.key),s=i.overlayedDocument,a=this.applyToLocalView(s,i.mutatedFields);a=t.has(r.key)?null:a;let o=s6(s,a);null!==o&&n.set(r.key,o),s.isValidDocument()||s.convertToNoDocument(rv.min())}),n}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),sB())}isEqual(e){return this.batchId===e.batchId&&ry(this.mutations,e.mutations,(e,t)=>s3(e,t))&&ry(this.baseMutations,e.baseMutations,(e,t)=>s3(e,t))}}class aa{constructor(e,t,n,r){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=r}static from(e,t,n){e.mutations.length===n.length||rr();let r=sF,i=e.mutations;for(let s=0;s<i.length;s++)r=r.insert(i[s].key,n[s].version);return new aa(e,t,n,r)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ class ao{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ class al{constructor(e,t,n){this.alias=e,this.gt=t,this.fieldPath=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ class au{constructor(e,t){this.count=e,this.unchangedNames=t}}function ac(e){if(void 0===e)return re("GRPC error has no .code"),ri.UNKNOWN;switch(e){case l.OK:return ri.OK;case l.CANCELLED:return ri.CANCELLED;case l.UNKNOWN:return ri.UNKNOWN;case l.DEADLINE_EXCEEDED:return ri.DEADLINE_EXCEEDED;case l.RESOURCE_EXHAUSTED:return ri.RESOURCE_EXHAUSTED;case l.INTERNAL:return ri.INTERNAL;case l.UNAVAILABLE:return ri.UNAVAILABLE;case l.UNAUTHENTICATED:return ri.UNAUTHENTICATED;case l.INVALID_ARGUMENT:return ri.INVALID_ARGUMENT;case l.NOT_FOUND:return ri.NOT_FOUND;case l.ALREADY_EXISTS:return ri.ALREADY_EXISTS;case l.PERMISSION_DENIED:return ri.PERMISSION_DENIED;case l.FAILED_PRECONDITION:return ri.FAILED_PRECONDITION;case l.ABORTED:return ri.ABORTED;case l.OUT_OF_RANGE:return ri.OUT_OF_RANGE;case l.UNIMPLEMENTED:return ri.UNIMPLEMENTED;case l.DATA_LOSS:return ri.DATA_LOSS;default:return rr()}}(u=l||(l={}))[u.OK=0]="OK",u[u.CANCELLED=1]="CANCELLED",u[u.UNKNOWN=2]="UNKNOWN",u[u.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",u[u.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",u[u.NOT_FOUND=5]="NOT_FOUND",u[u.ALREADY_EXISTS=6]="ALREADY_EXISTS",u[u.PERMISSION_DENIED=7]="PERMISSION_DENIED",u[u.UNAUTHENTICATED=16]="UNAUTHENTICATED",u[u.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",u[u.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",u[u.ABORTED=10]="ABORTED",u[u.OUT_OF_RANGE=11]="OUT_OF_RANGE",u[u.UNIMPLEMENTED=12]="UNIMPLEMENTED",u[u.INTERNAL=13]="INTERNAL",u[u.UNAVAILABLE=14]="UNAVAILABLE",u[u.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ class ah{constructor(){this.onExistenceFilterMismatchCallbacks=new Map}static get instance(){return ad}static getOrCreateInstance(){return null===ad&&(ad=new ah),ad}onExistenceFilterMismatch(e){let t=Symbol();return this.onExistenceFilterMismatchCallbacks.set(t,e),()=>this.onExistenceFilterMismatchCallbacks.delete(t)}notifyOnExistenceFilterMismatch(e){this.onExistenceFilterMismatchCallbacks.forEach(t=>t(e))}}let ad=null,af=new n2([4294967295,4294967295],0);function ap(e){let t=(new TextEncoder).encode(e),n=new n1;return n.update(t),new Uint8Array(n.digest())}function am(e){let t=new DataView(e.buffer),n=t.getUint32(0,!0),r=t.getUint32(4,!0),i=t.getUint32(8,!0),s=t.getUint32(12,!0);return[new n2([n,r],0),new n2([i,s],0)]}class ag{constructor(e,t,n){if(this.bitmap=e,this.padding=t,this.hashCount=n,t<0||t>=8)throw new ay(`Invalid padding: ${t}`);if(n<0||e.length>0&&0===this.hashCount)throw new ay(`Invalid hash count: ${n}`);if(0===e.length&&0!==t)throw new ay(`Invalid padding when bitmap length is 0: ${t}`);this.yt=8*e.length-t,this.It=n2.fromNumber(this.yt)}Tt(e,t,n){let r=e.add(t.multiply(n2.fromNumber(n)));return 1===r.compare(af)&&(r=new n2([r.getBits(0),r.getBits(1)],0)),r.modulo(this.It).toNumber()}Et(e){return 0!=(this.bitmap[Math.floor(e/8)]&1<<e%8)}At(e){if(0===this.yt)return!1;let t=ap(e),[n,r]=am(t);for(let i=0;i<this.hashCount;i++){let s=this.Tt(n,r,i);if(!this.Et(s))return!1}return!0}static create(e,t,n){let r=new Uint8Array(Math.ceil(e/8)),i=new ag(r,e%8==0?0:8-e%8,t);return n.forEach(e=>i.insert(e)),i}insert(e){if(0===this.yt)return;let t=ap(e),[n,r]=am(t);for(let i=0;i<this.hashCount;i++){let s=this.Tt(n,r,i);this.Rt(s)}}Rt(e){let t=Math.floor(e/8);this.bitmap[t]|=1<<e%8}}class ay extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ class a_{constructor(e,t,n,r,i){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,t,n){let r=new Map;return r.set(e,av.createSynthesizedTargetChangeForCurrentChange(e,t,n)),new a_(rv.min(),r,new im(rg),sO,sB())}}class av{constructor(e,t,n,r,i){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,t,n){return new av(n,t,sB(),sB(),sB())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ class aw{constructor(e,t,n,r){this.vt=e,this.removedTargetIds=t,this.key=n,this.Pt=r}}class ab{constructor(e,t){this.targetId=e,this.bt=t}}class aE{constructor(e,t,n=iI.EMPTY_BYTE_STRING,r=null){this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=r}}class aI{constructor(){this.Vt=0,this.St=aD(),this.Dt=iI.EMPTY_BYTE_STRING,this.Ct=!1,this.xt=!0}get current(){return this.Ct}get resumeToken(){return this.Dt}get Nt(){return 0!==this.Vt}get kt(){return this.xt}Mt(e){e.approximateByteSize()>0&&(this.xt=!0,this.Dt=e)}Ot(){let e=sB(),t=sB(),n=sB();return this.St.forEach((r,i)=>{switch(i){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:n=n.add(r);break;default:rr()}}),new av(this.Dt,this.Ct,e,t,n)}$t(){this.xt=!1,this.St=aD()}Ft(e,t){this.xt=!0,this.St=this.St.insert(e,t)}Bt(e){this.xt=!0,this.St=this.St.remove(e)}Lt(){this.Vt+=1}qt(){this.Vt-=1}Ut(){this.xt=!0,this.Ct=!0}}class aS{constructor(e){this.Kt=e,this.Gt=new Map,this.Qt=sO,this.jt=aT(),this.zt=new im(rg)}Wt(e){for(let t of e.vt)e.Pt&&e.Pt.isFoundDocument()?this.Ht(t,e.Pt):this.Jt(t,e.key,e.Pt);for(let n of e.removedTargetIds)this.Jt(n,e.key,e.Pt)}Yt(e){this.forEachTarget(e,t=>{let n=this.Xt(t);switch(e.state){case 0:this.Zt(t)&&n.Mt(e.resumeToken);break;case 1:n.qt(),n.Nt||n.$t(),n.Mt(e.resumeToken);break;case 2:n.qt(),n.Nt||this.removeTarget(t);break;case 3:this.Zt(t)&&(n.Ut(),n.Mt(e.resumeToken));break;case 4:this.Zt(t)&&(this.te(t),n.Mt(e.resumeToken));break;default:rr()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Gt.forEach((e,n)=>{this.Zt(n)&&t(n)})}ee(e){var t;let n=e.targetId,r=e.bt.count,i=this.ne(n);if(i){let s=i.target;if(sf(s)){if(0===r){let a=new rS(s.path);this.Jt(n,a,iJ.newNoDocument(a,rv.min()))}else 1===r||rr()}else{let o=this.se(n);if(o!==r){let l=this.ie(e,o);0!==l&&(this.te(n),this.zt=this.zt.insert(n,2===l?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch")),null===(t=ah.instance)||void 0===t||t.notifyOnExistenceFilterMismatch(function(e,t,n){var r,i,s,a,o,l;let u={localCacheCount:t,existenceFilterCount:n.count},c=n.unchangedNames;return c&&(u.bloomFilter={applied:0===e,hashCount:null!==(r=null==c?void 0:c.hashCount)&&void 0!==r?r:0,bitmapLength:null!==(a=null===(s=null===(i=null==c?void 0:c.bits)||void 0===i?void 0:i.bitmap)||void 0===s?void 0:s.length)&&void 0!==a?a:0,padding:null!==(l=null===(o=null==c?void 0:c.bits)||void 0===o?void 0:o.padding)&&void 0!==l?l:0}),u}(l,o,e.bt))}}}}ie(e,t){let n,r;let{unchangedNames:i,count:s}=e.bt;if(!i||!i.bits)return 1;let{bits:{bitmap:a="",padding:o=0},hashCount:l=0}=i;try{n=ix(a).toUint8Array()}catch(u){if(u instanceof iE)return rt("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),1;throw u}try{r=new ag(n,o,l)}catch(c){return rt(c instanceof ay?"BloomFilter error: ":"Applying bloom filter failed: ",c),1}return 0===r.yt?1:s!==t-this.re(e.targetId,r)?2:0}re(e,t){let n=this.Kt.getRemoteKeysForTarget(e),r=0;return n.forEach(n=>{let i=this.Kt.oe(),s=`projects/${i.projectId}/databases/${i.database}/documents/${n.path.canonicalString()}`;t.At(s)||(this.Jt(e,n,null),r++)}),r}ue(e){let t=new Map;this.Gt.forEach((n,r)=>{let i=this.ne(r);if(i){if(n.current&&sf(i.target)){let s=new rS(i.target.path);null!==this.Qt.get(s)||this.ce(r,s)||this.Jt(r,s,iJ.newNoDocument(s,e))}n.kt&&(t.set(r,n.Ot()),n.$t())}});let n=sB();this.jt.forEach((e,t)=>{let r=!0;t.forEachWhile(e=>{let t=this.ne(e);return!t||"TargetPurposeLimboResolution"===t.purpose||(r=!1,!1)}),r&&(n=n.add(e))}),this.Qt.forEach((t,n)=>n.setReadTime(e));let r=new a_(e,t,this.zt,this.Qt,n);return this.Qt=sO,this.jt=aT(),this.zt=new im(rg),r}Ht(e,t){if(!this.Zt(e))return;let n=this.ce(e,t.key)?2:0;this.Xt(e).Ft(t.key,n),this.Qt=this.Qt.insert(t.key,t),this.jt=this.jt.insert(t.key,this.ae(t.key).add(e))}Jt(e,t,n){if(!this.Zt(e))return;let r=this.Xt(e);this.ce(e,t)?r.Ft(t,1):r.Bt(t),this.jt=this.jt.insert(t,this.ae(t).delete(e)),n&&(this.Qt=this.Qt.insert(t,n))}removeTarget(e){this.Gt.delete(e)}se(e){let t=this.Xt(e).Ot();return this.Kt.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Lt(e){this.Xt(e).Lt()}Xt(e){let t=this.Gt.get(e);return t||(t=new aI,this.Gt.set(e,t)),t}ae(e){let t=this.jt.get(e);return t||(t=new i_(rg),this.jt=this.jt.insert(e,t)),t}Zt(e){let t=null!==this.ne(e);return t||n8("WatchChangeAggregator","Detected inactive target",e),t}ne(e){let t=this.Gt.get(e);return t&&t.Nt?null:this.Kt.he(e)}te(e){this.Gt.set(e,new aI),this.Kt.getRemoteKeysForTarget(e).forEach(t=>{this.Jt(e,t,null)})}ce(e,t){return this.Kt.getRemoteKeysForTarget(e).has(t)}}function aT(){return new im(rS.comparator)}function aD(){return new im(rS.comparator)}let ax={asc:"ASCENDING",desc:"DESCENDING"},ak={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},aC={and:"AND",or:"OR"};class aN{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function aR(e,t){return e.useProto3Json||null==t?t:{value:t}}function aA(e,t){return e.useProto3Json?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}function aO(e,t){return e.useProto3Json?t.toBase64():t.toUint8Array()}function aP(e){return e||rr(),rv.fromTimestamp(function(e){let t=iT(e);return new r_(t.seconds,t.nanos)}(e))}function aL(e,t){return new rb(["projects",e.projectId,"databases",e.database]).child("documents").child(t).canonicalString()}function aM(e){let t=rb.fromString(e);return aX(t)||rr(),t}function aU(e,t){return aL(e.databaseId,t.path)}function aF(e,t){let n=aM(t);if(n.get(1)!==e.databaseId.projectId)throw new rs(ri.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new rs(ri.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+e.databaseId.database);return new rS(aV(n))}function aj(e,t){return aL(e.databaseId,t)}function aB(e){let t=aM(e);return 4===t.length?rb.emptyPath():aV(t)}function a$(e){return new rb(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function aV(e){return e.length>4&&"documents"===e.get(4)||rr(),e.popFirst(5)}function aG(e,t,n){return{name:aU(e,t),fields:n.value.mapValue.fields}}function aq(e,t){var n;let r;if(t instanceof s7)r={update:aG(e,t.key,t.value)};else if(t instanceof ar)r={delete:aU(e,t.key)};else if(t instanceof s8)r={update:aG(e,t.key,t.data),updateMask:function(e){let t=[];return e.fields.forEach(e=>t.push(e.canonicalString())),{fieldPaths:t}}(t.fieldMask)};else{if(!(t instanceof ai))return rr();r={verify:aU(e,t.key)}}return t.fieldTransforms.length>0&&(r.updateTransforms=t.fieldTransforms.map(e=>(function(e,t){let n=t.transform;if(n instanceof sK)return{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof sY)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof sW)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof sX)return{fieldPath:t.field.canonicalString(),increment:n.wt};throw rr()})(0,e))),t.precondition.isNone||(r.currentDocument=void 0!==(n=t.precondition).updateTime?{updateTime:aA(e,n.updateTime.toTimestamp())}:void 0!==n.exists?{exists:n.exists}:rr()),r}function az(e,t){var n;let r=t.currentDocument?void 0!==(n=t.currentDocument).updateTime?s2.updateTime(aP(n.updateTime)):void 0!==n.exists?s2.exists(n.exists):s2.none():s2.none(),i=t.updateTransforms?t.updateTransforms.map(t=>(function(e,t){let n=null;if("setToServerValue"in t)"REQUEST_TIME"===t.setToServerValue||rr(),n=new sK;else if("appendMissingElements"in t){let r=t.appendMissingElements.values||[];n=new sY(r)}else if("removeAllFromArray"in t){let i=t.removeAllFromArray.values||[];n=new sW(i)}else"increment"in t?n=new sX(e,t.increment):rr();let s=rI.fromServerFormat(t.fieldPath);return new s0(s,n)})(e,t)):[];if(t.update){t.update.name;let s=aF(e,t.update.name),a=new iX({mapValue:{fields:t.update.fields}});if(t.updateMask){let o=function(e){let t=e.fieldPaths||[];return new ib(t.map(e=>rI.fromServerFormat(e)))}(t.updateMask);return new s8(s,a,o,r,i)}return new s7(s,a,r,i)}if(t.delete){let l=aF(e,t.delete);return new ar(l,r)}if(t.verify){let u=aF(e,t.verify);return new ai(u,r)}return rr()}function aK(e,t){return{documents:[aj(e,t.path)]}}function aY(e,t){var n,r;let i={structuredQuery:{}},s=t.path;null!==t.collectionGroup?(i.parent=aj(e,s),i.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(i.parent=aj(e,s.popLast()),i.structuredQuery.from=[{collectionId:s.lastSegment()}]);let a=function(e){if(0!==e.length)return function e(t){return t instanceof i9?function(e){if("=="===e.op){if(iz(e.value))return{unaryFilter:{field:aW(e.field),op:"IS_NAN"}};if(iq(e.value))return{unaryFilter:{field:aW(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(iz(e.value))return{unaryFilter:{field:aW(e.field),op:"IS_NOT_NAN"}};if(iq(e.value))return{unaryFilter:{field:aW(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:aW(e.field),op:ak[e.op],value:e.value}}}(t):t instanceof i6?function(t){let n=t.getFilters().map(t=>e(t));return 1===n.length?n[0]:{compositeFilter:{op:aC[t.op],filters:n}}}(t):rr()}(i6.create(e,"and"))}(t.filters);a&&(i.structuredQuery.where=a);let o=function(e){if(0!==e.length)return e.map(e=>({field:aW(e.field),direction:ax[e.dir]}))}(t.orderBy);o&&(i.structuredQuery.orderBy=o);let l=aR(e,t.limit);return null!==l&&(i.structuredQuery.limit=l),t.startAt&&(i.structuredQuery.startAt={before:(n=t.startAt).inclusive,values:n.position}),t.endAt&&(i.structuredQuery.endAt={before:!(r=t.endAt).inclusive,values:r.position}),i}function aH(e){var t,n,r,i,s,a,o,l;let u,c=aB(e.parent),h=e.structuredQuery,d=h.from?h.from.length:0,f=null;if(d>0){1===d||rr();let p=h.from[0];p.allDescendants?f=p.collectionId:c=c.child(p.collectionId)}let m=[];h.where&&(m=function(e){let t=function e(t){return void 0!==t.unaryFilter?function(e){switch(e.unaryFilter.op){case"IS_NAN":let t=aQ(e.unaryFilter.field);return i9.create(t,"==",{doubleValue:NaN});case"IS_NULL":let n=aQ(e.unaryFilter.field);return i9.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let r=aQ(e.unaryFilter.field);return i9.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let i=aQ(e.unaryFilter.field);return i9.create(i,"!=",{nullValue:"NULL_VALUE"});default:return rr()}}(t):void 0!==t.fieldFilter?i9.create(aQ(t.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return rr()}}(t.fieldFilter.op),t.fieldFilter.value):void 0!==t.compositeFilter?i6.create(t.compositeFilter.filters.map(t=>e(t)),function(e){switch(e){case"AND":return"and";case"OR":return"or";default:return rr()}}(t.compositeFilter.op)):rr()}(e);return t instanceof i6&&i7(t)?t.getFilters():[t]}(h.where));let g=[];h.orderBy&&(g=h.orderBy.map(e=>new i2(aQ(e.field),function(e){switch(e){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(e.direction))));let y=null;h.limit&&(y=null==(u="object"==typeof(t=h.limit)?t.value:t)?null:u);let _=null;h.startAt&&(_=function(e){let t=!!e.before,n=e.values||[];return new iZ(n,t)}(h.startAt));let v=null;return h.endAt&&(v=function(e){let t=!e.before,n=e.values||[];return new iZ(n,t)}(h.endAt)),n=c,r=f,i=g,s=m,a=y,o=_,l=v,new sy(n,r,i,s,a,"F",o,l)}function aW(e){return{fieldPath:e.canonicalString()}}function aQ(e){return rI.fromServerFormat(e.fieldPath)}function aX(e){return e.length>=4&&"projects"===e.get(0)&&"databases"===e.get(2)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ class aJ{constructor(e,t,n,r,i=rv.min(),s=rv.min(),a=iI.EMPTY_BYTE_STRING,o=null){this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=s,this.resumeToken=a,this.expectedCount=o}withSequenceNumber(e){return new aJ(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new aJ(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new aJ(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new aJ(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ class aZ{constructor(e){this.le=e}}function a0(e,t){let n=t.key,r={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:a1(t.readTime),hasCommittedMutations:t.hasCommittedMutations};if(t.isFoundDocument()){var i;r.document={name:aU(i=e.le,t.key),fields:t.data.value.mapValue.fields,updateTime:aA(i,t.version.toTimestamp()),createTime:aA(i,t.createTime.toTimestamp())}}else if(t.isNoDocument())r.noDocument={path:n.path.toArray(),readTime:a2(t.version)};else{if(!t.isUnknownDocument())return rr();r.unknownDocument={path:n.path.toArray(),version:a2(t.version)}}return r}function a1(e){let t=e.toTimestamp();return[t.seconds,t.nanoseconds]}function a2(e){let t=e.toTimestamp();return{seconds:t.seconds,nanoseconds:t.nanoseconds}}function a4(e){let t=new r_(e.seconds,e.nanoseconds);return rv.fromTimestamp(t)}function a9(e,t){let n=(t.baseMutations||[]).map(t=>az(e.le,t));for(let r=0;r<t.mutations.length-1;++r){let i=t.mutations[r];if(r+1<t.mutations.length&&void 0!==t.mutations[r+1].transform){let s=t.mutations[r+1];i.updateTransforms=s.transform.fieldTransforms,t.mutations.splice(r+1,1),++r}}let a=t.mutations.map(t=>az(e.le,t)),o=r_.fromMillis(t.localWriteTimeMs);return new as(t.batchId,o,n,a)}function a6(e){var t;let n;let r=a4(e.readTime),i=void 0!==e.lastLimboFreeSnapshotVersion?a4(e.lastLimboFreeSnapshotVersion):rv.min();return void 0!==e.query.documents?(1===(t=e.query).documents.length||rr(),n=sS(s_(aB(t.documents[0])))):n=sS(aH(e.query)),new aJ(n,e.targetId,"TargetPurposeListen",e.lastListenSequenceNumber,r,i,iI.fromBase64String(e.resumeToken))}function a5(e,t){let n;let r=a2(t.snapshotVersion),i=a2(t.lastLimboFreeSnapshotVersion);n=sf(t.target)?aK(e.le,t.target):aY(e.le,t.target);let s=t.resumeToken.toBase64();return{targetId:t.targetId,canonicalId:sh(t.target),readTime:r,resumeToken:s,lastListenSequenceNumber:t.sequenceNumber,lastLimboFreeSnapshotVersion:i,query:n}}function a3(e){let t=aH({parent:e.parent,structuredQuery:e.structuredQuery});return"LAST"===e.limitType?sD(t,t.limit,"L"):t}function a7(e,t){return new ao(t.largestBatchId,az(e.le,t.overlayMutation))}function a8(e,t){let n=t.path.lastSegment();return[e,rQ(t.path.popLast()),n]}function oe(e,t,n,r){return{indexId:e,uid:t.uid||"",sequenceNumber:n,readTime:a2(r.readTime),documentKey:rQ(r.documentKey.path),largestBatchId:r.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ class ot{getBundleMetadata(e,t){return on(e).get(t).next(e=>{if(e)return{id:e.bundleId,createTime:a4(e.createTime),version:e.version}})}saveBundleMetadata(e,t){return on(e).put({bundleId:t.id,createTime:a2(aP(t.createTime)),version:t.version})}getNamedQuery(e,t){return or(e).get(t).next(e=>{if(e)return{name:e.name,query:a3(e.bundledQuery),readTime:a4(e.readTime)}})}saveNamedQuery(e,t){return or(e).put({name:t.name,readTime:a2(aP(t.readTime)),bundledQuery:t.bundledQuery})}}function on(e){return ic(e,"bundles")}function or(e){return ic(e,"namedQueries")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ class oi{constructor(e,t){this.serializer=e,this.userId=t}static fe(e,t){let n=t.uid||"";return new oi(e,n)}getOverlay(e,t){return os(e).get(a8(this.userId,t)).next(e=>e?a7(this.serializer,e):null)}getOverlays(e,t){let n=sU();return rM.forEach(t,t=>this.getOverlay(e,t).next(e=>{null!==e&&n.set(t,e)})).next(()=>n)}saveOverlays(e,t,n){let r=[];return n.forEach((n,i)=>{let s=new ao(t,i);r.push(this.de(e,s))}),rM.waitFor(r)}removeOverlaysForBatchId(e,t,n){let r=new Set;t.forEach(e=>r.add(rQ(e.getCollectionPath())));let i=[];return r.forEach(t=>{let r=IDBKeyRange.bound([this.userId,t,n],[this.userId,t,n+1],!1,!0);i.push(os(e).J("collectionPathOverlayIndex",r))}),rM.waitFor(i)}getOverlaysForCollection(e,t,n){let r=sU(),i=rQ(t),s=IDBKeyRange.bound([this.userId,i,n],[this.userId,i,Number.POSITIVE_INFINITY],!0);return os(e).j("collectionPathOverlayIndex",s).next(e=>{for(let t of e){let n=a7(this.serializer,t);r.set(n.getKey(),n)}return r})}getOverlaysForCollectionGroup(e,t,n,r){let i;let s=sU(),a=IDBKeyRange.bound([this.userId,t,n],[this.userId,t,Number.POSITIVE_INFINITY],!0);return os(e).X({index:"collectionGroupOverlayIndex",range:a},(e,t,n)=>{let a=a7(this.serializer,t);s.size()<r||a.largestBatchId===i?(s.set(a.getKey(),a),i=a.largestBatchId):n.done()}).next(()=>s)}de(e,t){return os(e).put(function(e,t,n){let[r,i,s]=a8(t,n.mutation.key);return{userId:t,collectionPath:i,documentId:s,collectionGroup:n.mutation.key.getCollectionGroup(),largestBatchId:n.largestBatchId,overlayMutation:aq(e.le,n.mutation)}}(this.serializer,this.userId,t))}}function os(e){return ic(e,"documentOverlays")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ class oa{constructor(){}_e(e,t){this.we(e,t),t.me()}we(e,t){if("nullValue"in e)this.ge(t,5);else if("booleanValue"in e)this.ge(t,10),t.ye(e.booleanValue?1:0);else if("integerValue"in e)this.ge(t,15),t.ye(iD(e.integerValue));else if("doubleValue"in e){let n=iD(e.doubleValue);isNaN(n)?this.ge(t,13):(this.ge(t,15),rW(n)?t.ye(0):t.ye(n))}else if("timestampValue"in e){let r=e.timestampValue;this.ge(t,20),"string"==typeof r?t.pe(r):(t.pe(`${r.seconds||""}`),t.ye(r.nanos||0))}else if("stringValue"in e)this.Ie(e.stringValue,t),this.Te(t);else if("bytesValue"in e)this.ge(t,30),t.Ee(ix(e.bytesValue)),this.Te(t);else if("referenceValue"in e)this.Ae(e.referenceValue,t);else if("geoPointValue"in e){let i=e.geoPointValue;this.ge(t,45),t.ye(i.latitude||0),t.ye(i.longitude||0)}else"mapValue"in e?iH(e)?this.ge(t,Number.MAX_SAFE_INTEGER):(this.Re(e.mapValue,t),this.Te(t)):"arrayValue"in e?(this.ve(e.arrayValue,t),this.Te(t)):rr()}Ie(e,t){this.ge(t,25),this.Pe(e,t)}Pe(e,t){t.pe(e)}Re(e,t){let n=e.fields||{};for(let r of(this.ge(t,55),Object.keys(n)))this.Ie(r,t),this.we(n[r],t)}ve(e,t){let n=e.values||[];for(let r of(this.ge(t,50),n))this.we(r,t)}Ae(e,t){this.ge(t,37),rS.fromName(e).path.forEach(e=>{this.ge(t,60),this.Pe(e,t)})}ge(e,t){e.ye(t)}Te(e){e.ye(2)}}function oo(e){let t=64-function(e){let t=0;for(let n=0;n<8;++n){let r=function(e){if(0===e)return 8;let t=0;return e>>4==0&&(t+=4,e<<=4),e>>6==0&&(t+=2,e<<=2),e>>7==0&&(t+=1),t}(255&e[n]);if(t+=r,8!==r)break}return t}(e);return Math.ceil(t/8)}oa.be=new oa;class ol{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Ve(e){let t=e[Symbol.iterator](),n=t.next();for(;!n.done;)this.Se(n.value),n=t.next();this.De()}Ce(e){let t=e[Symbol.iterator](),n=t.next();for(;!n.done;)this.xe(n.value),n=t.next();this.Ne()}ke(e){for(let t of e){let n=t.charCodeAt(0);if(n<128)this.Se(n);else if(n<2048)this.Se(960|n>>>6),this.Se(128|63&n);else if(t<"\ud800"||"\udbff"<t)this.Se(480|n>>>12),this.Se(128|63&n>>>6),this.Se(128|63&n);else{let r=t.codePointAt(0);this.Se(240|r>>>18),this.Se(128|63&r>>>12),this.Se(128|63&r>>>6),this.Se(128|63&r)}}this.De()}Me(e){for(let t of e){let n=t.charCodeAt(0);if(n<128)this.xe(n);else if(n<2048)this.xe(960|n>>>6),this.xe(128|63&n);else if(t<"\ud800"||"\udbff"<t)this.xe(480|n>>>12),this.xe(128|63&n>>>6),this.xe(128|63&n);else{let r=t.codePointAt(0);this.xe(240|r>>>18),this.xe(128|63&r>>>12),this.xe(128|63&r>>>6),this.xe(128|63&r)}}this.Ne()}Oe(e){let t=this.$e(e),n=oo(t);this.Fe(1+n),this.buffer[this.position++]=255&n;for(let r=t.length-n;r<t.length;++r)this.buffer[this.position++]=255&t[r]}Be(e){let t=this.$e(e),n=oo(t);this.Fe(1+n),this.buffer[this.position++]=~(255&n);for(let r=t.length-n;r<t.length;++r)this.buffer[this.position++]=~(255&t[r])}Le(){this.qe(255),this.qe(255)}Ue(){this.Ke(255),this.Ke(255)}reset(){this.position=0}seed(e){this.Fe(e.length),this.buffer.set(e,this.position),this.position+=e.length}Ge(){return this.buffer.slice(0,this.position)}$e(e){let t=function(e){let t=new DataView(new ArrayBuffer(8));return t.setFloat64(0,e,!1),new Uint8Array(t.buffer)}(e),n=0!=(128&t[0]);t[0]^=n?255:128;for(let r=1;r<t.length;++r)t[r]^=n?255:0;return t}Se(e){let t=255&e;0===t?(this.qe(0),this.qe(255)):255===t?(this.qe(255),this.qe(0)):this.qe(t)}xe(e){let t=255&e;0===t?(this.Ke(0),this.Ke(255)):255===t?(this.Ke(255),this.Ke(0)):this.Ke(e)}De(){this.qe(0),this.qe(1)}Ne(){this.Ke(0),this.Ke(1)}qe(e){this.Fe(1),this.buffer[this.position++]=e}Ke(e){this.Fe(1),this.buffer[this.position++]=~e}Fe(e){let t=e+this.position;if(t<=this.buffer.length)return;let n=2*this.buffer.length;n<t&&(n=t);let r=new Uint8Array(n);r.set(this.buffer),this.buffer=r}}class ou{constructor(e){this.Qe=e}Ee(e){this.Qe.Ve(e)}pe(e){this.Qe.ke(e)}ye(e){this.Qe.Oe(e)}me(){this.Qe.Le()}}class oc{constructor(e){this.Qe=e}Ee(e){this.Qe.Ce(e)}pe(e){this.Qe.Me(e)}ye(e){this.Qe.Be(e)}me(){this.Qe.Ue()}}class oh{constructor(){this.Qe=new ol,this.je=new ou(this.Qe),this.ze=new oc(this.Qe)}seed(e){this.Qe.seed(e)}We(e){return 0===e?this.je:this.ze}Ge(){return this.Qe.Ge()}reset(){this.Qe.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ class od{constructor(e,t,n,r){this.indexId=e,this.documentKey=t,this.arrayValue=n,this.directionalValue=r}He(){let e=this.directionalValue.length,t=0===e||255===this.directionalValue[e-1]?e+1:e,n=new Uint8Array(t);return n.set(this.directionalValue,0),t!==e?n.set([0],this.directionalValue.length):++n[n.length-1],new od(this.indexId,this.documentKey,this.arrayValue,n)}}function of(e,t){let n=e.indexId-t.indexId;return 0!==n?n:0!==(n=op(e.arrayValue,t.arrayValue))?n:0!==(n=op(e.directionalValue,t.directionalValue))?n:rS.comparator(e.documentKey,t.documentKey)}function op(e,t){for(let n=0;n<e.length&&n<t.length;++n){let r=e[n]-t[n];if(0!==r)return r}return e.length-t.length}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ class om{constructor(e){for(let t of(this.collectionId=null!=e.collectionGroup?e.collectionGroup:e.path.lastSegment(),this.Je=e.orderBy,this.Ye=[],e.filters)){let n=t;n.isInequality()?this.Xe=n:this.Ye.push(n)}}Ze(e){e.collectionGroup===this.collectionId||rr();let t=rD(e);if(void 0!==t&&!this.tn(t))return!1;let n=rx(e),r=0,i=0;for(;r<n.length&&this.tn(n[r]);++r);if(r===n.length)return!0;if(void 0!==this.Xe){let s=n[r];if(!this.en(this.Xe,s)||!this.nn(this.Je[i++],s))return!1;++r}for(;r<n.length;++r){let a=n[r];if(i>=this.Je.length||!this.nn(this.Je[i++],a))return!1}return!0}tn(e){for(let t of this.Ye)if(this.en(t,e))return!0;return!1}en(e,t){if(void 0===e||!e.field.isEqual(t.fieldPath))return!1;let n="array-contains"===e.op||"array-contains-any"===e.op;return 2===t.kind===n}nn(e,t){return!!e.field.isEqual(t.fieldPath)&&(0===t.kind&&"asc"===e.dir||1===t.kind&&"desc"===e.dir)}}function og(e){return e instanceof i9}function oy(e){return e instanceof i6&&i7(e)}function o_(e){return og(e)||oy(e)||function(e){if(e instanceof i6&&i3(e)){for(let t of e.getFilters())if(!og(t)&&!oy(t))return!1;return!0}return!1}(e)}function ov(e,t){return e instanceof i9||e instanceof i6||rr(),t instanceof i9||t instanceof i6||rr(),ob(e instanceof i9?t instanceof i9?i6.create([e,t],"and"):ow(e,t):t instanceof i9?ow(t,e):function(e,t){if(e.filters.length>0&&t.filters.length>0||rr(),i5(e)&&i5(t))return se(e,t.getFilters());let n=i3(e)?e:t,r=i3(e)?t:e,i=n.filters.map(e=>ov(e,r));return i6.create(i,"or")}(e,t))}function ow(e,t){if(i5(t))return se(t,e.getFilters());{let n=t.filters.map(t=>ov(e,t));return i6.create(n,"or")}}function ob(e){if(e instanceof i9||e instanceof i6||rr(),e instanceof i9)return e;let t=e.getFilters();if(1===t.length)return ob(t[0]);if(i8(e))return e;let n=t.map(e=>ob(e)),r=[];return n.forEach(t=>{t instanceof i9?r.push(t):t instanceof i6&&(t.op===e.op?r.push(...t.filters):r.push(t))}),1===r.length?r[0]:i6.create(r,e.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ class oE{constructor(){this.sn=new oI}addToCollectionParentIndex(e,t){return this.sn.add(t),rM.resolve()}getCollectionParents(e,t){return rM.resolve(this.sn.getEntries(t))}addFieldIndex(e,t){return rM.resolve()}deleteFieldIndex(e,t){return rM.resolve()}getDocumentsMatchingTarget(e,t){return rM.resolve(null)}getIndexType(e,t){return rM.resolve(0)}getFieldIndexes(e,t){return rM.resolve([])}getNextCollectionGroupToUpdate(e){return rM.resolve(null)}getMinOffset(e,t){return rM.resolve(rR.min())}getMinOffsetFromCollectionGroup(e,t){return rM.resolve(rR.min())}updateCollectionGroup(e,t,n){return rM.resolve()}updateIndexEntries(e,t){return rM.resolve()}}class oI{constructor(){this.index={}}add(e){let t=e.lastSegment(),n=e.popLast(),r=this.index[t]||new i_(rb.comparator),i=!r.has(n);return this.index[t]=r.add(n),i}has(e){let t=e.lastSegment(),n=e.popLast(),r=this.index[t];return r&&r.has(n)}getEntries(e){return(this.index[e]||new i_(rb.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ let oS=new Uint8Array(0);class oT{constructor(e,t){this.user=e,this.databaseId=t,this.rn=new oI,this.on=new sA(e=>sh(e),(e,t)=>sd(e,t)),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.rn.has(t)){let n=t.lastSegment(),r=t.popLast();e.addOnCommittedListener(()=>{this.rn.add(t)});let i={collectionId:n,parent:rQ(r)};return oD(e).put(i)}return rM.resolve()}getCollectionParents(e,t){let n=[],r=IDBKeyRange.bound([t,""],[t+"\0",""],!1,!0);return oD(e).j(r).next(e=>{for(let r of e){if(r.collectionId!==t)break;n.push(rX(r.parent))}return n})}addFieldIndex(e,t){let n=ok(e),r={indexId:t.indexId,collectionGroup:t.collectionGroup,fields:t.fields.map(e=>[e.fieldPath.canonicalString(),e.kind])};delete r.indexId;let i=n.add(r);if(t.indexState){let s=oC(e);return i.next(e=>{s.put(oe(e,this.user,t.indexState.sequenceNumber,t.indexState.offset))})}return i.next()}deleteFieldIndex(e,t){let n=ok(e),r=oC(e),i=ox(e);return n.delete(t.indexId).next(()=>r.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))).next(()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))}getDocumentsMatchingTarget(e,t){let n=ox(e),r=!0,i=new Map;return rM.forEach(this.un(t),t=>this.cn(e,t).next(e=>{r&&(r=!!e),i.set(t,e)})).next(()=>{if(r){let e=sB(),s=[];return rM.forEach(i,(r,i)=>{n8("IndexedDbIndexManager",`Using index id=${r.indexId}|cg=${r.collectionGroup}|f=${r.fields.map(e=>`${e.fieldPath}:${e.kind}`).join(",")} to execute ${sh(t)}`);let a=function(e,t){let n=rD(t);if(void 0===n)return null;for(let r of sp(e,n.fieldPath))switch(r.op){case"array-contains-any":return r.value.arrayValue.values||[];case"array-contains":return[r.value]}return null}(i,r),o=function(e,t){let n=new Map;for(let r of rx(t))for(let i of sp(e,r.fieldPath))switch(i.op){case"==":case"in":n.set(r.fieldPath.canonicalString(),i.value);break;case"not-in":case"!=":return n.set(r.fieldPath.canonicalString(),i.value),Array.from(n.values())}return null}(i,r),l=function(e,t){let n=[],r=!0;for(let i of rx(t)){let s=0===i.kind?sm(e,i.fieldPath,e.startAt):sg(e,i.fieldPath,e.startAt);n.push(s.value),r&&(r=s.inclusive)}return new iZ(n,r)}(i,r),u=function(e,t){let n=[],r=!0;for(let i of rx(t)){let s=0===i.kind?sg(e,i.fieldPath,e.endAt):sm(e,i.fieldPath,e.endAt);n.push(s.value),r&&(r=s.inclusive)}return new iZ(n,r)}(i,r),c=this.an(r,i,l),h=this.an(r,i,u),d=this.hn(r,i,o),f=this.ln(r.indexId,a,c,l.inclusive,h,u.inclusive,d);return rM.forEach(f,r=>n.H(r,t.limit).next(t=>{t.forEach(t=>{let n=rS.fromSegments(t.documentKey);e.has(n)||(e=e.add(n),s.push(n))})}))}).next(()=>s)}return rM.resolve(null)})}un(e){let t=this.on.get(e);return t||(t=0===e.filters.length?[e]:(function(e){if(0===e.getFilters().length)return[];let t=function e(t){if(t instanceof i9||t instanceof i6||rr(),t instanceof i9)return t;if(1===t.filters.length)return e(t.filters[0]);let n=t.filters.map(t=>e(t)),r=i6.create(n,t.op);return o_(r=ob(r))?r:(r instanceof i6||rr(),i5(r)||rr(),r.filters.length>1||rr(),r.filters.reduce((e,t)=>ov(e,t)))}(/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ function e(t){var n,r;if(t instanceof i9||t instanceof i6||rr(),t instanceof i9){if(t instanceof sa){let i=(null===(r=null===(n=t.value.arrayValue)||void 0===n?void 0:n.values)||void 0===r?void 0:r.map(e=>i9.create(t.field,"==",e)))||[];return i6.create(i,"or")}return t}let s=t.filters.map(t=>e(t));return i6.create(s,t.op)}(e));return o_(t)||rr(),og(t)||oy(t)?[t]:t.getFilters()})(i6.create(e.filters,"and")).map(t=>sc(e.path,e.collectionGroup,e.orderBy,t.getFilters(),e.limit,e.startAt,e.endAt)),this.on.set(e,t)),t}ln(e,t,n,r,i,s,a){let o=(null!=t?t.length:1)*Math.max(n.length,i.length),l=o/(null!=t?t.length:1),u=[];for(let c=0;c<o;++c){let h=t?this.fn(t[c/l]):oS,d=this.dn(e,h,n[c%l],r),f=this._n(e,h,i[c%l],s),p=a.map(t=>this.dn(e,h,t,!0));u.push(...this.createRange(d,f,p))}return u}dn(e,t,n,r){let i=new od(e,rS.empty(),t,n);return r?i:i.He()}_n(e,t,n,r){let i=new od(e,rS.empty(),t,n);return r?i.He():i}cn(e,t){let n=new om(t),r=null!=t.collectionGroup?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,r).next(e=>{let t=null;for(let r of e)n.Ze(r)&&(!t||r.fields.length>t.fields.length)&&(t=r);return t})}getIndexType(e,t){let n=2,r=this.un(t);return rM.forEach(r,t=>this.cn(e,t).next(e=>{e?0!==n&&e.fields.length<function(e){let t=new i_(rI.comparator),n=!1;for(let r of e.filters)for(let i of r.getFlattenedFilters())i.field.isKeyField()||("array-contains"===i.op||"array-contains-any"===i.op?n=!0:t=t.add(i.field));for(let s of e.orderBy)s.field.isKeyField()||(t=t.add(s.field));return t.size+(n?1:0)}(t)&&(n=1):n=0})).next(()=>null!==t.limit&&r.length>1&&2===n?1:n)}wn(e,t){let n=new oh;for(let r of rx(e)){let i=t.data.field(r.fieldPath);if(null==i)return null;let s=n.We(r.kind);oa.be._e(i,s)}return n.Ge()}fn(e){let t=new oh;return oa.be._e(e,t.We(0)),t.Ge()}mn(e,t){let n=new oh;return oa.be._e(i$(this.databaseId,t),n.We(function(e){let t=rx(e);return 0===t.length?0:t[t.length-1].kind}(e))),n.Ge()}hn(e,t,n){if(null===n)return[];let r=[];r.push(new oh);let i=0;for(let s of rx(e)){let a=n[i++];for(let o of r)if(this.gn(t,s.fieldPath)&&iG(a))r=this.yn(r,s,a);else{let l=o.We(s.kind);oa.be._e(a,l)}}return this.pn(r)}an(e,t,n){return this.hn(e,t,n.position)}pn(e){let t=[];for(let n=0;n<e.length;++n)t[n]=e[n].Ge();return t}yn(e,t,n){let r=[...e],i=[];for(let s of n.arrayValue.values||[])for(let a of r){let o=new oh;o.seed(a.Ge()),oa.be._e(s,o.We(t.kind)),i.push(o)}return i}gn(e,t){return!!e.filters.find(e=>e instanceof i9&&e.field.isEqual(t)&&("in"===e.op||"not-in"===e.op))}getFieldIndexes(e,t){let n=ok(e),r=oC(e);return(t?n.j("collectionGroupIndex",IDBKeyRange.bound(t,t)):n.j()).next(e=>{let t=[];return rM.forEach(e,e=>r.get([e.indexId,this.uid]).next(n=>{t.push(function(e,t){let n=t?new rC(t.sequenceNumber,new rR(a4(t.readTime),new rS(rX(t.documentKey)),t.largestBatchId)):rC.empty(),r=e.fields.map(([e,t])=>new rk(rI.fromServerFormat(e),t));return new rT(e.indexId,e.collectionGroup,r,n)}(e,n))})).next(()=>t)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(e=>0===e.length?null:(e.sort((e,t)=>{let n=e.indexState.sequenceNumber-t.indexState.sequenceNumber;return 0!==n?n:rg(e.collectionGroup,t.collectionGroup)}),e[0].collectionGroup))}updateCollectionGroup(e,t,n){let r=ok(e),i=oC(e);return this.In(e).next(e=>r.j("collectionGroupIndex",IDBKeyRange.bound(t,t)).next(t=>rM.forEach(t,t=>i.put(oe(t.indexId,this.user,e,n)))))}updateIndexEntries(e,t){let n=new Map;return rM.forEach(t,(t,r)=>{let i=n.get(t.collectionGroup);return(i?rM.resolve(i):this.getFieldIndexes(e,t.collectionGroup)).next(i=>(n.set(t.collectionGroup,i),rM.forEach(i,n=>this.Tn(e,t,n).next(t=>{let i=this.En(r,n);return t.isEqual(i)?rM.resolve():this.An(e,r,n,t,i)}))))})}Rn(e,t,n,r){return ox(e).put({indexId:r.indexId,uid:this.uid,arrayValue:r.arrayValue,directionalValue:r.directionalValue,orderedDocumentKey:this.mn(n,t.key),documentKey:t.key.path.toArray()})}vn(e,t,n,r){return ox(e).delete([r.indexId,this.uid,r.arrayValue,r.directionalValue,this.mn(n,t.key),t.key.path.toArray()])}Tn(e,t,n){let r=ox(e),i=new i_(of);return r.X({index:"documentKeyIndex",range:IDBKeyRange.only([n.indexId,this.uid,this.mn(n,t)])},(e,r)=>{i=i.add(new od(n.indexId,t,r.arrayValue,r.directionalValue))}).next(()=>i)}En(e,t){let n=new i_(of),r=this.wn(t,e);if(null==r)return n;let i=rD(t);if(null!=i){let s=e.data.field(i.fieldPath);if(iG(s))for(let a of s.arrayValue.values||[])n=n.add(new od(t.indexId,e.key,this.fn(a),r))}else n=n.add(new od(t.indexId,e.key,oS,r));return n}An(e,t,n,r,i){n8("IndexedDbIndexManager","Updating index entries for document '%s'",t.key);let s=[];return function(e,t,n,r,i){let s=e.getIterator(),a=t.getIterator(),o=iw(s),l=iw(a);for(;o||l;){let u=!1,c=!1;if(o&&l){let h=n(o,l);h<0?c=!0:h>0&&(u=!0)}else null!=o?c=!0:u=!0;u?(r(l),l=iw(a)):c?(i(o),o=iw(s)):(o=iw(s),l=iw(a))}}(r,i,of,r=>{s.push(this.Rn(e,t,n,r))},r=>{s.push(this.vn(e,t,n,r))}),rM.waitFor(s)}In(e){let t=1;return oC(e).X({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(e,n,r)=>{r.done(),t=n.sequenceNumber+1}).next(()=>t)}createRange(e,t,n){n=n.sort((e,t)=>of(e,t)).filter((e,t,n)=>!t||0!==of(e,n[t-1]));let r=[];for(let i of(r.push(e),n)){let s=of(i,e),a=of(i,t);if(0===s)r[0]=e.He();else if(s>0&&a<0)r.push(i),r.push(i.He());else if(a>0)break}r.push(t);let o=[];for(let l=0;l<r.length;l+=2){if(this.Pn(r[l],r[l+1]))return[];let u=[r[l].indexId,this.uid,r[l].arrayValue,r[l].directionalValue,oS,[]],c=[r[l+1].indexId,this.uid,r[l+1].arrayValue,r[l+1].directionalValue,oS,[]];o.push(IDBKeyRange.bound(u,c))}return o}Pn(e,t){return of(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(oN)}getMinOffset(e,t){return rM.mapArray(this.un(t),t=>this.cn(e,t).next(e=>e||rr())).next(oN)}}function oD(e){return ic(e,"collectionParents")}function ox(e){return ic(e,"indexEntries")}function ok(e){return ic(e,"indexConfiguration")}function oC(e){return ic(e,"indexState")}function oN(e){0!==e.length||rr();let t=e[0].indexState.offset,n=t.largestBatchId;for(let r=1;r<e.length;r++){let i=e[r].indexState.offset;0>rA(i,t)&&(t=i),n<i.largestBatchId&&(n=i.largestBatchId)}return new rR(t.readTime,t.documentKey,n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ let oR={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class oA{constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}static withCacheSize(e){return new oA(e,oA.DEFAULT_COLLECTION_PERCENTILE,oA.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ function oO(e,t,n){let r=e.store("mutations"),i=e.store("documentMutations"),s=[],a=IDBKeyRange.only(n.batchId),o=0,l=r.X({range:a},(e,t,n)=>(o++,n.delete()));s.push(l.next(()=>{1===o||rr()}));let u=[];for(let c of n.mutations){var h,d;let f=(h=c.key.path,d=n.batchId,[t,rQ(h),d]);s.push(i.delete(f)),u.push(c.key)}return rM.waitFor(s).next(()=>u)}function oP(e){let t;if(!e)return 0;if(e.document)t=e.document;else if(e.unknownDocument)t=e.unknownDocument;else{if(!e.noDocument)throw rr();t=e.noDocument}return JSON.stringify(t).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ oA.DEFAULT_COLLECTION_PERCENTILE=10,oA.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,oA.DEFAULT=new oA(41943040,oA.DEFAULT_COLLECTION_PERCENTILE,oA.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),oA.DISABLED=new oA(-1,0,0);class oL{constructor(e,t,n,r){this.userId=e,this.serializer=t,this.indexManager=n,this.referenceDelegate=r,this.bn={}}static fe(e,t,n,r){""!==e.uid||rr();let i=e.isAuthenticated()?e.uid:"";return new oL(i,t,n,r)}checkEmpty(e){let t=!0,n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return oU(e).X({index:"userMutationsIndex",range:n},(e,n,r)=>{t=!1,r.done()}).next(()=>t)}addMutationBatch(e,t,n,r){let i=oF(e),s=oU(e);return s.add({}).next(a=>{"number"==typeof a||rr();let o=new as(a,t,n,r),l=function(e,t,n){let r=n.baseMutations.map(t=>aq(e.le,t)),i=n.mutations.map(t=>aq(e.le,t));return{userId:t,batchId:n.batchId,localWriteTimeMs:n.localWriteTime.toMillis(),baseMutations:r,mutations:i}}(this.serializer,this.userId,o),u=[],c=new i_((e,t)=>rg(e.canonicalString(),t.canonicalString()));for(let h of r){let d=[this.userId,rQ(h.key.path),a];c=c.add(h.key.path.popLast()),u.push(s.put(l)),u.push(i.put(d,rZ))}return c.forEach(t=>{u.push(this.indexManager.addToCollectionParentIndex(e,t))}),e.addOnCommittedListener(()=>{this.bn[a]=o.keys()}),rM.waitFor(u).next(()=>o)})}lookupMutationBatch(e,t){return oU(e).get(t).next(e=>e?(e.userId===this.userId||rr(),a9(this.serializer,e)):null)}Vn(e,t){return this.bn[t]?rM.resolve(this.bn[t]):this.lookupMutationBatch(e,t).next(e=>{if(e){let n=e.keys();return this.bn[t]=n,n}return null})}getNextMutationBatchAfterBatchId(e,t){let n=t+1,r=IDBKeyRange.lowerBound([this.userId,n]),i=null;return oU(e).X({index:"userMutationsIndex",range:r},(e,t,r)=>{t.userId===this.userId&&(t.batchId>=n||rr(),i=a9(this.serializer,t)),r.done()}).next(()=>i)}getHighestUnacknowledgedBatchId(e){let t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),n=-1;return oU(e).X({index:"userMutationsIndex",range:t,reverse:!0},(e,t,r)=>{n=t.batchId,r.done()}).next(()=>n)}getAllMutationBatches(e){let t=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return oU(e).j("userMutationsIndex",t).next(e=>e.map(e=>a9(this.serializer,e)))}getAllMutationBatchesAffectingDocumentKey(e,t){let n=[this.userId,rQ(t.path)],r=IDBKeyRange.lowerBound(n),i=[];return oF(e).X({range:r},(n,r,s)=>{let[a,o,l]=n,u=rX(o);if(a===this.userId&&t.path.isEqual(u))return oU(e).get(l).next(e=>{if(!e)throw rr();e.userId===this.userId||rr(),i.push(a9(this.serializer,e))});s.done()}).next(()=>i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new i_(rg),r=[];return t.forEach(t=>{let i=[this.userId,rQ(t.path)],s=IDBKeyRange.lowerBound(i),a=oF(e).X({range:s},(e,r,i)=>{let[s,a,o]=e,l=rX(a);s===this.userId&&t.path.isEqual(l)?n=n.add(o):i.done()});r.push(a)}),rM.waitFor(r).next(()=>this.Sn(e,n))}getAllMutationBatchesAffectingQuery(e,t){let n=t.path,r=n.length+1,i=[this.userId,rQ(n)],s=IDBKeyRange.lowerBound(i),a=new i_(rg);return oF(e).X({range:s},(e,t,i)=>{let[s,o,l]=e,u=rX(o);s===this.userId&&n.isPrefixOf(u)?u.length===r&&(a=a.add(l)):i.done()}).next(()=>this.Sn(e,a))}Sn(e,t){let n=[],r=[];return t.forEach(t=>{r.push(oU(e).get(t).next(e=>{if(null===e)throw rr();e.userId===this.userId||rr(),n.push(a9(this.serializer,e))}))}),rM.waitFor(r).next(()=>n)}removeMutationBatch(e,t){return oO(e.at,this.userId,t).next(n=>(e.addOnCommittedListener(()=>{this.Dn(t.batchId)}),rM.forEach(n,t=>this.referenceDelegate.markPotentiallyOrphaned(e,t))))}Dn(e){delete this.bn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(t=>{if(!t)return rM.resolve();let n=IDBKeyRange.lowerBound([this.userId]),r=[];return oF(e).X({range:n},(e,t,n)=>{if(e[0]===this.userId){let i=rX(e[1]);r.push(i)}else n.done()}).next(()=>{0===r.length||rr()})})}containsKey(e,t){return oM(e,this.userId,t)}Cn(e){return oj(e).get(this.userId).next(e=>e||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}}function oM(e,t,n){let r=[t,rQ(n.path)],i=r[1],s=IDBKeyRange.lowerBound(r),a=!1;return oF(e).X({range:s,Y:!0},(e,n,r)=>{let[s,o,l]=e;s===t&&o===i&&(a=!0),r.done()}).next(()=>a)}function oU(e){return ic(e,"mutations")}function oF(e){return ic(e,"documentMutations")}function oj(e){return ic(e,"mutationQueues")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ class oB{constructor(e){this.xn=e}next(){return this.xn+=2,this.xn}static Nn(){return new oB(0)}static kn(){return new oB(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ class o${constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.Mn(e).next(t=>{let n=new oB(t.highestTargetId);return t.highestTargetId=n.next(),this.On(e,t).next(()=>t.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.Mn(e).next(e=>rv.fromTimestamp(new r_(e.lastRemoteSnapshotVersion.seconds,e.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.Mn(e).next(e=>e.highestListenSequenceNumber)}setTargetsMetadata(e,t,n){return this.Mn(e).next(r=>(r.highestListenSequenceNumber=t,n&&(r.lastRemoteSnapshotVersion=n.toTimestamp()),t>r.highestListenSequenceNumber&&(r.highestListenSequenceNumber=t),this.On(e,r)))}addTargetData(e,t){return this.$n(e,t).next(()=>this.Mn(e).next(n=>(n.targetCount+=1,this.Fn(t,n),this.On(e,n))))}updateTargetData(e,t){return this.$n(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next(()=>oV(e).delete(t.targetId)).next(()=>this.Mn(e)).next(t=>(t.targetCount>0||rr(),t.targetCount-=1,this.On(e,t)))}removeTargets(e,t,n){let r=0,i=[];return oV(e).X((s,a)=>{let o=a6(a);o.sequenceNumber<=t&&null===n.get(o.targetId)&&(r++,i.push(this.removeTargetData(e,o)))}).next(()=>rM.waitFor(i)).next(()=>r)}forEachTarget(e,t){return oV(e).X((e,n)=>{let r=a6(n);t(r)})}Mn(e){return oG(e).get("targetGlobalKey").next(e=>(null!==e||rr(),e))}On(e,t){return oG(e).put("targetGlobalKey",t)}$n(e,t){return oV(e).put(a5(this.serializer,t))}Fn(e,t){let n=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,n=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,n=!0),n}getTargetCount(e){return this.Mn(e).next(e=>e.targetCount)}getTargetData(e,t){let n=sh(t),r=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]),i=null;return oV(e).X({range:r,index:"queryTargetsIndex"},(e,n,r)=>{let s=a6(n);sd(t,s.target)&&(i=s,r.done())}).next(()=>i)}addMatchingKeys(e,t,n){let r=[],i=oq(e);return t.forEach(t=>{let s=rQ(t.path);r.push(i.put({targetId:n,path:s})),r.push(this.referenceDelegate.addReference(e,n,t))}),rM.waitFor(r)}removeMatchingKeys(e,t,n){let r=oq(e);return rM.forEach(t,t=>{let i=rQ(t.path);return rM.waitFor([r.delete([n,i]),this.referenceDelegate.removeReference(e,n,t)])})}removeMatchingKeysForTargetId(e,t){let n=oq(e),r=IDBKeyRange.bound([t],[t+1],!1,!0);return n.delete(r)}getMatchingKeysForTargetId(e,t){let n=IDBKeyRange.bound([t],[t+1],!1,!0),r=oq(e),i=sB();return r.X({range:n,Y:!0},(e,t,n)=>{let r=rX(e[1]),s=new rS(r);i=i.add(s)}).next(()=>i)}containsKey(e,t){let n=rQ(t.path),r=IDBKeyRange.bound([n],[n+"\0"],!1,!0),i=0;return oq(e).X({index:"documentTargetsIndex",Y:!0,range:r},([e,t],n,r)=>{0!==e&&(i++,r.done())}).next(()=>i>0)}he(e,t){return oV(e).get(t).next(e=>e?a6(e):null)}}function oV(e){return ic(e,"targets")}function oG(e){return ic(e,"targetGlobal")}function oq(e){return ic(e,"targetDocuments")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ function oz([e,t],[n,r]){let i=rg(e,n);return 0===i?rg(t,r):i}class oK{constructor(e){this.Bn=e,this.buffer=new i_(oz),this.Ln=0}qn(){return++this.Ln}Un(e){let t=[e,this.qn()];if(this.buffer.size<this.Bn)this.buffer=this.buffer.add(t);else{let n=this.buffer.last();0>oz(t,n)&&(this.buffer=this.buffer.delete(n).add(t))}}get maxValue(){return this.buffer.last()[0]}}class oY{constructor(e,t,n){this.garbageCollector=e,this.asyncQueue=t,this.localStore=n,this.Kn=null}start(){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.Gn(6e4)}stop(){this.Kn&&(this.Kn.cancel(),this.Kn=null)}get started(){return null!==this.Kn}Gn(e){n8("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.Kn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Kn=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(e){r$(e)?n8("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e):await rL(e)}await this.Gn(3e5)})}}class oH{constructor(e,t){this.Qn=e,this.params=t}calculateTargetCount(e,t){return this.Qn.jn(e).next(e=>Math.floor(t/100*e))}nthSequenceNumber(e,t){if(0===t)return rM.resolve(rH.ct);let n=new oK(t);return this.Qn.forEachTarget(e,e=>n.Un(e.sequenceNumber)).next(()=>this.Qn.zn(e,e=>n.Un(e))).next(()=>n.maxValue)}removeTargets(e,t,n){return this.Qn.removeTargets(e,t,n)}removeOrphanedDocuments(e,t){return this.Qn.removeOrphanedDocuments(e,t)}collect(e,t){return -1===this.params.cacheSizeCollectionThreshold?(n8("LruGarbageCollector","Garbage collection skipped; disabled"),rM.resolve(oR)):this.getCacheSize(e).next(n=>n<this.params.cacheSizeCollectionThreshold?(n8("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),oR):this.Wn(e,t))}getCacheSize(e){return this.Qn.getCacheSize(e)}Wn(e,t){let n,r,i,s,a,o,l;let u=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(t=>(t>this.params.maximumSequenceNumbersToCollect?(n8("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${t}`),r=this.params.maximumSequenceNumbersToCollect):r=t,s=Date.now(),this.nthSequenceNumber(e,r))).next(r=>(n=r,a=Date.now(),this.removeTargets(e,n,t))).next(t=>(i=t,o=Date.now(),this.removeOrphanedDocuments(e,n))).next(e=>(l=Date.now(),n7()<=f.in.DEBUG&&n8("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${s-u}ms
	Determined least recently used ${r} in `+(a-s)+"ms\n"+`	Removed ${i} targets in `+(o-a)+"ms\n"+`	Removed ${e} documents in `+(l-o)+"ms\n"+`Total Duration: ${l-u}ms`),rM.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:i,documentsRemoved:e})))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ class oW{constructor(e,t){this.db=e,this.garbageCollector=new oH(this,t)}jn(e){let t=this.Hn(e);return this.db.getTargetCache().getTargetCount(e).next(e=>t.next(t=>e+t))}Hn(e){let t=0;return this.zn(e,e=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}zn(e,t){return this.Jn(e,(e,n)=>t(n))}addReference(e,t,n){return oQ(e,n)}removeReference(e,t,n){return oQ(e,n)}removeTargets(e,t,n){return this.db.getTargetCache().removeTargets(e,t,n)}markPotentiallyOrphaned(e,t){return oQ(e,t)}Yn(e,t){let n;return n=!1,oj(e).Z(r=>oM(e,r,t).next(e=>(e&&(n=!0),rM.resolve(!e)))).next(()=>n)}removeOrphanedDocuments(e,t){let n=this.db.getRemoteDocumentCache().newChangeBuffer(),r=[],i=0;return this.Jn(e,(s,a)=>{if(a<=t){let o=this.Yn(e,s).next(t=>{if(!t)return i++,n.getEntry(e,s).next(()=>(n.removeEntry(s,rv.min()),oq(e).delete([0,rQ(s.path)])))});r.push(o)}}).next(()=>rM.waitFor(r)).next(()=>n.apply(e)).next(()=>i)}removeTarget(e,t){let n=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,n)}updateLimboDocument(e,t){return oQ(e,t)}Jn(e,t){let n=oq(e),r,i=rH.ct;return n.X({index:"documentTargetsIndex"},([e,n],{path:s,sequenceNumber:a})=>{0===e?(i!==rH.ct&&t(new rS(rX(r)),i),i=a,r=s):i=rH.ct}).next(()=>{i!==rH.ct&&t(new rS(rX(r)),i)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function oQ(e,t){var n;return oq(e).put((n=e.currentSequenceNumber,{targetId:0,path:rQ(t.path),sequenceNumber:n}))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ class oX{constructor(){this.changes=new sA(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,iJ.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();let n=this.changes.get(t);return void 0!==n?rM.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ class oJ{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,n){return o1(e).put(n)}removeEntry(e,t,n){return o1(e).delete(function(e,t){let n=e.path.toArray();return[n.slice(0,n.length-2),n[n.length-2],a1(t),n[n.length-1]]}(t,n))}updateMetadata(e,t){return this.getMetadata(e).next(n=>(n.byteSize+=t,this.Xn(e,n)))}getEntry(e,t){let n=iJ.newInvalidDocument(t);return o1(e).X({index:"documentKeyIndex",range:IDBKeyRange.only(o2(t))},(e,r)=>{n=this.Zn(t,r)}).next(()=>n)}ts(e,t){let n={size:0,document:iJ.newInvalidDocument(t)};return o1(e).X({index:"documentKeyIndex",range:IDBKeyRange.only(o2(t))},(e,r)=>{n={document:this.Zn(t,r),size:oP(r)}}).next(()=>n)}getEntries(e,t){let n=sO;return this.es(e,t,(e,t)=>{let r=this.Zn(e,t);n=n.insert(e,r)}).next(()=>n)}ns(e,t){let n=sO,r=new im(rS.comparator);return this.es(e,t,(e,t)=>{let i=this.Zn(e,t);n=n.insert(e,i),r=r.insert(e,oP(t))}).next(()=>({documents:n,ss:r}))}es(e,t,n){if(t.isEmpty())return rM.resolve();let r=new i_(o9);t.forEach(e=>r=r.add(e));let i=IDBKeyRange.bound(o2(r.first()),o2(r.last())),s=r.getIterator(),a=s.getNext();return o1(e).X({index:"documentKeyIndex",range:i},(e,t,r)=>{let i=rS.fromSegments([...t.prefixPath,t.collectionGroup,t.documentId]);for(;a&&0>o9(a,i);)n(a,null),a=s.getNext();a&&a.isEqual(i)&&(n(a,t),a=s.hasNext()?s.getNext():null),a?r.G(o2(a)):r.done()}).next(()=>{for(;a;)n(a,null),a=s.hasNext()?s.getNext():null})}getDocumentsMatchingQuery(e,t,n,r){let i=t.path,s=[i.popLast().toArray(),i.lastSegment(),a1(n.readTime),n.documentKey.path.isEmpty()?"":n.documentKey.path.lastSegment()],a=[i.popLast().toArray(),i.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return o1(e).j(IDBKeyRange.bound(s,a,!0)).next(e=>{let n=sO;for(let i of e){let s=this.Zn(rS.fromSegments(i.prefixPath.concat(i.collectionGroup,i.documentId)),i);s.isFoundDocument()&&(sN(t,s)||r.has(s.key))&&(n=n.insert(s.key,s))}return n})}getAllFromCollectionGroup(e,t,n,r){let i=sO,s=o4(t,n),a=o4(t,rR.max());return o1(e).X({index:"collectionGroupIndex",range:IDBKeyRange.bound(s,a,!0)},(e,t,n)=>{let s=this.Zn(rS.fromSegments(t.prefixPath.concat(t.collectionGroup,t.documentId)),t);(i=i.insert(s.key,s)).size===r&&n.done()}).next(()=>i)}newChangeBuffer(e){return new oZ(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(e=>e.byteSize)}getMetadata(e){return o0(e).get("remoteDocumentGlobalKey").next(e=>(e||rr(),e))}Xn(e,t){return o0(e).put("remoteDocumentGlobalKey",t)}Zn(e,t){if(t){let n=function(e,t){let n;if(t.document)n=function(e,t,n){let r=aF(e,t.name),i=aP(t.updateTime),s=t.createTime?aP(t.createTime):rv.min(),a=new iX({mapValue:{fields:t.fields}}),o=iJ.newFoundDocument(r,i,s,a);return n&&o.setHasCommittedMutations(),n?o.setHasCommittedMutations():o}(e.le,t.document,!!t.hasCommittedMutations);else if(t.noDocument){let r=rS.fromSegments(t.noDocument.path),i=a4(t.noDocument.readTime);n=iJ.newNoDocument(r,i),t.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!t.unknownDocument)return rr();{let s=rS.fromSegments(t.unknownDocument.path),a=a4(t.unknownDocument.version);n=iJ.newUnknownDocument(s,a)}}return t.readTime&&n.setReadTime(function(e){let t=new r_(e[0],e[1]);return rv.fromTimestamp(t)}(t.readTime)),n}(this.serializer,t);if(!(n.isNoDocument()&&n.version.isEqual(rv.min())))return n}return iJ.newInvalidDocument(e)}}class oZ extends oX{constructor(e,t){super(),this.rs=e,this.trackRemovals=t,this.os=new sA(e=>e.toString(),(e,t)=>e.isEqual(t))}applyChanges(e){let t=[],n=0,r=new i_((e,t)=>rg(e.canonicalString(),t.canonicalString()));return this.changes.forEach((i,s)=>{let a=this.os.get(i);if(t.push(this.rs.removeEntry(e,i,a.readTime)),s.isValidDocument()){let o=a0(this.rs.serializer,s);r=r.add(i.path.popLast());let l=oP(o);n+=l-a.size,t.push(this.rs.addEntry(e,i,o))}else if(n-=a.size,this.trackRemovals){let u=a0(this.rs.serializer,s.convertToNoDocument(rv.min()));t.push(this.rs.addEntry(e,i,u))}}),r.forEach(n=>{t.push(this.rs.indexManager.addToCollectionParentIndex(e,n))}),t.push(this.rs.updateMetadata(e,n)),rM.waitFor(t)}getFromCache(e,t){return this.rs.ts(e,t).next(e=>(this.os.set(t,{size:e.size,readTime:e.document.readTime}),e.document))}getAllFromCache(e,t){return this.rs.ns(e,t).next(({documents:e,ss:t})=>(t.forEach((t,n)=>{this.os.set(t,{size:n,readTime:e.get(t).readTime})}),e))}}function o0(e){return ic(e,"remoteDocumentGlobal")}function o1(e){return ic(e,"remoteDocumentsV14")}function o2(e){let t=e.path.toArray();return[t.slice(0,t.length-2),t[t.length-2],t[t.length-1]]}function o4(e,t){let n=t.documentKey.path.toArray();return[e,a1(t.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function o9(e,t){let n=e.path.toArray(),r=t.path.toArray(),i=0;for(let s=0;s<n.length-2&&s<r.length-2;++s)if(i=rg(n[s],r[s]))return i;return(i=rg(n.length,r.length))||(i=rg(n[n.length-2],r[r.length-2]))||rg(n[n.length-1],r[r.length-1])}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ /**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ class o6{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ class o5{constructor(e,t,n,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=r}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next(r=>(n=r,this.remoteDocumentCache.getEntry(e,t))).next(e=>(null!==n&&s5(n.mutation,e,ib.empty(),r_.now()),e))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(t=>this.getLocalViewOfDocuments(e,t,sB()).next(()=>t))}getLocalViewOfDocuments(e,t,n=sB()){let r=sU();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,n).next(e=>{let t=sL();return e.forEach((e,n)=>{t=t.insert(e,n.overlayedDocument)}),t}))}getOverlayedDocuments(e,t){let n=sU();return this.populateOverlays(e,n,t).next(()=>this.computeViews(e,t,n,sB()))}populateOverlays(e,t,n){let r=[];return n.forEach(e=>{t.has(e)||r.push(e)}),this.documentOverlayCache.getOverlays(e,r).next(e=>{e.forEach((e,n)=>{t.set(e,n)})})}computeViews(e,t,n,r){let i=sO,s=sU(),a=sU();return t.forEach((e,t)=>{let a=n.get(t.key);r.has(t.key)&&(void 0===a||a.mutation instanceof s8)?i=i.insert(t.key,t):void 0!==a?(s.set(t.key,a.mutation.getFieldMask()),s5(a.mutation,t,a.mutation.getFieldMask(),r_.now())):s.set(t.key,ib.empty())}),this.recalculateAndSaveOverlays(e,i).next(e=>(e.forEach((e,t)=>s.set(e,t)),t.forEach((e,t)=>{var n;return a.set(e,new o6(t,null!==(n=s.get(e))&&void 0!==n?n:null))}),a))}recalculateAndSaveOverlays(e,t){let n=sU(),r=new im((e,t)=>e-t),i=sB();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(e=>{for(let i of e)i.keys().forEach(e=>{let s=t.get(e);if(null===s)return;let a=n.get(e)||ib.empty();a=i.applyToLocalView(s,a),n.set(e,a);let o=(r.get(i.batchId)||sB()).add(e);r=r.insert(i.batchId,o)})}).next(()=>{let s=[],a=r.getReverseIterator();for(;a.hasNext();){let o=a.getNext(),l=o.key,u=o.value,c=sU();u.forEach(e=>{if(!i.has(e)){let r=s6(t.get(e),n.get(e));null!==r&&c.set(e,r),i=i.add(e)}}),s.push(this.documentOverlayCache.saveOverlays(e,l,c))}return rM.waitFor(s)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(t=>this.recalculateAndSaveOverlays(e,t))}getDocumentsMatchingQuery(e,t,n){return rS.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length?this.getDocumentsMatchingDocumentQuery(e,t.path):sE(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n):this.getDocumentsMatchingCollectionQuery(e,t,n)}getNextDocuments(e,t,n,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,r).next(i=>{let s=r-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,r-i.size):rM.resolve(sU()),a=-1,o=i;return s.next(t=>rM.forEach(t,(t,n)=>(a<n.largestBatchId&&(a=n.largestBatchId),i.get(t)?rM.resolve():this.remoteDocumentCache.getEntry(e,t).next(e=>{o=o.insert(t,e)}))).next(()=>this.populateOverlays(e,t,i)).next(()=>this.computeViews(e,o,t,sB())).next(e=>({batchId:a,changes:sM(e)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new rS(t)).next(e=>{let t=sL();return e.isFoundDocument()&&(t=t.insert(e.key,e)),t})}getDocumentsMatchingCollectionGroupQuery(e,t,n){let r=t.collectionGroup,i=sL();return this.indexManager.getCollectionParents(e,r).next(s=>rM.forEach(s,s=>{var a;let o=(a=s.child(r),new sy(a,null,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt));return this.getDocumentsMatchingCollectionQuery(e,o,n).next(e=>{e.forEach((e,t)=>{i=i.insert(e,t)})})}).next(()=>i))}getDocumentsMatchingCollectionQuery(e,t,n){let r;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next(i=>(r=i,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,r))).next(e=>{r.forEach((t,n)=>{let r=n.getKey();null===e.get(r)&&(e=e.insert(r,iJ.newInvalidDocument(r)))});let n=sL();return e.forEach((e,i)=>{let s=r.get(e);void 0!==s&&s5(s.mutation,i,ib.empty(),r_.now()),sN(t,i)&&(n=n.insert(e,i))}),n})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ class o3{constructor(e){this.serializer=e,this.us=new Map,this.cs=new Map}getBundleMetadata(e,t){return rM.resolve(this.us.get(t))}saveBundleMetadata(e,t){return this.us.set(t.id,{id:t.id,version:t.version,createTime:aP(t.createTime)}),rM.resolve()}getNamedQuery(e,t){return rM.resolve(this.cs.get(t))}saveNamedQuery(e,t){return this.cs.set(t.name,{name:t.name,query:a3(t.bundledQuery),readTime:aP(t.readTime)}),rM.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ class o7{constructor(){this.overlays=new im(rS.comparator),this.hs=new Map}getOverlay(e,t){return rM.resolve(this.overlays.get(t))}getOverlays(e,t){let n=sU();return rM.forEach(t,t=>this.getOverlay(e,t).next(e=>{null!==e&&n.set(t,e)})).next(()=>n)}saveOverlays(e,t,n){return n.forEach((n,r)=>{this.de(e,t,r)}),rM.resolve()}removeOverlaysForBatchId(e,t,n){let r=this.hs.get(n);return void 0!==r&&(r.forEach(e=>this.overlays=this.overlays.remove(e)),this.hs.delete(n)),rM.resolve()}getOverlaysForCollection(e,t,n){let r=sU(),i=t.length+1,s=new rS(t.child("")),a=this.overlays.getIteratorFrom(s);for(;a.hasNext();){let o=a.getNext().value,l=o.getKey();if(!t.isPrefixOf(l.path))break;l.path.length===i&&o.largestBatchId>n&&r.set(o.getKey(),o)}return rM.resolve(r)}getOverlaysForCollectionGroup(e,t,n,r){let i=new im((e,t)=>e-t),s=this.overlays.getIterator();for(;s.hasNext();){let a=s.getNext().value;if(a.getKey().getCollectionGroup()===t&&a.largestBatchId>n){let o=i.get(a.largestBatchId);null===o&&(o=sU(),i=i.insert(a.largestBatchId,o)),o.set(a.getKey(),a)}}let l=sU(),u=i.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach((e,t)=>l.set(e,t)),!(l.size()>=r)););return rM.resolve(l)}de(e,t,n){let r=this.overlays.get(n.key);if(null!==r){let i=this.hs.get(r.largestBatchId).delete(n.key);this.hs.set(r.largestBatchId,i)}this.overlays=this.overlays.insert(n.key,new ao(t,n));let s=this.hs.get(t);void 0===s&&(s=sB(),this.hs.set(t,s)),this.hs.set(t,s.add(n.key))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ class o8{constructor(){this.ls=new i_(le.fs),this.ds=new i_(le._s)}isEmpty(){return this.ls.isEmpty()}addReference(e,t){let n=new le(e,t);this.ls=this.ls.add(n),this.ds=this.ds.add(n)}ws(e,t){e.forEach(e=>this.addReference(e,t))}removeReference(e,t){this.gs(new le(e,t))}ys(e,t){e.forEach(e=>this.removeReference(e,t))}ps(e){let t=new rS(new rb([])),n=new le(t,e),r=new le(t,e+1),i=[];return this.ds.forEachInRange([n,r],e=>{this.gs(e),i.push(e.key)}),i}Is(){this.ls.forEach(e=>this.gs(e))}gs(e){this.ls=this.ls.delete(e),this.ds=this.ds.delete(e)}Ts(e){let t=new rS(new rb([])),n=new le(t,e),r=new le(t,e+1),i=sB();return this.ds.forEachInRange([n,r],e=>{i=i.add(e.key)}),i}containsKey(e){let t=new le(e,0),n=this.ls.firstAfterOrEqual(t);return null!==n&&e.isEqual(n.key)}}class le{constructor(e,t){this.key=e,this.Es=t}static fs(e,t){return rS.comparator(e.key,t.key)||rg(e.Es,t.Es)}static _s(e,t){return rg(e.Es,t.Es)||rS.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ class lt{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.As=1,this.Rs=new i_(le.fs)}checkEmpty(e){return rM.resolve(0===this.mutationQueue.length)}addMutationBatch(e,t,n,r){let i=this.As;this.As++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let s=new as(i,t,n,r);for(let a of(this.mutationQueue.push(s),r))this.Rs=this.Rs.add(new le(a.key,i)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return rM.resolve(s)}lookupMutationBatch(e,t){return rM.resolve(this.vs(t))}getNextMutationBatchAfterBatchId(e,t){let n=this.Ps(t+1),r=n<0?0:n;return rM.resolve(this.mutationQueue.length>r?this.mutationQueue[r]:null)}getHighestUnacknowledgedBatchId(){return rM.resolve(0===this.mutationQueue.length?-1:this.As-1)}getAllMutationBatches(e){return rM.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){let n=new le(t,0),r=new le(t,Number.POSITIVE_INFINITY),i=[];return this.Rs.forEachInRange([n,r],e=>{let t=this.vs(e.Es);i.push(t)}),rM.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new i_(rg);return t.forEach(e=>{let t=new le(e,0),r=new le(e,Number.POSITIVE_INFINITY);this.Rs.forEachInRange([t,r],e=>{n=n.add(e.Es)})}),rM.resolve(this.bs(n))}getAllMutationBatchesAffectingQuery(e,t){let n=t.path,r=n.length+1,i=n;rS.isDocumentKey(i)||(i=i.child(""));let s=new le(new rS(i),0),a=new i_(rg);return this.Rs.forEachWhile(e=>{let t=e.key.path;return!!n.isPrefixOf(t)&&(t.length===r&&(a=a.add(e.Es)),!0)},s),rM.resolve(this.bs(a))}bs(e){let t=[];return e.forEach(e=>{let n=this.vs(e);null!==n&&t.push(n)}),t}removeMutationBatch(e,t){0===this.Vs(t.batchId,"removed")||rr(),this.mutationQueue.shift();let n=this.Rs;return rM.forEach(t.mutations,r=>{let i=new le(r.key,t.batchId);return n=n.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)}).next(()=>{this.Rs=n})}Dn(e){}containsKey(e,t){let n=new le(t,0),r=this.Rs.firstAfterOrEqual(n);return rM.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,rM.resolve()}Vs(e,t){return this.Ps(e)}Ps(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}vs(e){let t=this.Ps(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ class ln{constructor(e){this.Ss=e,this.docs=new im(rS.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){let n=t.key,r=this.docs.get(n),i=r?r.size:0,s=this.Ss(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:s}),this.size+=s-i,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){let t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){let n=this.docs.get(t);return rM.resolve(n?n.document.mutableCopy():iJ.newInvalidDocument(t))}getEntries(e,t){let n=sO;return t.forEach(e=>{let t=this.docs.get(e);n=n.insert(e,t?t.document.mutableCopy():iJ.newInvalidDocument(e))}),rM.resolve(n)}getDocumentsMatchingQuery(e,t,n,r){let i=sO,s=t.path,a=new rS(s.child("")),o=this.docs.getIteratorFrom(a);for(;o.hasNext();){let{key:l,value:{document:u}}=o.getNext();if(!s.isPrefixOf(l.path))break;l.path.length>s.length+1||0>=rA(rN(u),n)||(r.has(u.key)||sN(t,u))&&(i=i.insert(u.key,u.mutableCopy()))}return rM.resolve(i)}getAllFromCollectionGroup(e,t,n,r){rr()}Ds(e,t){return rM.forEach(this.docs,e=>t(e))}newChangeBuffer(e){return new lr(this)}getSize(e){return rM.resolve(this.size)}}class lr extends oX{constructor(e){super(),this.rs=e}applyChanges(e){let t=[];return this.changes.forEach((n,r)=>{r.isValidDocument()?t.push(this.rs.addEntry(e,r)):this.rs.removeEntry(n)}),rM.waitFor(t)}getFromCache(e,t){return this.rs.getEntry(e,t)}getAllFromCache(e,t){return this.rs.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ class li{constructor(e){this.persistence=e,this.Cs=new sA(e=>sh(e),sd),this.lastRemoteSnapshotVersion=rv.min(),this.highestTargetId=0,this.xs=0,this.Ns=new o8,this.targetCount=0,this.ks=oB.Nn()}forEachTarget(e,t){return this.Cs.forEach((e,n)=>t(n)),rM.resolve()}getLastRemoteSnapshotVersion(e){return rM.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return rM.resolve(this.xs)}allocateTargetId(e){return this.highestTargetId=this.ks.next(),rM.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.xs&&(this.xs=t),rM.resolve()}$n(e){this.Cs.set(e.target,e);let t=e.targetId;t>this.highestTargetId&&(this.ks=new oB(t),this.highestTargetId=t),e.sequenceNumber>this.xs&&(this.xs=e.sequenceNumber)}addTargetData(e,t){return this.$n(t),this.targetCount+=1,rM.resolve()}updateTargetData(e,t){return this.$n(t),rM.resolve()}removeTargetData(e,t){return this.Cs.delete(t.target),this.Ns.ps(t.targetId),this.targetCount-=1,rM.resolve()}removeTargets(e,t,n){let r=0,i=[];return this.Cs.forEach((s,a)=>{a.sequenceNumber<=t&&null===n.get(a.targetId)&&(this.Cs.delete(s),i.push(this.removeMatchingKeysForTargetId(e,a.targetId)),r++)}),rM.waitFor(i).next(()=>r)}getTargetCount(e){return rM.resolve(this.targetCount)}getTargetData(e,t){let n=this.Cs.get(t)||null;return rM.resolve(n)}addMatchingKeys(e,t,n){return this.Ns.ws(t,n),rM.resolve()}removeMatchingKeys(e,t,n){this.Ns.ys(t,n);let r=this.persistence.referenceDelegate,i=[];return r&&t.forEach(t=>{i.push(r.markPotentiallyOrphaned(e,t))}),rM.waitFor(i)}removeMatchingKeysForTargetId(e,t){return this.Ns.ps(t),rM.resolve()}getMatchingKeysForTargetId(e,t){let n=this.Ns.Ts(t);return rM.resolve(n)}containsKey(e,t){return rM.resolve(this.Ns.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ class ls{constructor(e,t){var n;this.Ms={},this.overlays={},this.Os=new rH(0),this.$s=!1,this.$s=!0,this.referenceDelegate=e(this),this.Fs=new li(this),this.indexManager=new oE,this.remoteDocumentCache=(n=e=>this.referenceDelegate.Bs(e),new ln(n)),this.serializer=new aZ(t),this.Ls=new o3(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.$s=!1,Promise.resolve()}get started(){return this.$s}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new o7,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this.Ms[e.toKey()];return n||(n=new lt(t,this.referenceDelegate),this.Ms[e.toKey()]=n),n}getTargetCache(){return this.Fs}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ls}runTransaction(e,t,n){n8("MemoryPersistence","Starting transaction:",e);let r=new la(this.Os.next());return this.referenceDelegate.qs(),n(r).next(e=>this.referenceDelegate.Us(r).next(()=>e)).toPromise().then(e=>(r.raiseOnCommittedEvent(),e))}Ks(e,t){return rM.or(Object.values(this.Ms).map(n=>()=>n.containsKey(e,t)))}}class la extends rP{constructor(e){super(),this.currentSequenceNumber=e}}class lo{constructor(e){this.persistence=e,this.Gs=new o8,this.Qs=null}static js(e){return new lo(e)}get zs(){if(this.Qs)return this.Qs;throw rr()}addReference(e,t,n){return this.Gs.addReference(n,t),this.zs.delete(n.toString()),rM.resolve()}removeReference(e,t,n){return this.Gs.removeReference(n,t),this.zs.add(n.toString()),rM.resolve()}markPotentiallyOrphaned(e,t){return this.zs.add(t.toString()),rM.resolve()}removeTarget(e,t){this.Gs.ps(t.targetId).forEach(e=>this.zs.add(e.toString()));let n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next(e=>{e.forEach(e=>this.zs.add(e.toString()))}).next(()=>n.removeTargetData(e,t))}qs(){this.Qs=new Set}Us(e){let t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return rM.forEach(this.zs,n=>{let r=rS.fromPath(n);return this.Ws(e,r).next(e=>{e||t.removeEntry(r,rv.min())})}).next(()=>(this.Qs=null,t.apply(e)))}updateLimboDocument(e,t){return this.Ws(e,t).next(e=>{e?this.zs.delete(t.toString()):this.zs.add(t.toString())})}Bs(e){return 0}Ws(e,t){return rM.or([()=>rM.resolve(this.Gs.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ks(e,t)])}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ class ll{constructor(e){this.serializer=e}$(e,t,n,r){let i=new rU("createOrUpgrade",t);n<1&&r>=1&&(function(e){e.createObjectStore("owner")}(e),e.createObjectStore("mutationQueues",{keyPath:"userId"}),e.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",rJ,{unique:!0}),e.createObjectStore("documentMutations"),lu(e),function(e){e.createObjectStore("remoteDocuments")}(e));let s=rM.resolve();return n<3&&r>=3&&(0!==n&&(e.deleteObjectStore("targetDocuments"),e.deleteObjectStore("targets"),e.deleteObjectStore("targetGlobal"),lu(e)),s=s.next(()=>(function(e){let t=e.store("targetGlobal"),n={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:rv.min().toTimestamp(),targetCount:0};return t.put("targetGlobalKey",n)})(i))),n<4&&r>=4&&(0!==n&&(s=s.next(()=>i.store("mutations").j().next(t=>{e.deleteObjectStore("mutations"),e.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",rJ,{unique:!0});let n=i.store("mutations"),r=t.map(e=>n.put(e));return rM.waitFor(r)}))),s=s.next(()=>{!function(e){e.createObjectStore("clientMetadata",{keyPath:"clientId"})}(e)})),n<5&&r>=5&&(s=s.next(()=>this.Js(i))),n<6&&r>=6&&(s=s.next(()=>((function(e){e.createObjectStore("remoteDocumentGlobal")})(e),this.Ys(i)))),n<7&&r>=7&&(s=s.next(()=>this.Xs(i))),n<8&&r>=8&&(s=s.next(()=>this.Zs(e,i))),n<9&&r>=9&&(s=s.next(()=>{e.objectStoreNames.contains("remoteDocumentChanges")&&e.deleteObjectStore("remoteDocumentChanges")})),n<10&&r>=10&&(s=s.next(()=>this.ti(i))),n<11&&r>=11&&(s=s.next(()=>{(function(e){e.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(e){e.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),n<12&&r>=12&&(s=s.next(()=>{!function(e){let t=e.createObjectStore("documentOverlays",{keyPath:it});t.createIndex("collectionPathOverlayIndex",ir,{unique:!1}),t.createIndex("collectionGroupOverlayIndex",ii,{unique:!1})}(e)})),n<13&&r>=13&&(s=s.next(()=>(function(e){let t=e.createObjectStore("remoteDocumentsV14",{keyPath:r0});t.createIndex("documentKeyIndex",r1),t.createIndex("collectionGroupIndex",r2)})(e)).next(()=>this.ei(e,i)).next(()=>e.deleteObjectStore("remoteDocuments"))),n<14&&r>=14&&(s=s.next(()=>this.ni(e,i))),n<15&&r>=15&&(s=s.next(()=>{e.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),e.createObjectStore("indexState",{keyPath:r3}).createIndex("sequenceNumberIndex",r7,{unique:!1}),e.createObjectStore("indexEntries",{keyPath:r8}).createIndex("documentKeyIndex",ie,{unique:!1})})),s}Ys(e){let t=0;return e.store("remoteDocuments").X((e,n)=>{t+=oP(n)}).next(()=>{let n={byteSize:t};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",n)})}Js(e){let t=e.store("mutationQueues"),n=e.store("mutations");return t.j().next(t=>rM.forEach(t,t=>{let r=IDBKeyRange.bound([t.userId,-1],[t.userId,t.lastAcknowledgedBatchId]);return n.j("userMutationsIndex",r).next(n=>rM.forEach(n,n=>{n.userId===t.userId||rr();let r=a9(this.serializer,n);return oO(e,t.userId,r).next(()=>{})}))}))}Xs(e){let t=e.store("targetDocuments"),n=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(e=>{let r=[];return n.X((n,i)=>{let s=new rb(n),a=[0,rQ(s)];r.push(t.get(a).next(n=>n?rM.resolve():t.put({targetId:0,path:rQ(s),sequenceNumber:e.highestListenSequenceNumber})))}).next(()=>rM.waitFor(r))})}Zs(e,t){e.createObjectStore("collectionParents",{keyPath:r5});let n=t.store("collectionParents"),r=new oI,i=e=>{if(r.add(e)){let t=e.lastSegment(),i=e.popLast();return n.put({collectionId:t,parent:rQ(i)})}};return t.store("remoteDocuments").X({Y:!0},(e,t)=>{let n=new rb(e);return i(n.popLast())}).next(()=>t.store("documentMutations").X({Y:!0},([e,t,n],r)=>{let s=rX(t);return i(s.popLast())}))}ti(e){let t=e.store("targets");return t.X((e,n)=>{let r=a6(n),i=a5(this.serializer,r);return t.put(i)})}ei(e,t){let n=t.store("remoteDocuments"),r=[];return n.X((e,n)=>{let i=t.store("remoteDocumentsV14"),s=(n.document?new rS(rb.fromString(n.document.name).popFirst(5)):n.noDocument?rS.fromSegments(n.noDocument.path):n.unknownDocument?rS.fromSegments(n.unknownDocument.path):rr()).path.toArray(),a={prefixPath:s.slice(0,s.length-2),collectionGroup:s[s.length-2],documentId:s[s.length-1],readTime:n.readTime||[0,0],unknownDocument:n.unknownDocument,noDocument:n.noDocument,document:n.document,hasCommittedMutations:!!n.hasCommittedMutations};r.push(i.put(a))}).next(()=>rM.waitFor(r))}ni(e,t){var n;let r=t.store("mutations"),i=(n=this.serializer,new oJ(n)),s=new ls(lo.js,this.serializer.le);return r.j().next(e=>{let n=new Map;return e.forEach(e=>{var t;let r=null!==(t=n.get(e.userId))&&void 0!==t?t:sB();a9(this.serializer,e).keys().forEach(e=>r=r.add(e)),n.set(e.userId,r)}),rM.forEach(n,(e,n)=>{let r=new n6(n),a=oi.fe(this.serializer,r),o=s.getIndexManager(r),l=oL.fe(r,this.serializer,o,s.referenceDelegate);return new o5(i,l,a,o).recalculateAndSaveOverlaysForDocumentKeys(new iu(t,rH.ct),e).next()})})}}function lu(e){e.createObjectStore("targetDocuments",{keyPath:r9}).createIndex("documentTargetsIndex",r6,{unique:!0}),e.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",r4,{unique:!0}),e.createObjectStore("targetGlobal")}let lc="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class lh{constructor(e,t,n,r,i,s,a,o,l,u,c=15){var h;if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=n,this.si=i,this.window=s,this.document=a,this.ii=l,this.ri=u,this.oi=c,this.Os=null,this.$s=!1,this.isPrimary=!1,this.networkEnabled=!0,this.ui=null,this.inForeground=!1,this.ci=null,this.ai=null,this.hi=Number.NEGATIVE_INFINITY,this.li=e=>Promise.resolve(),!lh.D())throw new rs(ri.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new oW(this,r),this.fi=t+"main",this.serializer=new aZ(o),this.di=new rF(this.fi,this.oi,new ll(this.serializer)),this.Fs=new o$(this.referenceDelegate,this.serializer),this.remoteDocumentCache=(h=this.serializer,new oJ(h)),this.Ls=new ot,this.window&&this.window.localStorage?this._i=this.window.localStorage:(this._i=null,!1===u&&re("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.wi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new rs(ri.FAILED_PRECONDITION,lc);return this.mi(),this.gi(),this.yi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Fs.getHighestSequenceNumber(e))}).then(e=>{this.Os=new rH(e,this.ii)}).then(()=>{this.$s=!0}).catch(e=>(this.di&&this.di.close(),Promise.reject(e)))}pi(e){return this.li=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.di.B(async t=>{null===t.newVersion&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.si.enqueueAndForget(async()=>{this.started&&await this.wi()}))}wi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>lf(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.Ii(e).next(e=>{e||(this.isPrimary=!1,this.si.enqueueRetryable(()=>this.li(!1)))})}).next(()=>this.Ti(e)).next(t=>this.isPrimary&&!t?this.Ei(e).next(()=>!1):!!t&&this.Ai(e).next(()=>!0))).catch(e=>{if(r$(e))return n8("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return n8("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.si.enqueueRetryable(()=>this.li(e)),this.isPrimary=e})}Ii(e){return ld(e).get("owner").next(e=>rM.resolve(this.Ri(e)))}vi(e){return lf(e).delete(this.clientId)}async Pi(){if(this.isPrimary&&!this.bi(this.hi,18e5)){this.hi=Date.now();let e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",e=>{let t=ic(e,"clientMetadata");return t.j().next(e=>{let n=this.Vi(e,18e5),r=e.filter(e=>-1===n.indexOf(e));return rM.forEach(r,e=>t.delete(e.clientId)).next(()=>r)})}).catch(()=>[]);if(this._i)for(let t of e)this._i.removeItem(this.Si(t.clientId))}}yi(){this.ai=this.si.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.wi().then(()=>this.Pi()).then(()=>this.yi()))}Ri(e){return!!e&&e.ownerId===this.clientId}Ti(e){return this.ri?rM.resolve(!0):ld(e).get("owner").next(t=>{if(null!==t&&this.bi(t.leaseTimestampMs,5e3)&&!this.Di(t.ownerId)){if(this.Ri(t)&&this.networkEnabled)return!0;if(!this.Ri(t)){if(!t.allowTabSynchronization)throw new rs(ri.FAILED_PRECONDITION,lc);return!1}}return!(!this.networkEnabled||!this.inForeground)||lf(e).j().next(e=>void 0===this.Vi(e,5e3).find(e=>{if(this.clientId!==e.clientId){let t=!this.networkEnabled&&e.networkEnabled,n=!this.inForeground&&e.inForeground,r=this.networkEnabled===e.networkEnabled;if(t||n&&r)return!0}return!1}))}).next(e=>(this.isPrimary!==e&&n8("IndexedDbPersistence",`Client ${e?"is":"is not"} eligible for a primary lease.`),e))}async shutdown(){this.$s=!1,this.Ci(),this.ai&&(this.ai.cancel(),this.ai=null),this.xi(),this.Ni(),await this.di.runTransaction("shutdown","readwrite",["owner","clientMetadata"],e=>{let t=new iu(e,rH.ct);return this.Ei(t).next(()=>this.vi(t))}),this.di.close(),this.ki()}Vi(e,t){return e.filter(e=>this.bi(e.updateTimeMs,t)&&!this.Di(e.clientId))}Mi(){return this.runTransaction("getActiveClients","readonly",e=>lf(e).j().next(e=>this.Vi(e,18e5).map(e=>e.clientId)))}get started(){return this.$s}getMutationQueue(e,t){return oL.fe(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Fs}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new oT(e,this.serializer.le.databaseId)}getDocumentOverlayCache(e){return oi.fe(this.serializer,e)}getBundleCache(){return this.Ls}runTransaction(e,t,n){var r;let i;n8("IndexedDbPersistence","Starting transaction:",e);let s=15===(r=this.oi)?il:14===r?io:13===r?io:12===r?ia:11===r?is:void rr();return this.di.runTransaction(e,"readonly"===t?"readonly":"readwrite",s,r=>(i=new iu(r,this.Os?this.Os.next():rH.ct),"readwrite-primary"===t?this.Ii(i).next(e=>!!e||this.Ti(i)).next(t=>{if(!t)throw re(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.si.enqueueRetryable(()=>this.li(!1)),new rs(ri.FAILED_PRECONDITION,rO);return n(i)}).next(e=>this.Ai(i).next(()=>e)):this.Oi(i).next(()=>n(i)))).then(e=>(i.raiseOnCommittedEvent(),e))}Oi(e){return ld(e).get("owner").next(e=>{if(null!==e&&this.bi(e.leaseTimestampMs,5e3)&&!this.Di(e.ownerId)&&!this.Ri(e)&&!(this.ri||this.allowTabSynchronization&&e.allowTabSynchronization))throw new rs(ri.FAILED_PRECONDITION,lc)})}Ai(e){let t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return ld(e).put("owner",t)}static D(){return rF.D()}Ei(e){let t=ld(e);return t.get("owner").next(e=>this.Ri(e)?(n8("IndexedDbPersistence","Releasing primary lease."),t.delete("owner")):rM.resolve())}bi(e,t){let n=Date.now();return!(e<n-t)&&(!(e>n)||(re(`Detected an update time that is in the future: ${e} > ${n}`),!1))}mi(){null!==this.document&&"function"==typeof this.document.addEventListener&&(this.ci=()=>{this.si.enqueueAndForget(()=>(this.inForeground="visible"===this.document.visibilityState,this.wi()))},this.document.addEventListener("visibilitychange",this.ci),this.inForeground="visible"===this.document.visibilityState)}xi(){this.ci&&(this.document.removeEventListener("visibilitychange",this.ci),this.ci=null)}gi(){var e;"function"==typeof(null===(e=this.window)||void 0===e?void 0:e.addEventListener)&&(this.ui=()=>{this.Ci();let e=/(?:Version|Mobile)\/1[456]/;(0,p.G6)()&&(navigator.appVersion.match(e)||navigator.userAgent.match(e))&&this.si.enterRestrictedMode(!0),this.si.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.ui))}Ni(){this.ui&&(this.window.removeEventListener("pagehide",this.ui),this.ui=null)}Di(e){var t;try{let n=null!==(null===(t=this._i)||void 0===t?void 0:t.getItem(this.Si(e)));return n8("IndexedDbPersistence",`Client '${e}' ${n?"is":"is not"} zombied in LocalStorage`),n}catch(r){return re("IndexedDbPersistence","Failed to get zombied client id.",r),!1}}Ci(){if(this._i)try{this._i.setItem(this.Si(this.clientId),String(Date.now()))}catch(e){re("Failed to set zombie client id.",e)}}ki(){if(this._i)try{this._i.removeItem(this.Si(this.clientId))}catch(e){}}Si(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function ld(e){return ic(e,"owner")}function lf(e){return ic(e,"clientMetadata")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ class lp{constructor(e,t,n,r){this.targetId=e,this.fromCache=t,this.$i=n,this.Fi=r}static Bi(e,t){let n=sB(),r=sB();for(let i of t.docChanges)switch(i.type){case 0:n=n.add(i.doc.key);break;case 1:r=r.add(i.doc.key)}return new lp(e,t.fromCache,n,r)}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ class lm{constructor(){this.Li=!1}initialize(e,t){this.qi=e,this.indexManager=t,this.Li=!0}getDocumentsMatchingQuery(e,t,n,r){return this.Ui(e,t).next(i=>i||this.Ki(e,t,r,n)).next(n=>n||this.Gi(e,t))}Ui(e,t){if(sv(t))return rM.resolve(null);let n=sS(t);return this.indexManager.getIndexType(e,n).next(r=>0===r?null:(null!==t.limit&&1===r&&(n=sS(t=sD(t,null,"F"))),this.indexManager.getDocumentsMatchingTarget(e,n).next(r=>{let i=sB(...r);return this.qi.getDocuments(e,i).next(r=>this.indexManager.getMinOffset(e,n).next(n=>{let s=this.Qi(t,r);return this.ji(t,s,i,n.readTime)?this.Ui(e,sD(t,null,"F")):this.zi(e,s,t,n)}))})))}Ki(e,t,n,r){return sv(t)||r.isEqual(rv.min())?this.Gi(e,t):this.qi.getDocuments(e,n).next(i=>{let s=this.Qi(t,i);return this.ji(t,s,n,r)?this.Gi(e,t):(n7()<=f.in.DEBUG&&n8("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),sC(t)),this.zi(e,s,t,function(e,t){let n=e.toTimestamp().seconds,r=e.toTimestamp().nanoseconds+1,i=rv.fromTimestamp(1e9===r?new r_(n+1,0):new r_(n,r));return new rR(i,rS.empty(),-1)}(r,0)))})}Qi(e,t){let n=new i_(sR(e));return t.forEach((t,r)=>{sN(e,r)&&(n=n.add(r))}),n}ji(e,t,n,r){if(null===e.limit)return!1;if(n.size!==t.size)return!0;let i="F"===e.limitType?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)}Gi(e,t){return n7()<=f.in.DEBUG&&n8("QueryEngine","Using full collection scan to execute query:",sC(t)),this.qi.getDocumentsMatchingQuery(e,t,rR.min())}zi(e,t,n,r){return this.qi.getDocumentsMatchingQuery(e,n,r).next(e=>(t.forEach(t=>{e=e.insert(t.key,t)}),e))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ class lg{constructor(e,t,n,r){this.persistence=e,this.Wi=t,this.serializer=r,this.Hi=new im(rg),this.Ji=new sA(e=>sh(e),sd),this.Yi=new Map,this.Xi=e.getRemoteDocumentCache(),this.Fs=e.getTargetCache(),this.Ls=e.getBundleCache(),this.Zi(n)}Zi(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new o5(this.Xi,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Xi.setIndexManager(this.indexManager),this.Wi.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.Hi))}}async function ly(e,t){return await e.persistence.runTransaction("Handle user change","readonly",n=>{let r;return e.mutationQueue.getAllMutationBatches(n).next(i=>(r=i,e.Zi(t),e.mutationQueue.getAllMutationBatches(n))).next(t=>{let i=[],s=[],a=sB();for(let o of r)for(let l of(i.push(o.batchId),o.mutations))a=a.add(l.key);for(let u of t)for(let c of(s.push(u.batchId),u.mutations))a=a.add(c.key);return e.localDocuments.getDocuments(n,a).next(e=>({tr:e,removedBatchIds:i,addedBatchIds:s}))})})}function l_(e){return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Fs.getLastRemoteSnapshotVersion(t))}async function lv(e,t,n){let r=e,i=r.Hi.get(t);try{n||await r.persistence.runTransaction("Release target",n?"readwrite":"readwrite-primary",e=>r.persistence.referenceDelegate.removeTarget(e,i))}catch(s){if(!r$(s))throw s;n8("LocalStore",`Failed to update sequence numbers for target ${t}: ${s}`)}r.Hi=r.Hi.remove(t),r.Ji.delete(i.target)}function lw(e,t,n){let r=rv.min(),i=sB();return e.persistence.runTransaction("Execute query","readonly",s=>(function(e,t,n){let r=e.Ji.get(n);return void 0!==r?rM.resolve(e.Hi.get(r)):e.Fs.getTargetData(t,n)})(e,s,sS(t)).next(t=>{if(t)return r=t.lastLimboFreeSnapshotVersion,e.Fs.getMatchingKeysForTargetId(s,t.targetId).next(e=>{i=e})}).next(()=>e.Wi.getDocumentsMatchingQuery(s,t,n?r:rv.min(),n?i:sB())).next(n=>{var r;let s;return r=t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2)),s=e.Yi.get(r)||rv.min(),n.forEach((e,t)=>{t.readTime.compareTo(s)>0&&(s=t.readTime)}),e.Yi.set(r,s),{documents:n,sr:i}}))}class lb{constructor(){this.activeTargetIds=s$}hr(e){this.activeTargetIds=this.activeTargetIds.add(e)}lr(e){this.activeTargetIds=this.activeTargetIds.delete(e)}ar(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class lE{constructor(){this.Wr=new lb,this.Hr={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e){return this.Wr.hr(e),this.Hr[e]||"not-current"}updateQueryState(e,t,n){this.Hr[e]=t}removeLocalQueryTarget(e){this.Wr.lr(e)}isLocalQueryTarget(e){return this.Wr.activeTargetIds.has(e)}clearQueryState(e){delete this.Hr[e]}getAllActiveQueryTargets(){return this.Wr.activeTargetIds}isActiveQueryTarget(e){return this.Wr.activeTargetIds.has(e)}start(){return this.Wr=new lb,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ class lI{Jr(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ class lS{constructor(){this.Yr=()=>this.Xr(),this.Zr=()=>this.eo(),this.no=[],this.so()}Jr(e){this.no.push(e)}shutdown(){window.removeEventListener("online",this.Yr),window.removeEventListener("offline",this.Zr)}so(){window.addEventListener("online",this.Yr),window.addEventListener("offline",this.Zr)}Xr(){for(let e of(n8("ConnectivityMonitor","Network connectivity changed: AVAILABLE"),this.no))e(0)}eo(){for(let e of(n8("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE"),this.no))e(1)}static D(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ let lT=null;function lD(){return null===lT?lT=268435456+Math.round(2147483648*Math.random()):lT++,"0x"+lT.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ let lx={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ class lk{constructor(e){this.io=e.io,this.ro=e.ro}oo(e){this.uo=e}co(e){this.ao=e}onMessage(e){this.ho=e}close(){this.ro()}send(e){this.io(e)}lo(){this.uo()}fo(e){this.ao(e)}_o(e){this.ho(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ let lC="WebChannelConnection";class lN extends class{constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;let t=e.ssl?"https":"http";this.wo=t+"://"+e.host,this.mo="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}get yo(){return!1}po(e,t,n,r,i){let s=lD(),a=this.Io(e,t);n8("RestConnection",`Sending RPC '${e}' ${s}:`,a,n);let o={};return this.To(o,r,i),this.Eo(e,a,o,n).then(t=>(n8("RestConnection",`Received RPC '${e}' ${s}: `,t),t),t=>{throw rt("RestConnection",`RPC '${e}' ${s} failed with error: `,t,"url: ",a,"request:",n),t})}Ao(e,t,n,r,i,s){return this.po(e,t,n,r,i)}To(e,t,n){e["X-Goog-Api-Client"]="gl-js/ fire/"+n5,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((t,n)=>e[n]=t),n&&n.headers.forEach((t,n)=>e[n]=t)}Io(e,t){let n=lx[e];return`${this.wo}/v1/${t}:${n}`}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams}Eo(e,t,n,r){let i=lD();return new Promise((s,a)=>{let o=new n0;o.setWithCredentials(!0),o.listenOnce(nW.COMPLETE,()=>{try{switch(o.getLastErrorCode()){case nH.NO_ERROR:let t=o.getResponseJson();n8(lC,`XHR for RPC '${e}' ${i} received:`,JSON.stringify(t)),s(t);break;case nH.TIMEOUT:n8(lC,`RPC '${e}' ${i} timed out`),a(new rs(ri.DEADLINE_EXCEEDED,"Request time out"));break;case nH.HTTP_ERROR:let n=o.getStatus();if(n8(lC,`RPC '${e}' ${i} failed with status:`,n,"response text:",o.getResponseText()),n>0){let r=o.getResponseJson();Array.isArray(r)&&(r=r[0]);let l=null==r?void 0:r.error;if(l&&l.status&&l.message){let u=function(e){let t=e.toLowerCase().replace(/_/g,"-");return Object.values(ri).indexOf(t)>=0?t:ri.UNKNOWN}(l.status);a(new rs(u,l.message))}else a(new rs(ri.UNKNOWN,"Server responded with status "+o.getStatus()))}else a(new rs(ri.UNAVAILABLE,"Connection failed."));break;default:rr()}}finally{n8(lC,`RPC '${e}' ${i} completed.`)}});let l=JSON.stringify(r);n8(lC,`RPC '${e}' ${i} sending request:`,r),o.send(t,"POST",l,n,15)})}Ro(e,t,n){let r=lD(),i=[this.wo,"/","google.firestore.v1.Firestore","/",e,"/channel"],s=nK(),a=nY(),o={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(o.xmlHttpFactory=new nJ({})),this.To(o.initMessageHeaders,t,n),o.encodeInitMessageHeaders=!0;let u=i.join("");n8(lC,`Creating RPC '${e}' stream ${r}: ${u}`,o);let c=s.createWebChannel(u,o),h=!1,d=!1,f=new lk({io(t){d?n8(lC,`Not sending because RPC '${e}' stream ${r} is closed:`,t):(h||(n8(lC,`Opening RPC '${e}' stream ${r} transport.`),c.open(),h=!0),n8(lC,`RPC '${e}' stream ${r} sending:`,t),c.send(t))},ro:()=>c.close()}),p=(e,t,n)=>{e.listen(t,e=>{try{n(e)}catch(t){setTimeout(()=>{throw t},0)}})};return p(c,nZ.EventType.OPEN,()=>{d||n8(lC,`RPC '${e}' stream ${r} transport opened.`)}),p(c,nZ.EventType.CLOSE,()=>{d||(d=!0,n8(lC,`RPC '${e}' stream ${r} transport closed`),f.fo())}),p(c,nZ.EventType.ERROR,t=>{d||(d=!0,rt(lC,`RPC '${e}' stream ${r} transport errored:`,t),f.fo(new rs(ri.UNAVAILABLE,"The operation could not be completed")))}),p(c,nZ.EventType.MESSAGE,t=>{var n;if(!d){let i=t.data[0];i||rr();let s=i.error||(null===(n=i[0])||void 0===n?void 0:n.error);if(s){n8(lC,`RPC '${e}' stream ${r} received error:`,s);let a=s.status,o=function(e){let t=l[e];if(void 0!==t)return ac(t)}(a),u=s.message;void 0===o&&(o=ri.INTERNAL,u="Unknown error status: "+a+" with message "+s.message),d=!0,f.fo(new rs(o,u)),c.close()}else n8(lC,`RPC '${e}' stream ${r} received:`,i),f._o(i)}}),p(a,nQ.STAT_EVENT,t=>{t.stat===nX.PROXY?n8(lC,`RPC '${e}' stream ${r} detected buffering proxy`):t.stat===nX.NOPROXY&&n8(lC,`RPC '${e}' stream ${r} detected no buffering proxy`)}),setTimeout(()=>{f.lo()},0),f}}function lR(){return"undefined"!=typeof document?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ function lA(e){return new aN(e,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ class lO{constructor(e,t,n=1e3,r=1.5,i=6e4){this.si=e,this.timerId=t,this.vo=n,this.Po=r,this.bo=i,this.Vo=0,this.So=null,this.Do=Date.now(),this.reset()}reset(){this.Vo=0}Co(){this.Vo=this.bo}xo(e){this.cancel();let t=Math.floor(this.Vo+this.No()),n=Math.max(0,Date.now()-this.Do),r=Math.max(0,t-n);r>0&&n8("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.Vo} ms, delay with jitter: ${t} ms, last attempt: ${n} ms ago)`),this.So=this.si.enqueueAfterDelay(this.timerId,r,()=>(this.Do=Date.now(),e())),this.Vo*=this.Po,this.Vo<this.vo&&(this.Vo=this.vo),this.Vo>this.bo&&(this.Vo=this.bo)}ko(){null!==this.So&&(this.So.skipDelay(),this.So=null)}cancel(){null!==this.So&&(this.So.cancel(),this.So=null)}No(){return(Math.random()-.5)*this.Vo}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ class lP{constructor(e,t,n,r,i,s,a,o){this.si=e,this.Mo=n,this.Oo=r,this.connection=i,this.authCredentialsProvider=s,this.appCheckCredentialsProvider=a,this.listener=o,this.state=0,this.$o=0,this.Fo=null,this.Bo=null,this.stream=null,this.Lo=new lO(e,t)}qo(){return 1===this.state||5===this.state||this.Uo()}Uo(){return 2===this.state||3===this.state}start(){4!==this.state?this.auth():this.Ko()}async stop(){this.qo()&&await this.close(0)}Go(){this.state=0,this.Lo.reset()}Qo(){this.Uo()&&null===this.Fo&&(this.Fo=this.si.enqueueAfterDelay(this.Mo,6e4,()=>this.jo()))}zo(e){this.Wo(),this.stream.send(e)}async jo(){if(this.Uo())return this.close(0)}Wo(){this.Fo&&(this.Fo.cancel(),this.Fo=null)}Ho(){this.Bo&&(this.Bo.cancel(),this.Bo=null)}async close(e,t){this.Wo(),this.Ho(),this.Lo.cancel(),this.$o++,4!==e?this.Lo.reset():t&&t.code===ri.RESOURCE_EXHAUSTED?(re(t.toString()),re("Using maximum backoff delay to prevent overloading the backend."),this.Lo.Co()):t&&t.code===ri.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.Jo(),this.stream.close(),this.stream=null),this.state=e,await this.listener.co(t)}Jo(){}auth(){this.state=1;let e=this.Yo(this.$o),t=this.$o;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([e,n])=>{this.$o===t&&this.Xo(e,n)},t=>{e(()=>{let e=new rs(ri.UNKNOWN,"Fetching auth token failed: "+t.message);return this.Zo(e)})})}Xo(e,t){let n=this.Yo(this.$o);this.stream=this.tu(e,t),this.stream.oo(()=>{n(()=>(this.state=2,this.Bo=this.si.enqueueAfterDelay(this.Oo,1e4,()=>(this.Uo()&&(this.state=3),Promise.resolve())),this.listener.oo()))}),this.stream.co(e=>{n(()=>this.Zo(e))}),this.stream.onMessage(e=>{n(()=>this.onMessage(e))})}Ko(){this.state=5,this.Lo.xo(async()=>{this.state=0,this.start()})}Zo(e){return n8("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}Yo(e){return t=>{this.si.enqueueAndForget(()=>this.$o===e?t():(n8("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class lL extends lP{constructor(e,t,n,r,i,s){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,n,r,s),this.serializer=i}tu(e,t){return this.connection.Ro("Listen",e,t)}onMessage(e){this.Lo.reset();let t=function(e,t){let n;if("targetChange"in t){var r,i;t.targetChange;let s="NO_CHANGE"===(r=t.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===r?1:"REMOVE"===r?2:"CURRENT"===r?3:"RESET"===r?4:rr(),a=t.targetChange.targetIds||[],o=(i=t.targetChange.resumeToken,e.useProto3Json?(void 0===i||"string"==typeof i||rr(),iI.fromBase64String(i||"")):(void 0===i||i instanceof Uint8Array||rr(),iI.fromUint8Array(i||new Uint8Array))),l=t.targetChange.cause,u=l&&function(e){let t=void 0===e.code?ri.UNKNOWN:ac(e.code);return new rs(t,e.message||"")}(l);n=new aE(s,a,o,u||null)}else if("documentChange"in t){t.documentChange;let c=t.documentChange;c.document,c.document.name,c.document.updateTime;let h=aF(e,c.document.name),d=aP(c.document.updateTime),f=c.document.createTime?aP(c.document.createTime):rv.min(),p=new iX({mapValue:{fields:c.document.fields}}),m=iJ.newFoundDocument(h,d,f,p),g=c.targetIds||[],y=c.removedTargetIds||[];n=new aw(g,y,m.key,m)}else if("documentDelete"in t){t.documentDelete;let _=t.documentDelete;_.document;let v=aF(e,_.document),w=_.readTime?aP(_.readTime):rv.min(),b=iJ.newNoDocument(v,w),E=_.removedTargetIds||[];n=new aw([],E,b.key,b)}else if("documentRemove"in t){t.documentRemove;let I=t.documentRemove;I.document;let S=aF(e,I.document),T=I.removedTargetIds||[];n=new aw([],T,S,null)}else{if(!("filter"in t))return rr();{t.filter;let D=t.filter;D.targetId;let{count:x=0,unchangedNames:k}=D,C=new au(x,k),N=D.targetId;n=new ab(N,C)}}return n}(this.serializer,e),n=function(e){if(!("targetChange"in e))return rv.min();let t=e.targetChange;return t.targetIds&&t.targetIds.length?rv.min():t.readTime?aP(t.readTime):rv.min()}(e);return this.listener.eu(t,n)}nu(e){let t={};t.database=a$(this.serializer),t.addTarget=function(e,t){let n;let r=t.target;if((n=sf(r)?{documents:aK(e,r)}:{query:aY(e,r)}).targetId=t.targetId,t.resumeToken.approximateByteSize()>0){n.resumeToken=aO(e,t.resumeToken);let i=aR(e,t.expectedCount);null!==i&&(n.expectedCount=i)}else if(t.snapshotVersion.compareTo(rv.min())>0){n.readTime=aA(e,t.snapshotVersion.toTimestamp());let s=aR(e,t.expectedCount);null!==s&&(n.expectedCount=s)}return n}(this.serializer,e);let n=function(e,t){let n=function(e){switch(e){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return rr()}}(t.purpose);return null==n?null:{"goog-listen-tags":n}}(this.serializer,e);n&&(t.labels=n),this.zo(t)}su(e){let t={};t.database=a$(this.serializer),t.removeTarget=e,this.zo(t)}}class lM extends lP{constructor(e,t,n,r,i,s){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,n,r,s),this.serializer=i,this.iu=!1}get ru(){return this.iu}start(){this.iu=!1,this.lastStreamToken=void 0,super.start()}Jo(){this.iu&&this.ou([])}tu(e,t){return this.connection.Ro("Write",e,t)}onMessage(e){var t,n;if(e.streamToken||rr(),this.lastStreamToken=e.streamToken,this.iu){this.Lo.reset();let r=(t=e.writeResults,n=e.commitTime,t&&t.length>0?(void 0!==n||rr(),t.map(e=>{let t;return(t=e.updateTime?aP(e.updateTime):aP(n)).isEqual(rv.min())&&(t=aP(n)),new s1(t,e.transformResults||[])})):[]),i=aP(e.commitTime);return this.listener.uu(i,r)}return e.writeResults&&0!==e.writeResults.length&&rr(),this.iu=!0,this.listener.cu()}au(){let e={};e.database=a$(this.serializer),this.zo(e)}ou(e){let t={streamToken:this.lastStreamToken,writes:e.map(e=>aq(this.serializer,e))};this.zo(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ class lU extends class{}{constructor(e,t,n,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=n,this.serializer=r,this.hu=!1}lu(){if(this.hu)throw new rs(ri.FAILED_PRECONDITION,"The client has already been terminated.")}po(e,t,n){return this.lu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([r,i])=>this.connection.po(e,t,n,r,i)).catch(e=>{throw"FirebaseError"===e.name?(e.code===ri.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new rs(ri.UNKNOWN,e.toString())})}Ao(e,t,n,r){return this.lu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,s])=>this.connection.Ao(e,t,n,i,s,r)).catch(e=>{throw"FirebaseError"===e.name?(e.code===ri.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new rs(ri.UNKNOWN,e.toString())})}terminate(){this.hu=!0}}async function lF(e,t,n){var r;let{request:i,fu:s}=function(e,t,n){let r=aY(e,t),i={},s=[],a=0;return n.forEach(e=>{let t="aggregate_"+a++;i[t]=e.alias,"count"===e.gt?s.push({alias:t,count:{}}):"avg"===e.gt?s.push({alias:t,avg:{field:aW(e.fieldPath)}}):"sum"===e.gt&&s.push({alias:t,sum:{field:aW(e.fieldPath)}})}),{request:{structuredAggregationQuery:{aggregations:s,structuredQuery:r.structuredQuery},parent:r.parent},fu:i}}(e.serializer,sS(t),n),a=i.parent;e.connection.yo||delete i.parent;let o=(await e.Ao("RunAggregationQuery",a,i,1)).filter(e=>!!e.result);1===o.length||rr();let l=null===(r=o[0].result)||void 0===r?void 0:r.aggregateFields;return Object.keys(l).reduce((e,t)=>(e[s[t]]=l[t],e),{})}class lj{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.du=0,this._u=null,this.wu=!0}mu(){0===this.du&&(this.gu("Unknown"),this._u=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._u=null,this.yu("Backend didn't respond within 10 seconds."),this.gu("Offline"),Promise.resolve())))}pu(e){"Online"===this.state?this.gu("Unknown"):(this.du++,this.du>=1&&(this.Iu(),this.yu(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.gu("Offline")))}set(e){this.Iu(),this.du=0,"Online"===e&&(this.wu=!1),this.gu(e)}gu(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}yu(e){let t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.wu?(re(t),this.wu=!1):n8("OnlineStateTracker",t)}Iu(){null!==this._u&&(this._u.cancel(),this._u=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ class lB{constructor(e,t,n,r,i){this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.Tu=[],this.Eu=new Map,this.Au=new Set,this.Ru=[],this.vu=i,this.vu.Jr(e=>{n.enqueueAndForget(async()=>{lW(this)&&(n8("RemoteStore","Restarting streams for network reachability change."),await async function(e){e.Au.add(4),await lV(e),e.Pu.set("Unknown"),e.Au.delete(4),await l$(e)}(this))})}),this.Pu=new lj(n,r)}}async function l$(e){if(lW(e))for(let t of e.Ru)await t(!0)}async function lV(e){for(let t of e.Ru)await t(!1)}function lG(e,t){e.Eu.has(t.targetId)||(e.Eu.set(t.targetId,t),lH(e)?lY(e):ue(e).Uo()&&lz(e,t))}function lq(e,t){let n=ue(e);e.Eu.delete(t),n.Uo()&&lK(e,t),0===e.Eu.size&&(n.Uo()?n.Qo():lW(e)&&e.Pu.set("Unknown"))}function lz(e,t){if(e.bu.Lt(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(rv.min())>0){let n=e.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(n)}ue(e).nu(t)}function lK(e,t){e.bu.Lt(t),ue(e).su(t)}function lY(e){e.bu=new aS({getRemoteKeysForTarget:t=>e.remoteSyncer.getRemoteKeysForTarget(t),he:t=>e.Eu.get(t)||null,oe:()=>e.datastore.serializer.databaseId}),ue(e).start(),e.Pu.mu()}function lH(e){return lW(e)&&!ue(e).qo()&&e.Eu.size>0}function lW(e){return 0===e.Au.size}async function lQ(e){e.Eu.forEach((t,n)=>{lz(e,t)})}async function lX(e,t){e.bu=void 0,lH(e)?(e.Pu.pu(t),lY(e)):e.Pu.set("Unknown")}async function lJ(e,t,n){if(e.Pu.set("Online"),t instanceof aE&&2===t.state&&t.cause)try{await async function(e,t){let n=t.cause;for(let r of t.targetIds)e.Eu.has(r)&&(await e.remoteSyncer.rejectListen(r,n),e.Eu.delete(r),e.bu.removeTarget(r))}(e,t)}catch(r){n8("RemoteStore","Failed to remove targets %s: %s ",t.targetIds.join(","),r),await lZ(e,r)}else if(t instanceof aw?e.bu.Wt(t):t instanceof ab?e.bu.ee(t):e.bu.Yt(t),!n.isEqual(rv.min()))try{let i=await l_(e.localStore);n.compareTo(i)>=0&&await function(e,t){let n=e.bu.ue(t);return n.targetChanges.forEach((n,r)=>{if(n.resumeToken.approximateByteSize()>0){let i=e.Eu.get(r);i&&e.Eu.set(r,i.withResumeToken(n.resumeToken,t))}}),n.targetMismatches.forEach((t,n)=>{let r=e.Eu.get(t);if(!r)return;e.Eu.set(t,r.withResumeToken(iI.EMPTY_BYTE_STRING,r.snapshotVersion)),lK(e,t);let i=new aJ(r.target,t,n,r.sequenceNumber);lz(e,i)}),e.remoteSyncer.applyRemoteEvent(n)}(e,n)}catch(s){n8("RemoteStore","Failed to raise snapshot:",s),await lZ(e,s)}}async function lZ(e,t,n){if(!r$(t))throw t;e.Au.add(1),await lV(e),e.Pu.set("Offline"),n||(n=()=>l_(e.localStore)),e.asyncQueue.enqueueRetryable(async()=>{n8("RemoteStore","Retrying IndexedDB access"),await n(),e.Au.delete(1),await l$(e)})}function l0(e,t){return t().catch(n=>lZ(e,n,t))}async function l1(e){let t=ut(e),n=e.Tu.length>0?e.Tu[e.Tu.length-1].batchId:-1;for(;lW(e)&&e.Tu.length<10;)try{let r=await function(e,t){return e.persistence.runTransaction("Get next mutation batch","readonly",n=>(void 0===t&&(t=-1),e.mutationQueue.getNextMutationBatchAfterBatchId(n,t)))}(e.localStore,n);if(null===r){0===e.Tu.length&&t.Qo();break}n=r.batchId,function(e,t){e.Tu.push(t);let n=ut(e);n.Uo()&&n.ru&&n.ou(t.mutations)}(e,r)}catch(i){await lZ(e,i)}l2(e)&&l4(e)}function l2(e){return lW(e)&&!ut(e).qo()&&e.Tu.length>0}function l4(e){ut(e).start()}async function l9(e){ut(e).au()}async function l6(e){let t=ut(e);for(let n of e.Tu)t.ou(n.mutations)}async function l5(e,t,n){let r=e.Tu.shift(),i=aa.from(r,t,n);await l0(e,()=>e.remoteSyncer.applySuccessfulWrite(i)),await l1(e)}async function l3(e,t){t&&ut(e).ru&&await async function(e,t){var n;if(function(e){switch(e){default:return rr();case ri.CANCELLED:case ri.UNKNOWN:case ri.DEADLINE_EXCEEDED:case ri.RESOURCE_EXHAUSTED:case ri.INTERNAL:case ri.UNAVAILABLE:case ri.UNAUTHENTICATED:return!1;case ri.INVALID_ARGUMENT:case ri.NOT_FOUND:case ri.ALREADY_EXISTS:case ri.PERMISSION_DENIED:case ri.FAILED_PRECONDITION:case ri.ABORTED:case ri.OUT_OF_RANGE:case ri.UNIMPLEMENTED:case ri.DATA_LOSS:return!0}}(n=t.code)&&n!==ri.ABORTED){let r=e.Tu.shift();ut(e).Go(),await l0(e,()=>e.remoteSyncer.rejectFailedWrite(r.batchId,t)),await l1(e)}}(e,t),l2(e)&&l4(e)}async function l7(e,t){e.asyncQueue.verifyOperationInProgress(),n8("RemoteStore","RemoteStore received new credentials");let n=lW(e);e.Au.add(3),await lV(e),n&&e.Pu.set("Unknown"),await e.remoteSyncer.handleCredentialChange(t),e.Au.delete(3),await l$(e)}async function l8(e,t){t?(e.Au.delete(2),await l$(e)):t||(e.Au.add(2),await lV(e),e.Pu.set("Unknown"))}function ue(e){var t,n,r;return e.Vu||(e.Vu=(t=e.datastore,n=e.asyncQueue,r={oo:lQ.bind(null,e),co:lX.bind(null,e),eu:lJ.bind(null,e)},t.lu(),new lL(n,t.connection,t.authCredentials,t.appCheckCredentials,t.serializer,r)),e.Ru.push(async t=>{t?(e.Vu.Go(),lH(e)?lY(e):e.Pu.set("Unknown")):(await e.Vu.stop(),e.bu=void 0)})),e.Vu}function ut(e){var t,n,r;return e.Su||(e.Su=(t=e.datastore,n=e.asyncQueue,r={oo:l9.bind(null,e),co:l3.bind(null,e),cu:l6.bind(null,e),uu:l5.bind(null,e)},t.lu(),new lM(n,t.connection,t.authCredentials,t.appCheckCredentials,t.serializer,r)),e.Ru.push(async t=>{t?(e.Su.Go(),await l1(e)):(await e.Su.stop(),e.Tu.length>0&&(n8("RemoteStore",`Stopping write stream with ${e.Tu.length} pending writes`),e.Tu=[]))})),e.Su}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ class un{constructor(e,t,n,r,i){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=r,this.removalCallback=i,this.deferred=new ra,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(e=>{})}static createAndSchedule(e,t,n,r,i){let s=Date.now()+n,a=new un(e,t,s,r,i);return a.start(n),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new rs(ri.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function ur(e,t){if(re("AsyncQueue",`${t}: ${e}`),r$(e))return new rs(ri.UNAVAILABLE,`${t}: ${e}`);throw e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ class ui{constructor(e){this.comparator=e?(t,n)=>e(t,n)||rS.comparator(t.key,n.key):(e,t)=>rS.comparator(e.key,t.key),this.keyedMap=sL(),this.sortedSet=new im(this.comparator)}static emptySet(e){return new ui(e.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){let t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,n)=>(e(t),!1))}add(e){let t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){let t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof ui)||this.size!==e.size)return!1;let t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;t.hasNext();){let r=t.getNext().key,i=n.getNext().key;if(!r.isEqual(i))return!1}return!0}toString(){let e=[];return this.forEach(t=>{e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,t){let n=new ui;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ class us{constructor(){this.Du=new im(rS.comparator)}track(e){let t=e.doc.key,n=this.Du.get(t);n?0!==e.type&&3===n.type?this.Du=this.Du.insert(t,e):3===e.type&&1!==n.type?this.Du=this.Du.insert(t,{type:n.type,doc:e.doc}):2===e.type&&2===n.type?this.Du=this.Du.insert(t,{type:2,doc:e.doc}):2===e.type&&0===n.type?this.Du=this.Du.insert(t,{type:0,doc:e.doc}):1===e.type&&0===n.type?this.Du=this.Du.remove(t):1===e.type&&2===n.type?this.Du=this.Du.insert(t,{type:1,doc:n.doc}):0===e.type&&1===n.type?this.Du=this.Du.insert(t,{type:2,doc:e.doc}):rr():this.Du=this.Du.insert(t,e)}Cu(){let e=[];return this.Du.inorderTraversal((t,n)=>{e.push(n)}),e}}class ua{constructor(e,t,n,r,i,s,a,o,l){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=i,this.fromCache=s,this.syncStateChanged=a,this.excludesMetadataChanges=o,this.hasCachedResults=l}static fromInitialDocuments(e,t,n,r,i){let s=[];return t.forEach(e=>{s.push({type:0,doc:e})}),new ua(e,t,ui.emptySet(t),s,n,r,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&sx(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;let t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let r=0;r<t.length;r++)if(t[r].type!==n[r].type||!t[r].doc.isEqual(n[r].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ class uo{constructor(){this.xu=void 0,this.listeners=[]}}class ul{constructor(){this.queries=new sA(e=>sk(e),sx),this.onlineState="Unknown",this.Nu=new Set}}async function uu(e,t){let n=t.query,r=!1,i=e.queries.get(n);if(i||(r=!0,i=new uo),r)try{i.xu=await e.onListen(n)}catch(a){let s=ur(a,`Initialization of query '${sC(t.query)}' failed`);return void t.onError(s)}e.queries.set(n,i),i.listeners.push(t),t.ku(e.onlineState),i.xu&&t.Mu(i.xu)&&uf(e)}async function uc(e,t){let n=t.query,r=!1,i=e.queries.get(n);if(i){let s=i.listeners.indexOf(t);s>=0&&(i.listeners.splice(s,1),r=0===i.listeners.length)}if(r)return e.queries.delete(n),e.onUnlisten(n)}function uh(e,t){let n=!1;for(let r of t){let i=r.query,s=e.queries.get(i);if(s){for(let a of s.listeners)a.Mu(r)&&(n=!0);s.xu=r}}n&&uf(e)}function ud(e,t,n){let r=e.queries.get(t);if(r)for(let i of r.listeners)i.onError(n);e.queries.delete(t)}function uf(e){e.Nu.forEach(e=>{e.next()})}class up{constructor(e,t,n){this.query=e,this.Ou=t,this.$u=!1,this.Fu=null,this.onlineState="Unknown",this.options=n||{}}Mu(e){if(!this.options.includeMetadataChanges){let t=[];for(let n of e.docChanges)3!==n.type&&t.push(n);e=new ua(e.query,e.docs,e.oldDocs,t,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let r=!1;return this.$u?this.Bu(e)&&(this.Ou.next(e),r=!0):this.Lu(e,this.onlineState)&&(this.qu(e),r=!0),this.Fu=e,r}onError(e){this.Ou.error(e)}ku(e){this.onlineState=e;let t=!1;return this.Fu&&!this.$u&&this.Lu(this.Fu,e)&&(this.qu(this.Fu),t=!0),t}Lu(e,t){return!e.fromCache||(!this.options.Uu||!("Offline"!==t))&&(!e.docs.isEmpty()||e.hasCachedResults||"Offline"===t)}Bu(e){if(e.docChanges.length>0)return!0;let t=this.Fu&&this.Fu.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&!0===this.options.includeMetadataChanges}qu(e){e=ua.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.$u=!0,this.Ou.next(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ class um{constructor(e){this.key=e}}class ug{constructor(e){this.key=e}}class uy{constructor(e,t){this.query=e,this.Ju=t,this.Yu=null,this.hasCachedResults=!1,this.current=!1,this.Xu=sB(),this.mutatedKeys=sB(),this.Zu=sR(e),this.tc=new ui(this.Zu)}get ec(){return this.Ju}nc(e,t){let n=t?t.sc:new us,r=t?t.tc:this.tc,i=t?t.mutatedKeys:this.mutatedKeys,s=r,a=!1,o="F"===this.query.limitType&&r.size===this.query.limit?r.last():null,l="L"===this.query.limitType&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal((e,t)=>{let u=r.get(e),c=sN(this.query,t)?t:null,h=!!u&&this.mutatedKeys.has(u.key),d=!!c&&(c.hasLocalMutations||this.mutatedKeys.has(c.key)&&c.hasCommittedMutations),f=!1;u&&c?u.data.isEqual(c.data)?h!==d&&(n.track({type:3,doc:c}),f=!0):this.ic(u,c)||(n.track({type:2,doc:c}),f=!0,(o&&this.Zu(c,o)>0||l&&0>this.Zu(c,l))&&(a=!0)):!u&&c?(n.track({type:0,doc:c}),f=!0):u&&!c&&(n.track({type:1,doc:u}),f=!0,(o||l)&&(a=!0)),f&&(c?(s=s.add(c),i=d?i.add(e):i.delete(e)):(s=s.delete(e),i=i.delete(e)))}),null!==this.query.limit)for(;s.size>this.query.limit;){let u="F"===this.query.limitType?s.last():s.first();s=s.delete(u.key),i=i.delete(u.key),n.track({type:1,doc:u})}return{tc:s,sc:n,ji:a,mutatedKeys:i}}ic(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n){let r=this.tc;this.tc=e.tc,this.mutatedKeys=e.mutatedKeys;let i=e.sc.Cu();i.sort((e,t)=>(function(e,t){let n=e=>{switch(e){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return rr()}};return n(e)-n(t)})(e.type,t.type)||this.Zu(e.doc,t.doc)),this.rc(n);let s=t?this.oc():[],a=0===this.Xu.size&&this.current?1:0,o=a!==this.Yu;return(this.Yu=a,0!==i.length||o)?{snapshot:new ua(this.query,e.tc,r,i,e.mutatedKeys,0===a,o,!1,!!n&&n.resumeToken.approximateByteSize()>0),uc:s}:{uc:s}}ku(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({tc:this.tc,sc:new us,mutatedKeys:this.mutatedKeys,ji:!1},!1)):{uc:[]}}cc(e){return!this.Ju.has(e)&&!!this.tc.has(e)&&!this.tc.get(e).hasLocalMutations}rc(e){e&&(e.addedDocuments.forEach(e=>this.Ju=this.Ju.add(e)),e.modifiedDocuments.forEach(e=>{}),e.removedDocuments.forEach(e=>this.Ju=this.Ju.delete(e)),this.current=e.current)}oc(){if(!this.current)return[];let e=this.Xu;this.Xu=sB(),this.tc.forEach(e=>{this.cc(e.key)&&(this.Xu=this.Xu.add(e.key))});let t=[];return e.forEach(e=>{this.Xu.has(e)||t.push(new ug(e))}),this.Xu.forEach(n=>{e.has(n)||t.push(new um(n))}),t}ac(e){this.Ju=e.sr,this.Xu=sB();let t=this.nc(e.documents);return this.applyChanges(t,!0)}hc(){return ua.fromInitialDocuments(this.query,this.tc,this.mutatedKeys,0===this.Yu,this.hasCachedResults)}}class u_{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}}class uv{constructor(e){this.key=e,this.lc=!1}}class uw{constructor(e,t,n,r,i,s){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=r,this.currentUser=i,this.maxConcurrentLimboResolutions=s,this.fc={},this.dc=new sA(e=>sk(e),sx),this._c=new Map,this.wc=new Set,this.mc=new im(rS.comparator),this.gc=new Map,this.yc=new o8,this.Ic={},this.Tc=new Map,this.Ec=oB.kn(),this.onlineState="Unknown",this.Ac=void 0}get isPrimaryClient(){return!0===this.Ac}}async function ub(e,t){let n,r;let i=function(e){let t=e;return t.remoteStore.remoteSyncer.applyRemoteEvent=uT.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=uF.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=ux.bind(null,t),t.fc.eu=uh.bind(null,t.eventManager),t.fc.vc=ud.bind(null,t.eventManager),t}(e),s=i.dc.get(t);if(s)n=s.targetId,i.sharedClientState.addLocalQueryTarget(n),r=s.view.hc();else{let a=await function(e,t){let n=e;return n.persistence.runTransaction("Allocate target","readwrite",e=>{let r;return n.Fs.getTargetData(e,t).next(i=>i?(r=i,rM.resolve(r)):n.Fs.allocateTargetId(e).next(i=>(r=new aJ(t,i,"TargetPurposeListen",e.currentSequenceNumber),n.Fs.addTargetData(e,r).next(()=>r))))}).then(e=>{let r=n.Hi.get(e.targetId);return(null===r||e.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.Hi=n.Hi.insert(e.targetId,e),n.Ji.set(t,e.targetId)),e})}(i.localStore,sS(t)),o=i.sharedClientState.addLocalQueryTarget(a.targetId);r=await uE(i,t,n=a.targetId,"current"===o,a.resumeToken),i.isPrimaryClient&&lG(i.remoteStore,a)}return r}async function uE(e,t,n,r,i){e.Rc=(t,n,r)=>(async function(e,t,n,r){let i=t.view.nc(n);i.ji&&(i=await lw(e.localStore,t.query,!1).then(({documents:e})=>t.view.nc(e,i)));let s=r&&r.targetChanges.get(t.targetId),a=t.view.applyChanges(i,e.isPrimaryClient,s);return uP(e,t.targetId,a.uc),a.snapshot})(e,t,n,r);let s=await lw(e.localStore,t,!0),a=new uy(t,s.sr),o=a.nc(s.documents),l=av.createSynthesizedTargetChangeForCurrentChange(n,r&&"Offline"!==e.onlineState,i),u=a.applyChanges(o,e.isPrimaryClient,l);uP(e,n,u.uc);let c=new u_(t,n,a);return e.dc.set(t,c),e._c.has(n)?e._c.get(n).push(t):e._c.set(n,[t]),u.snapshot}async function uI(e,t){let n=e.dc.get(t),r=e._c.get(n.targetId);if(r.length>1)return e._c.set(n.targetId,r.filter(e=>!sx(e,t))),void e.dc.delete(t);e.isPrimaryClient?(e.sharedClientState.removeLocalQueryTarget(n.targetId),e.sharedClientState.isActiveQueryTarget(n.targetId)||await lv(e.localStore,n.targetId,!1).then(()=>{e.sharedClientState.clearQueryState(n.targetId),lq(e.remoteStore,n.targetId),uA(e,n.targetId)}).catch(rL)):(uA(e,n.targetId),await lv(e.localStore,n.targetId,!0))}async function uS(e,t,n){let r=uj(e);try{var i,s;let a;let o=await function(e,t){let n,r;let i=r_.now(),s=t.reduce((e,t)=>e.add(t.key),sB());return e.persistence.runTransaction("Locally write mutations","readwrite",a=>{let o=sO,l=sB();return e.Xi.getEntries(a,s).next(e=>{(o=e).forEach((e,t)=>{t.isValidDocument()||(l=l.add(e))})}).next(()=>e.localDocuments.getOverlayedDocuments(a,o)).next(r=>{n=r;let s=[];for(let o of t){let l=function(e,t){let n=null;for(let r of e.fieldTransforms){let i=t.data.field(r.field),s=sz(r.transform,i||null);null!=s&&(null===n&&(n=iX.empty()),n.set(r.field,s))}return n||null}(o,n.get(o.key).overlayedDocument);null!=l&&s.push(new s8(o.key,l,function e(t){let n=[];return id(t.fields,(t,r)=>{let i=new rI([t]);if(iK(r)){let s=e(r.mapValue).fields;if(0===s.length)n.push(i);else for(let a of s)n.push(i.child(a))}else n.push(i)}),new ib(n)}(l.value.mapValue),s2.exists(!0)))}return e.mutationQueue.addMutationBatch(a,i,s,t)}).next(t=>{r=t;let i=t.applyToLocalDocumentSet(n,l);return e.documentOverlayCache.saveOverlays(a,t.batchId,i)})}).then(()=>({batchId:r.batchId,changes:sM(n)}))}(r.localStore,t);r.sharedClientState.addPendingMutation(o.batchId),i=r,s=o.batchId,(a=i.Ic[i.currentUser.toKey()])||(a=new im(rg)),a=a.insert(s,n),i.Ic[i.currentUser.toKey()]=a,await uM(r,o.changes),await l1(r.remoteStore)}catch(u){let l=ur(u,"Failed to persist write");n.reject(l)}}async function uT(e,t){try{let n=await function(e,t){let n=e,r=t.snapshotVersion,i=n.Hi;return n.persistence.runTransaction("Apply remote event","readwrite-primary",e=>{var s;let a,o;let l=n.Xi.newChangeBuffer({trackRemovals:!0});i=n.Hi;let u=[];t.targetChanges.forEach((s,a)=>{var o;let l=i.get(a);if(!l)return;u.push(n.Fs.removeMatchingKeys(e,s.removedDocuments,a).next(()=>n.Fs.addMatchingKeys(e,s.addedDocuments,a)));let c=l.withSequenceNumber(e.currentSequenceNumber);null!==t.targetMismatches.get(a)?c=c.withResumeToken(iI.EMPTY_BYTE_STRING,rv.min()).withLastLimboFreeSnapshotVersion(rv.min()):s.resumeToken.approximateByteSize()>0&&(c=c.withResumeToken(s.resumeToken,r)),i=i.insert(a,c),o=c,(0===l.resumeToken.approximateByteSize()||o.snapshotVersion.toMicroseconds()-l.snapshotVersion.toMicroseconds()>=3e8||s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size>0)&&u.push(n.Fs.updateTargetData(e,c))});let c=sO,h=sB();if(t.documentUpdates.forEach(r=>{t.resolvedLimboDocuments.has(r)&&u.push(n.persistence.referenceDelegate.updateLimboDocument(e,r))}),u.push((s=t.documentUpdates,a=sB(),o=sB(),s.forEach(e=>a=a.add(e)),l.getEntries(e,a).next(e=>{let t=sO;return s.forEach((n,r)=>{let i=e.get(n);r.isFoundDocument()!==i.isFoundDocument()&&(o=o.add(n)),r.isNoDocument()&&r.version.isEqual(rv.min())?(l.removeEntry(n,r.readTime),t=t.insert(n,r)):!i.isValidDocument()||r.version.compareTo(i.version)>0||0===r.version.compareTo(i.version)&&i.hasPendingWrites?(l.addEntry(r),t=t.insert(n,r)):n8("LocalStore","Ignoring outdated watch update for ",n,". Current version:",i.version," Watch version:",r.version)}),{er:t,nr:o}})).next(e=>{c=e.er,h=e.nr})),!r.isEqual(rv.min())){let d=n.Fs.getLastRemoteSnapshotVersion(e).next(t=>n.Fs.setTargetsMetadata(e,e.currentSequenceNumber,r));u.push(d)}return rM.waitFor(u).next(()=>l.apply(e)).next(()=>n.localDocuments.getLocalViewOfDocuments(e,c,h)).next(()=>c)}).then(e=>(n.Hi=i,e))}(e.localStore,t);t.targetChanges.forEach((t,n)=>{let r=e.gc.get(n);r&&(t.addedDocuments.size+t.modifiedDocuments.size+t.removedDocuments.size<=1||rr(),t.addedDocuments.size>0?r.lc=!0:t.modifiedDocuments.size>0?r.lc||rr():t.removedDocuments.size>0&&(r.lc||rr(),r.lc=!1))}),await uM(e,n,t)}catch(r){await rL(r)}}function uD(e,t,n){let r=e;if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){let i=[];r.dc.forEach((e,n)=>{let r=n.view.ku(t);r.snapshot&&i.push(r.snapshot)}),function(e,t){let n=e;n.onlineState=t;let r=!1;n.queries.forEach((e,n)=>{for(let i of n.listeners)i.ku(t)&&(r=!0)}),r&&uf(n)}(r.eventManager,t),i.length&&r.fc.eu(i),r.onlineState=t,r.isPrimaryClient&&r.sharedClientState.setOnlineState(t)}}async function ux(e,t,n){let r=e;r.sharedClientState.updateQueryState(t,"rejected",n);let i=r.gc.get(t),s=i&&i.key;if(s){let a=new im(rS.comparator);a=a.insert(s,iJ.newNoDocument(s,rv.min()));let o=sB().add(s),l=new a_(rv.min(),new Map,new im(rg),a,o);await uT(r,l),r.mc=r.mc.remove(s),r.gc.delete(t),uL(r)}else await lv(r.localStore,t,!1).then(()=>uA(r,t,n)).catch(rL)}async function uk(e,t){var n;let r=t.batch.batchId;try{let i=await (n=e.localStore).persistence.runTransaction("Acknowledge batch","readwrite-primary",e=>{let r=t.batch.keys(),i=n.Xi.newChangeBuffer({trackRemovals:!0});return(function(e,t,n,r){let i=n.batch,s=i.keys(),a=rM.resolve();return s.forEach(e=>{a=a.next(()=>r.getEntry(t,e)).next(t=>{let s=n.docVersions.get(e);null!==s||rr(),0>t.version.compareTo(s)&&(i.applyToRemoteDocument(t,n),t.isValidDocument()&&(t.setReadTime(n.commitVersion),r.addEntry(t)))})}),a.next(()=>e.mutationQueue.removeMutationBatch(t,i))})(n,e,t,i).next(()=>i.apply(e)).next(()=>n.mutationQueue.performConsistencyCheck(e)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(e,r,t.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,function(e){let t=sB();for(let n=0;n<e.mutationResults.length;++n)e.mutationResults[n].transformResults.length>0&&(t=t.add(e.batch.mutations[n].key));return t}(t))).next(()=>n.localDocuments.getDocuments(e,r))});uR(e,r,null),uN(e,r),e.sharedClientState.updateMutationState(r,"acknowledged"),await uM(e,i)}catch(s){await rL(s)}}async function uC(e,t,n){var r;try{let i=await (r=e.localStore).persistence.runTransaction("Reject batch","readwrite-primary",e=>{let n;return r.mutationQueue.lookupMutationBatch(e,t).next(t=>(null!==t||rr(),n=t.keys(),r.mutationQueue.removeMutationBatch(e,t))).next(()=>r.mutationQueue.performConsistencyCheck(e)).next(()=>r.documentOverlayCache.removeOverlaysForBatchId(e,n,t)).next(()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,n)).next(()=>r.localDocuments.getDocuments(e,n))});uR(e,t,n),uN(e,t),e.sharedClientState.updateMutationState(t,"rejected",n),await uM(e,i)}catch(s){await rL(s)}}function uN(e,t){(e.Tc.get(t)||[]).forEach(e=>{e.resolve()}),e.Tc.delete(t)}function uR(e,t,n){let r=e,i=r.Ic[r.currentUser.toKey()];if(i){let s=i.get(t);s&&(n?s.reject(n):s.resolve(),i=i.remove(t)),r.Ic[r.currentUser.toKey()]=i}}function uA(e,t,n=null){for(let r of(e.sharedClientState.removeLocalQueryTarget(t),e._c.get(t)))e.dc.delete(r),n&&e.fc.vc(r,n);e._c.delete(t),e.isPrimaryClient&&e.yc.ps(t).forEach(t=>{e.yc.containsKey(t)||uO(e,t)})}function uO(e,t){e.wc.delete(t.path.canonicalString());let n=e.mc.get(t);null!==n&&(lq(e.remoteStore,n),e.mc=e.mc.remove(t),e.gc.delete(n),uL(e))}function uP(e,t,n){for(let r of n)r instanceof um?(e.yc.addReference(r.key,t),function(e,t){let n=t.key,r=n.path.canonicalString();e.mc.get(n)||e.wc.has(r)||(n8("SyncEngine","New document in limbo: "+n),e.wc.add(r),uL(e))}(e,r)):r instanceof ug?(n8("SyncEngine","Document no longer in limbo: "+r.key),e.yc.removeReference(r.key,t),e.yc.containsKey(r.key)||uO(e,r.key)):rr()}function uL(e){for(;e.wc.size>0&&e.mc.size<e.maxConcurrentLimboResolutions;){let t=e.wc.values().next().value;e.wc.delete(t);let n=new rS(rb.fromString(t)),r=e.Ec.next();e.gc.set(r,new uv(n)),e.mc=e.mc.insert(n,r),lG(e.remoteStore,new aJ(sS(s_(n.path)),r,"TargetPurposeLimboResolution",rH.ct))}}async function uM(e,t,n){let r=[],i=[],s=[];e.dc.isEmpty()||(e.dc.forEach((a,o)=>{s.push(e.Rc(o,t,n).then(t=>{if((t||n)&&e.isPrimaryClient&&e.sharedClientState.updateQueryState(o.targetId,(null==t?void 0:t.fromCache)?"not-current":"current"),t){r.push(t);let s=lp.Bi(o.targetId,t);i.push(s)}}))}),await Promise.all(s),e.fc.eu(r),await async function(e,t){let n=e;try{await n.persistence.runTransaction("notifyLocalViewChanges","readwrite",e=>rM.forEach(t,t=>rM.forEach(t.$i,r=>n.persistence.referenceDelegate.addReference(e,t.targetId,r)).next(()=>rM.forEach(t.Fi,r=>n.persistence.referenceDelegate.removeReference(e,t.targetId,r)))))}catch(r){if(!r$(r))throw r;n8("LocalStore","Failed to update sequence numbers: "+r)}for(let i of t){let s=i.targetId;if(!i.fromCache){let a=n.Hi.get(s),o=a.snapshotVersion,l=a.withLastLimboFreeSnapshotVersion(o);n.Hi=n.Hi.insert(s,l)}}}(e.localStore,i))}async function uU(e,t){let n=e;if(!n.currentUser.isEqual(t)){n8("SyncEngine","User change. New user:",t.toKey());let r=await ly(n.localStore,t);n.currentUser=t,n.Tc.forEach(e=>{e.forEach(e=>{e.reject(new rs(ri.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),n.Tc.clear(),n.sharedClientState.handleUserChange(t,r.removedBatchIds,r.addedBatchIds),await uM(n,r.tr)}}function uF(e,t){let n=e.gc.get(t);if(n&&n.lc)return sB().add(n.key);{let r=sB(),i=e._c.get(t);if(!i)return r;for(let s of i){let a=e.dc.get(s);r=r.unionWith(a.view.ec)}return r}}function uj(e){let t=e;return t.remoteStore.remoteSyncer.applySuccessfulWrite=uk.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=uC.bind(null,t),t}class uB{constructor(){this.synchronizeTabs=!1}async initialize(e){this.serializer=lA(e.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(e),this.persistence=this.createPersistence(e),await this.persistence.start(),this.localStore=this.createLocalStore(e),this.gcScheduler=this.createGarbageCollectionScheduler(e,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(e,this.localStore)}createGarbageCollectionScheduler(e,t){return null}createIndexBackfillerScheduler(e,t){return null}createLocalStore(e){var t,n,r,i;return t=this.persistence,n=new lm,r=e.initialUser,i=this.serializer,new lg(t,n,r,i)}createPersistence(e){return new ls(lo.js,this.serializer)}createSharedClientState(e){return new lE}async terminate(){this.gcScheduler&&this.gcScheduler.stop(),await this.sharedClientState.shutdown(),await this.persistence.shutdown()}}class u$ extends uB{constructor(e,t,n){super(),this.bc=e,this.cacheSizeBytes=t,this.forceOwnership=n,this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.bc.initialize(this,e),await uj(this.bc.syncEngine),await l1(this.bc.remoteStore),await this.persistence.pi(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}createLocalStore(e){var t,n,r,i;return t=this.persistence,n=new lm,r=e.initialUser,i=this.serializer,new lg(t,n,r,i)}createGarbageCollectionScheduler(e,t){let n=this.persistence.referenceDelegate.garbageCollector;return new oY(n,e.asyncQueue,t)}createIndexBackfillerScheduler(e,t){let n=new rY(t,this.persistence);return new rK(e.asyncQueue,n)}createPersistence(e){var t,n;let r;let i=(t=e.databaseInfo.databaseId,n=e.databaseInfo.persistenceKey,r=t.projectId,t.isDefaultDatabase||(r+="."+t.database),"firestore/"+n+"/"+r+"/"),s=void 0!==this.cacheSizeBytes?oA.withCacheSize(this.cacheSizeBytes):oA.DEFAULT;return new lh(this.synchronizeTabs,i,e.clientId,s,e.asyncQueue,"undefined"!=typeof window?window:null,lR(),this.serializer,this.sharedClientState,!!this.forceOwnership)}createSharedClientState(e){return new lE}}class uV{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=e=>uD(this.syncEngine,e,1),this.remoteStore.remoteSyncer.handleCredentialChange=uU.bind(null,this.syncEngine),await l8(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return new ul}createDatastore(e){var t,n,r;let i=lA(e.databaseInfo.databaseId),s=(t=e.databaseInfo,new lN(t));return n=e.authCredentials,r=e.appCheckCredentials,new lU(n,r,s,i)}createRemoteStore(e){var t,n,r,i,s;return t=this.localStore,n=this.datastore,r=e.asyncQueue,i=e=>uD(this.syncEngine,e,0),s=lS.D()?new lS:new lI,new lB(t,n,r,i,s)}createSyncEngine(e,t){return function(e,t,n,r,i,s,a){let o=new uw(e,t,n,r,i,s);return a&&(o.Ac=!0),o}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}terminate(){return async function(e){n8("RemoteStore","RemoteStore shutting down."),e.Au.add(5),await lV(e),e.vu.shutdown(),e.Pu.set("Unknown")}(this.remoteStore)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ /**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ class uG{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Vc(this.observer.next,e)}error(e){this.observer.error?this.Vc(this.observer.error,e):re("Uncaught Error in snapshot listener:",e.toString())}Sc(){this.muted=!0}Vc(e,t){this.muted||setTimeout(()=>{this.muted||e(t)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ class uq{constructor(e,t,n,r){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this.databaseInfo=r,this.user=n6.UNAUTHENTICATED,this.clientId=rm.A(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(n,async e=>{n8("FirestoreClient","Received user=",e.uid),await this.authCredentialListener(e),this.user=e}),this.appCheckCredentials.start(n,e=>(n8("FirestoreClient","Received new app check token=",e),this.appCheckCredentialListener(e,this.user)))}async getConfiguration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new rs(ri.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();let e=new ra;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){let t=ur(n,"Failed to shutdown persistence");e.reject(t)}}),e.promise}}async function uz(e,t){e.asyncQueue.verifyOperationInProgress(),n8("FirestoreClient","Initializing OfflineComponentProvider");let n=await e.getConfiguration();await t.initialize(n);let r=n.initialUser;e.setCredentialChangeListener(async e=>{r.isEqual(e)||(await ly(t.localStore,e),r=e)}),t.persistence.setDatabaseDeletedListener(()=>e.terminate()),e._offlineComponents=t}async function uK(e,t){e.asyncQueue.verifyOperationInProgress();let n=await uH(e);n8("FirestoreClient","Initializing OnlineComponentProvider");let r=await e.getConfiguration();await t.initialize(n,r),e.setCredentialChangeListener(e=>l7(t.remoteStore,e)),e.setAppCheckTokenChangeListener((e,n)=>l7(t.remoteStore,n)),e._onlineComponents=t}function uY(e){return"FirebaseError"===e.name?e.code===ri.FAILED_PRECONDITION||e.code===ri.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&e instanceof DOMException)||22===e.code||20===e.code||11===e.code}async function uH(e){if(!e._offlineComponents){if(e._uninitializedComponentsProvider){n8("FirestoreClient","Using user provided OfflineComponentProvider");try{await uz(e,e._uninitializedComponentsProvider._offline)}catch(t){if(!uY(t))throw t;rt("Error using user provided cache. Falling back to memory cache: "+t),await uz(e,new uB)}}else n8("FirestoreClient","Using default OfflineComponentProvider"),await uz(e,new uB)}return e._offlineComponents}async function uW(e){return e._onlineComponents||(e._uninitializedComponentsProvider?(n8("FirestoreClient","Using user provided OnlineComponentProvider"),await uK(e,e._uninitializedComponentsProvider._online)):(n8("FirestoreClient","Using default OnlineComponentProvider"),await uK(e,new uV))),e._onlineComponents}async function uQ(e){let t=await uW(e),n=t.eventManager;return n.onListen=ub.bind(null,t.syncEngine),n.onUnlisten=uI.bind(null,t.syncEngine),n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ let uX=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ function uJ(e,t,n){if(!n)throw new rs(ri.INVALID_ARGUMENT,`Function ${e}() cannot be called with an empty ${t}.`)}function uZ(e){if(!rS.isDocumentKey(e))throw new rs(ri.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${e} has ${e.length}.`)}function u0(e){if(rS.isDocumentKey(e))throw new rs(ri.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${e} has ${e.length}.`)}function u1(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e=`${e.substring(0,20)}...`),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==typeof e){if(e instanceof Array)return"an array";{var t;let n=(t=e).constructor?t.constructor.name:null;return n?`a custom ${n} object`:"an object"}}return"function"==typeof e?"a function":rr()}function u2(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new rs(ri.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let n=u1(e);throw new rs(ri.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${n}`)}}return e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ class u4{constructor(e){var t;if(void 0===e.host){if(void 0!==e.ssl)throw new rs(ri.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=null===(t=e.ssl)||void 0===t||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.cache=e.localCache,void 0===e.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<1048576)throw new rs(ri.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}(function(e,t,n,r){if(!0===t&&!0===r)throw new rs(ri.INVALID_ARGUMENT,`${e} and ${n} cannot be used together.`)})("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:void 0===e.experimentalAutoDetectLongPolling?this.experimentalAutoDetectLongPolling=!1:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ class u9{constructor(e,t,n,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=n,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new u4({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new rs(ri.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return void 0!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new rs(ri.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new u4(e),void 0!==e.credentials&&(this._authCredentials=function(e){if(!e)return new rl;switch(e.type){case"firstParty":return new rd(e.sessionIndex||"0",e.iamToken||null,e.authTokenFactory||null);case"provider":return e.client;default:throw new rs(ri.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){let t=uX.get(e);t&&(n8("ComponentProvider","Removing Datastore"),uX.delete(e),t.terminate())}(this),Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ class u6{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new u3(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new u6(this.firestore,e,this._key)}}class u5{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new u5(this.firestore,e,this._query)}}class u3 extends u5{constructor(e,t,n){super(e,t,s_(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new u6(this.firestore,null,new rS(e))}withConverter(e){return new u3(this.firestore,e,this._path)}}function u7(e,t,...n){if(e=(0,p.m9)(e),uJ("collection","path",t),e instanceof u9){let r=rb.fromString(t,...n);return u0(r),new u3(e,null,r)}{if(!(e instanceof u6||e instanceof u3))throw new rs(ri.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let i=e._path.child(rb.fromString(t,...n));return u0(i),new u3(e.firestore,null,i)}}function u8(e,t,...n){if(e=(0,p.m9)(e),1==arguments.length&&(t=rm.A()),uJ("doc","path",t),e instanceof u9){let r=rb.fromString(t,...n);return uZ(r),new u6(e,null,new rS(r))}{if(!(e instanceof u6||e instanceof u3))throw new rs(ri.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let i=e._path.child(rb.fromString(t,...n));return uZ(i),new u6(e.firestore,e instanceof u3?e.converter:null,new rS(i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ class ce{constructor(){this.Kc=Promise.resolve(),this.Gc=[],this.Qc=!1,this.jc=[],this.zc=null,this.Wc=!1,this.Hc=!1,this.Jc=[],this.Lo=new lO(this,"async_queue_retry"),this.Yc=()=>{let e=lR();e&&n8("AsyncQueue","Visibility state changed to "+e.visibilityState),this.Lo.ko()};let e=lR();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.Yc)}get isShuttingDown(){return this.Qc}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Xc(),this.Zc(e)}enterRestrictedMode(e){if(!this.Qc){this.Qc=!0,this.Hc=e||!1;let t=lR();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Yc)}}enqueue(e){if(this.Xc(),this.Qc)return new Promise(()=>{});let t=new ra;return this.Zc(()=>this.Qc&&this.Hc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Gc.push(e),this.ta()))}async ta(){if(0!==this.Gc.length){try{await this.Gc[0](),this.Gc.shift(),this.Lo.reset()}catch(e){if(!r$(e))throw e;n8("AsyncQueue","Operation failed with retryable error: "+e)}this.Gc.length>0&&this.Lo.xo(()=>this.ta())}}Zc(e){let t=this.Kc.then(()=>(this.Wc=!0,e().catch(e=>{let t;this.zc=e,this.Wc=!1;let n=(t=e.message||"",e.stack&&(t=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),t);throw re("INTERNAL UNHANDLED ERROR: ",n),e}).then(e=>(this.Wc=!1,e))));return this.Kc=t,t}enqueueAfterDelay(e,t,n){this.Xc(),this.Jc.indexOf(e)>-1&&(t=0);let r=un.createAndSchedule(this,e,t,n,e=>this.ea(e));return this.jc.push(r),r}Xc(){this.zc&&rr()}verifyOperationInProgress(){}async na(){let e;do await (e=this.Kc);while(e!==this.Kc)}sa(e){for(let t of this.jc)if(t.timerId===e)return!0;return!1}ia(e){return this.na().then(()=>{for(let t of(this.jc.sort((e,t)=>e.targetTimeMs-t.targetTimeMs),this.jc))if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.na()})}ra(e){this.Jc.push(e)}ea(e){let t=this.jc.indexOf(e);this.jc.splice(t,1)}}function ct(e){return function(e,t){if("object"!=typeof e||null===e)return!1;for(let n of t)if(n in e&&"function"==typeof e[n])return!0;return!1}(e,["next","error","complete"])}class cn extends u9{constructor(e,t,n,r){super(e,t,n,r),this.type="firestore",this._queue=new ce,this._persistenceKey=(null==r?void 0:r.name)||"[DEFAULT]"}_terminate(){return this._firestoreClient||cs(this),this._firestoreClient.terminate()}}function cr(e,t){let n="object"==typeof e?e:(0,h.Mq)(),r=(0,h.qX)(n,"firestore").getImmediate({identifier:"string"==typeof e?e:t||"(default)"});if(!r._initialized){let i=(0,p.P0)("firestore");i&&function(e,t,n,r={}){var i;let s=(e=u2(e,u9))._getSettings();if("firestore.googleapis.com"!==s.host&&s.host!==t&&rt("Host has been set in both settings() and useEmulator(), emulator host will be used"),e._setSettings(Object.assign(Object.assign({},s),{host:`${t}:${n}`,ssl:!1})),r.mockUserToken){let a,o;if("string"==typeof r.mockUserToken)a=r.mockUserToken,o=n6.MOCK_USER;else{a=(0,p.Sg)(r.mockUserToken,null===(i=e._app)||void 0===i?void 0:i.options.projectId);let l=r.mockUserToken.sub||r.mockUserToken.user_id;if(!l)throw new rs(ri.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");o=new n6(l)}e._authCredentials=new ru(new ro(a,o))}}(r,...i)}return r}function ci(e){return e._firestoreClient||cs(e),e._firestoreClient.verifyNotTerminated(),e._firestoreClient}function cs(e){var t,n,r,i,s,a;let o=e._freezeSettings(),l=(i=e._databaseId,s=(null===(t=e._app)||void 0===t?void 0:t.options.appId)||"",a=e._persistenceKey,new iR(i,s,a,o.host,o.ssl,o.experimentalForceLongPolling,o.experimentalAutoDetectLongPolling,o.useFetchStreams));e._firestoreClient=new uq(e._authCredentials,e._appCheckCredentials,e._queue,l),(null===(n=o.cache)||void 0===n?void 0:n._offlineComponentProvider)&&(null===(r=o.cache)||void 0===r?void 0:r._onlineComponentProvider)&&(e._firestoreClient._uninitializedComponentsProvider={_offlineKind:o.cache.kind,_offline:o.cache._offlineComponentProvider,_online:o.cache._onlineComponentProvider})}function ca(e,t){!function(e){if(e._initialized||e._terminated)throw new rs(ri.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}(e=u2(e,cn));let n=ci(e);if(n._uninitializedComponentsProvider)throw new rs(ri.FAILED_PRECONDITION,"SDK cache is already specified.");rt("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");let r=e._freezeSettings(),i=new uV;return function(e,t,n){let r=new ra;return e.asyncQueue.enqueue(async()=>{try{await uz(e,n),await uK(e,t),r.resolve()}catch(i){if(!uY(i))throw i;rt("Error enabling indexeddb cache. Falling back to memory cache: "+i),r.reject(i)}}).then(()=>r.promise)}(n,i,new u$(i,r.cacheSizeBytes,null==t?void 0:t.forceOwnership))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ /**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ class co{constructor(e="count",t){this._aggregateType=e,this._internalFieldPath=t,this.type="AggregateField"}}class cl{constructor(e,t,n){this._userDataWriter=t,this._data=n,this.type="AggregateQuerySnapshot",this.query=e}data(){return this._userDataWriter.convertObjectMap(this._data)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ class cu{constructor(e){this._byteString=e}static fromBase64String(e){try{return new cu(iI.fromBase64String(e))}catch(t){throw new rs(ri.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new cu(iI.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ class cc{constructor(...e){for(let t=0;t<e.length;++t)if(0===e[t].length)throw new rs(ri.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new rI(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ class ch{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ class cd{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new rs(ri.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new rs(ri.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return rg(this._lat,e._lat)||rg(this._long,e._long)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ let cf=/^__.*__$/;class cp{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return null!==this.fieldMask?new s8(e,this.data,this.fieldMask,t,this.fieldTransforms):new s7(e,this.data,t,this.fieldTransforms)}}class cm{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return new s8(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function cg(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw rr()}}class cy{constructor(e,t,n,r,i,s){this.settings=e,this.databaseId=t,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.oa(),this.fieldTransforms=i||[],this.fieldMask=s||[]}get path(){return this.settings.path}get ua(){return this.settings.ua}ca(e){return new cy(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}aa(e){var t;let n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.ca({path:n,ha:!1});return r.la(e),r}fa(e){var t;let n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.ca({path:n,ha:!1});return r.oa(),r}da(e){return this.ca({path:void 0,ha:!0})}_a(e){return cN(e,this.settings.methodName,this.settings.wa||!1,this.path,this.settings.ma)}contains(e){return void 0!==this.fieldMask.find(t=>e.isPrefixOf(t))||void 0!==this.fieldTransforms.find(t=>e.isPrefixOf(t.field))}oa(){if(this.path)for(let e=0;e<this.path.length;e++)this.la(this.path.get(e))}la(e){if(0===e.length)throw this._a("Document fields must not be empty");if(cg(this.ua)&&cf.test(e))throw this._a('Document fields cannot begin and end with "__"')}}class c_{constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=n||lA(e)}ga(e,t,n,r=!1){return new cy({ua:e,methodName:t,ma:n,path:rI.emptyPath(),ha:!1,wa:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function cv(e){let t=e._freezeSettings(),n=lA(e._databaseId);return new c_(e._databaseId,!!t.ignoreUndefinedProperties,n)}function cw(e,t,n,r,i,s={}){let a,o;let l=e.ga(s.merge||s.mergeFields?2:0,t,n,i);cD("Data must be an object, but it was:",l,r);let u=cS(r,l);if(s.merge)a=new ib(l.fieldMask),o=l.fieldTransforms;else if(s.mergeFields){let c=[];for(let h of s.mergeFields){let d=cx(t,h,n);if(!l.contains(d))throw new rs(ri.INVALID_ARGUMENT,`Field '${d}' is specified in your field mask but missing from your input data.`);cR(c,d)||c.push(d)}a=new ib(c),o=l.fieldTransforms.filter(e=>a.covers(e.field))}else a=null,o=l.fieldTransforms;return new cp(new iX(u),a,o)}class cb extends ch{_toFieldTransform(e){if(2!==e.ua)throw 1===e.ua?e._a(`${this._methodName}() can only appear at the top level of your update data`):e._a(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof cb}}function cE(e,t,n,r=!1){return cI(n,e.ga(r?4:3,t))}function cI(e,t){if(cT(e=(0,p.m9)(e)))return cD("Unsupported field value:",t,e),cS(e,t);if(e instanceof ch)return function(e,t){if(!cg(t.ua))throw t._a(`${e._methodName}() can only be used with update() and set()`);if(!t.path)throw t._a(`${e._methodName}() is not currently supported inside arrays`);let n=e._toFieldTransform(t);n&&t.fieldTransforms.push(n)}(e,t),null;if(void 0===e&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.ha&&4!==t.ua)throw t._a("Nested arrays are not supported");return function(e,t){let n=[],r=0;for(let i of e){let s=cI(i,t.da(r));null==s&&(s={nullValue:"NULL_VALUE"}),n.push(s),r++}return{arrayValue:{values:n}}}(e,t)}return function(e,t){if(null===(e=(0,p.m9)(e)))return{nullValue:"NULL_VALUE"};if("number"==typeof e){var n,r,i;return n=t.serializer,"number"==typeof(i=r=e)&&Number.isInteger(i)&&!rW(i)&&i<=Number.MAX_SAFE_INTEGER&&i>=Number.MIN_SAFE_INTEGER?sG(r):sV(n,r)}if("boolean"==typeof e)return{booleanValue:e};if("string"==typeof e)return{stringValue:e};if(e instanceof Date){let s=r_.fromDate(e);return{timestampValue:aA(t.serializer,s)}}if(e instanceof r_){let a=new r_(e.seconds,1e3*Math.floor(e.nanoseconds/1e3));return{timestampValue:aA(t.serializer,a)}}if(e instanceof cd)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};if(e instanceof cu)return{bytesValue:aO(t.serializer,e._byteString)};if(e instanceof u6){let o=t.databaseId,l=e.firestore._databaseId;if(!l.isEqual(o))throw t._a(`Document reference is for database ${l.projectId}/${l.database} but should be for database ${o.projectId}/${o.database}`);return{referenceValue:aL(e.firestore._databaseId||t.databaseId,e._key.path)}}throw t._a(`Unsupported field value: ${u1(e)}`)}(e,t)}function cS(e,t){let n={};return ip(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):id(e,(e,r)=>{let i=cI(r,t.aa(e));null!=i&&(n[e]=i)}),{mapValue:{fields:n}}}function cT(e){return!("object"!=typeof e||null===e||e instanceof Array||e instanceof Date||e instanceof r_||e instanceof cd||e instanceof cu||e instanceof u6||e instanceof ch)}function cD(e,t,n){if(!cT(n)||!("object"==typeof n&&null!==n&&(Object.getPrototypeOf(n)===Object.prototype||null===Object.getPrototypeOf(n)))){let r=u1(n);throw"an object"===r?t._a(e+" a custom object"):t._a(e+" "+r)}}function cx(e,t,n){if((t=(0,p.m9)(t))instanceof cc)return t._internalPath;if("string"==typeof t)return cC(e,t);throw cN("Field path arguments must be of type string or ",e,!1,void 0,n)}let ck=RegExp("[~\\*/\\[\\]]");function cC(e,t,n){if(t.search(ck)>=0)throw cN(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,e,!1,void 0,n);try{return new cc(...t.split("."))._internalPath}catch(r){throw cN(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,e,!1,void 0,n)}}function cN(e,t,n,r,i){let s=r&&!r.isEmpty(),a=void 0!==i,o=`Function ${t}() called with invalid data`;n&&(o+=" (via `toFirestore()`)"),o+=". ";let l="";return(s||a)&&(l+=" (found",s&&(l+=` in field ${r}`),a&&(l+=` in document ${i}`),l+=")"),new rs(ri.INVALID_ARGUMENT,o+e+l)}function cR(e,t){return e.some(e=>e.isEqual(t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ class cA{constructor(e,t,n,r,i){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=r,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new u6(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){let e=new cO(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){let t=this._document.data.field(cP("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class cO extends cA{data(){return super.data()}}function cP(e,t){return"string"==typeof t?cC(e,t):t instanceof cc?t._internalPath:t._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ function cL(e){if("L"===e.limitType&&0===e.explicitOrderBy.length)throw new rs(ri.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class cM{}class cU extends cM{}function cF(e,t,...n){let r=[];for(let i of(t instanceof cM&&r.push(t),function(e){let t=e.filter(e=>e instanceof c$).length,n=e.filter(e=>e instanceof cj).length;if(t>1||t>0&&n>0)throw new rs(ri.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r=r.concat(n)),r))e=i._apply(e);return e}class cj extends cU{constructor(e,t,n){super(),this._field=e,this._op=t,this._value=n,this.type="where"}static _create(e,t,n){return new cj(e,t,n)}_apply(e){let t=this._parse(e);return cQ(e._query,t),new u5(e.firestore,e.converter,sT(e._query,t))}_parse(e){let t=cv(e.firestore),n=function(e,t,n,r,i,s,a){let o;if(i.isKeyField()){if("array-contains"===s||"array-contains-any"===s)throw new rs(ri.INVALID_ARGUMENT,`Invalid Query. You can't perform '${s}' queries on documentId().`);if("in"===s||"not-in"===s){cW(a,s);let l=[];for(let u of a)l.push(cH(r,e,u));o={arrayValue:{values:l}}}else o=cH(r,e,a)}else"in"!==s&&"not-in"!==s&&"array-contains-any"!==s||cW(a,s),o=cE(n,t,a,"in"===s||"not-in"===s);return i9.create(i,s,o)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value);return n}}function cB(e,t,n){let r=cP("where",e);return cj._create(r,t,n)}class c$ extends cM{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new c$(e,t)}_parse(e){let t=this._queryConstraints.map(t=>t._parse(e)).filter(e=>e.getFilters().length>0);return 1===t.length?t[0]:i6.create(t,this._getOperator())}_apply(e){let t=this._parse(e);return 0===t.getFilters().length?e:(function(e,t){let n=e,r=t.getFlattenedFilters();for(let i of r)cQ(n,i),n=sT(n,i)}(e._query,t),new u5(e.firestore,e.converter,sT(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return"and"===this.type?"and":"or"}}class cV extends cU{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new cV(e,t)}_apply(e){let t=function(e,t,n){if(null!==e.startAt)throw new rs(ri.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==e.endAt)throw new rs(ri.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");let r=new i2(t,n);return function(e,t){if(null===sw(e)){let n=sb(e);null!==n&&cX(e,n,t.field)}}(e,r),r}(e._query,this._field,this._direction);return new u5(e.firestore,e.converter,function(e,t){let n=e.explicitOrderBy.concat([t]);return new sy(e.path,e.collectionGroup,n,e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(e._query,t))}}function cG(e,t="asc"){let n=cP("orderBy",e);return cV._create(n,t)}class cq extends cU{constructor(e,t,n){super(),this.type=e,this._limit=t,this._limitType=n}static _create(e,t,n){return new cq(e,t,n)}_apply(e){return new u5(e.firestore,e.converter,sD(e._query,this._limit,this._limitType))}}function cz(e){return function(e,t){if(t<=0)throw new rs(ri.INVALID_ARGUMENT,`Function ${e}() requires a positive number, but it was: ${t}.`)}("limit",e),cq._create("limit",e,"F")}class cK extends cU{constructor(e,t,n){super(),this.type=e,this._docOrFields=t,this._inclusive=n}static _create(e,t,n){return new cK(e,t,n)}_apply(e){var t;let n=function(e,t,n,r){if(n[0]=(0,p.m9)(n[0]),n[0]instanceof cA)return function(e,t,n,r,i){if(!r)throw new rs(ri.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${n}().`);let s=[];for(let a of sI(e))if(a.field.isKeyField())s.push(i$(t,r.key));else{let o=r.data.field(a.field);if(ik(o))throw new rs(ri.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+a.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===o){let l=a.field.canonicalString();throw new rs(ri.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${l}' (used as the orderBy) does not exist.`)}s.push(o)}return new iZ(s,i)}(e._query,e.firestore._databaseId,t,n[0]._document,r);{let i=cv(e.firestore);return function(e,t,n,r,i,s){let a=e.explicitOrderBy;if(i.length>a.length)throw new rs(ri.INVALID_ARGUMENT,`Too many arguments provided to ${r}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);let o=[];for(let l=0;l<i.length;l++){let u=i[l];if(a[l].field.isKeyField()){if("string"!=typeof u)throw new rs(ri.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${r}(), but got a ${typeof u}`);if(!sE(e)&&-1!==u.indexOf("/"))throw new rs(ri.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${r}() must be a plain document ID, but '${u}' contains a slash.`);let c=e.path.child(rb.fromString(u));if(!rS.isDocumentKey(c))throw new rs(ri.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${r}() must result in a valid document path, but '${c}' is not because it contains an odd number of segments.`);let h=new rS(c);o.push(i$(t,h))}else{let d=cE(n,r,u);o.push(d)}}return new iZ(o,s)}(e._query,e.firestore._databaseId,i,t,n,r)}}(e,this.type,this._docOrFields,this._inclusive);return new u5(e.firestore,e.converter,(t=e._query,new sy(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,n,t.endAt)))}}function cY(...e){return cK._create("startAfter",e,!1)}function cH(e,t,n){if("string"==typeof(n=(0,p.m9)(n))){if(""===n)throw new rs(ri.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!sE(t)&&-1!==n.indexOf("/"))throw new rs(ri.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);let r=t.path.child(rb.fromString(n));if(!rS.isDocumentKey(r))throw new rs(ri.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return i$(e,new rS(r))}if(n instanceof u6)return i$(e,n._key);throw new rs(ri.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${u1(n)}.`)}function cW(e,t){if(!Array.isArray(e)||0===e.length)throw new rs(ri.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${t.toString()}' filters.`)}function cQ(e,t){if(t.isInequality()){let n=sb(e),r=t.field;if(null!==n&&!n.isEqual(r))throw new rs(ri.INVALID_ARGUMENT,`Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '${n.toString()}' and '${r.toString()}'`);let i=sw(e);null!==i&&cX(e,r,i)}let s=function(e,t){for(let n of e)for(let r of n.getFlattenedFilters())if(t.indexOf(r.op)>=0)return r.op;return null}(e.filters,function(e){switch(e){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(null!==s)throw s===t.op?new rs(ri.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${t.op.toString()}' filter.`):new rs(ri.INVALID_ARGUMENT,`Invalid query. You cannot use '${t.op.toString()}' filters with '${s.toString()}' filters.`)}function cX(e,t,n){if(!n.isEqual(t))throw new rs(ri.INVALID_ARGUMENT,`Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '${t.toString()}' and so you must also use '${t.toString()}' as your first argument to orderBy(), but your first orderBy() is on field '${n.toString()}' instead.`)}class cJ{convertValue(e,t="none"){switch(iL(e)){case 0:return null;case 1:return e.booleanValue;case 2:return iD(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(ix(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw rr()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){let n={};return id(e,(e,r)=>{n[e]=this.convertValue(r,t)}),n}convertGeoPoint(e){return new cd(iD(e.latitude),iD(e.longitude))}convertArray(e,t){return(e.values||[]).map(e=>this.convertValue(e,t))}convertServerTimestamp(e,t){switch(t){case"previous":let n=iC(e);return null==n?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(iN(e));default:return null}}convertTimestamp(e){let t=iT(e);return new r_(t.seconds,t.nanos)}convertDocumentKey(e,t){let n=rb.fromString(e);aX(n)||rr();let r=new iA(n.get(1),n.get(3)),i=new rS(n.popFirst(5));return r.isEqual(t)||re(`Document ${i} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ function cZ(e,t,n){return e?n&&(n.merge||n.mergeFields)?e.toFirestore(t,n):e.toFirestore(t):t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ class c0{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class c1 extends cA{constructor(e,t,n,r,i,s){super(e,t,n,r,s),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){let t=new c2(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){let n=this._document.data.field(cP("DocumentSnapshot.get",e));if(null!==n)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}}class c2 extends c1{data(e={}){return super.data(e)}}class c4{constructor(e,t,n,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new c0(r.hasPendingWrites,r.fromCache),this.query=n}get docs(){let e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,t){this._snapshot.docs.forEach(n=>{e.call(t,new c2(this._firestore,this._userDataWriter,n.key,n,new c0(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){let t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new rs(ri.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(e,t){if(e._snapshot.oldDocs.isEmpty()){let n=0;return e._snapshot.docChanges.map(t=>{let r=new c2(e._firestore,e._userDataWriter,t.doc.key,t.doc,new c0(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter);return t.doc,{type:"added",doc:r,oldIndex:-1,newIndex:n++}})}{let r=e._snapshot.oldDocs;return e._snapshot.docChanges.filter(e=>t||3!==e.type).map(t=>{let n=new c2(e._firestore,e._userDataWriter,t.doc.key,t.doc,new c0(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter),i=-1,s=-1;return 0!==t.type&&(i=r.indexOf(t.doc.key),r=r.delete(t.doc.key)),1!==t.type&&(s=(r=r.add(t.doc)).indexOf(t.doc.key)),{type:function(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return rr()}}(t.type),doc:n,oldIndex:i,newIndex:s}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ function c9(e){e=u2(e,u6);let t=u2(e.firestore,cn);return(function(e,t,n={}){let r=new ra;return e.asyncQueue.enqueueAndForget(async()=>(function(e,t,n,r,i){let s=new uG({next(s){t.enqueueAndForget(()=>uc(e,a));let o=s.docs.has(n);!o&&s.fromCache?i.reject(new rs(ri.UNAVAILABLE,"Failed to get document because the client is offline.")):o&&s.fromCache&&r&&"server"===r.source?i.reject(new rs(ri.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(s)},error:e=>i.reject(e)}),a=new up(s_(n.path),s,{includeMetadataChanges:!0,Uu:!0});return uu(e,a)})(await uQ(e),e.asyncQueue,t,n,r)),r.promise})(ci(t),e._key).then(n=>hr(t,e,n))}class c6 extends cJ{constructor(e){super(),this.firestore=e}convertBytes(e){return new cu(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new u6(this.firestore,null,t)}}function c5(e){e=u2(e,u5);let t=u2(e.firestore,cn),n=ci(t),r=new c6(t);return cL(e._query),(function(e,t,n={}){let r=new ra;return e.asyncQueue.enqueueAndForget(async()=>(function(e,t,n,r,i){let s=new uG({next(n){t.enqueueAndForget(()=>uc(e,a)),n.fromCache&&"server"===r.source?i.reject(new rs(ri.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:e=>i.reject(e)}),a=new up(n,s,{includeMetadataChanges:!0,Uu:!0});return uu(e,a)})(await uQ(e),e.asyncQueue,t,n,r)),r.promise})(n,e._query).then(n=>new c4(t,r,e,n))}function c3(e,t,n){e=u2(e,u6);let r=u2(e.firestore,cn),i=cZ(e.converter,t,n);return hn(r,[cw(cv(r),"setDoc",e._key,i,null!==e.converter,n).toMutation(e._key,s2.none())])}function c7(e,t,n,...r){let i;e=u2(e,u6);let s=u2(e.firestore,cn),a=cv(s);return i="string"==typeof(t=(0,p.m9)(t))||t instanceof cc?function(e,t,n,r,i,s){let a=e.ga(1,t,n),o=[cx(t,r,n)],l=[i];if(s.length%2!=0)throw new rs(ri.INVALID_ARGUMENT,`Function ${t}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let u=0;u<s.length;u+=2)o.push(cx(t,s[u])),l.push(s[u+1]);let c=[],h=iX.empty();for(let d=o.length-1;d>=0;--d)if(!cR(c,o[d])){let f=o[d],m=l[d];m=(0,p.m9)(m);let g=a.fa(f);if(m instanceof cb)c.push(f);else{let y=cI(m,g);null!=y&&(c.push(f),h.set(f,y))}}let _=new ib(c);return new cm(h,_,a.fieldTransforms)}(a,"updateDoc",e._key,t,n,r):function(e,t,n,r){let i=e.ga(1,t,n);cD("Data must be an object, but it was:",i,r);let s=[],a=iX.empty();id(r,(e,r)=>{let o=cC(t,e,n);r=(0,p.m9)(r);let l=i.fa(o);if(r instanceof cb)s.push(o);else{let u=cI(r,l);null!=u&&(s.push(o),a.set(o,u))}});let o=new ib(s);return new cm(a,o,i.fieldTransforms)}(a,"updateDoc",e._key,t),hn(s,[i.toMutation(e._key,s2.exists(!0))])}function c8(e){return hn(u2(e.firestore,cn),[new ar(e._key,s2.none())])}function he(e,t){let n=u2(e.firestore,cn),r=u8(e),i=cZ(e.converter,t);return hn(n,[cw(cv(e.firestore),"addDoc",r._key,i,null!==e.converter,{}).toMutation(r._key,s2.exists(!1))]).then(()=>r)}function ht(e,...t){var n,r,i;let s,a,o;e=(0,p.m9)(e);let l={includeMetadataChanges:!1},u=0;"object"!=typeof t[0]||ct(t[u])||(l=t[u],u++);let c={includeMetadataChanges:l.includeMetadataChanges};if(ct(t[u])){let h=t[u];t[u]=null===(n=h.next)||void 0===n?void 0:n.bind(h),t[u+1]=null===(r=h.error)||void 0===r?void 0:r.bind(h),t[u+2]=null===(i=h.complete)||void 0===i?void 0:i.bind(h)}if(e instanceof u6)a=u2(e.firestore,cn),o=s_(e._key.path),s={next(n){t[u]&&t[u](hr(a,e,n))},error:t[u+1],complete:t[u+2]};else{let d=u2(e,u5);a=u2(d.firestore,cn),o=d._query;let f=new c6(a);s={next(e){t[u]&&t[u](new c4(a,f,d,e))},error:t[u+1],complete:t[u+2]},cL(e._query)}return function(e,t,n,r){let i=new uG(r),s=new up(t,i,n);return e.asyncQueue.enqueueAndForget(async()=>uu(await uQ(e),s)),()=>{i.Sc(),e.asyncQueue.enqueueAndForget(async()=>uc(await uQ(e),s))}}(ci(a),o,c,s)}function hn(e,t){return function(e,t){let n=new ra;return e.asyncQueue.enqueueAndForget(async()=>uS(await uW(e).then(e=>e.syncEngine),t,n)),n.promise}(ci(e),t)}function hr(e,t,n){let r=n.docs.get(t._key),i=new c6(e);return new c1(e,i,t._key,r,new c0(n.hasPendingWrites,n.fromCache),t.converter)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ function hi(e){return function(e,t){let n=u2(e.firestore,cn),r=ci(n),i=function(e,t){let n=[];for(let r in e)Object.prototype.hasOwnProperty.call(e,r)&&n.push(t(e[r],r,e));return n}(t,(e,t)=>new al(t,e._aggregateType,e._internalFieldPath));return(function(e,t,n){let r=new ra;return e.asyncQueue.enqueueAndForget(async()=>{try{let i=await uW(e).then(e=>e.datastore);r.resolve(lF(i,t,n))}catch(s){r.reject(s)}}),r.promise})(r,e._query,i).then(t=>(function(e,t,n){let r=new c6(e);return new cl(t,r,n)})(n,e,t))}(e,{count:new co("count")})}!function(e,t=!0){n5=h.Jn,(0,h.Xd)(new d.wA("firestore",(e,{instanceIdentifier:n,options:r})=>{let i=e.getProvider("app").getImmediate(),s=new cn(new rc(e.getProvider("auth-internal")),new rp(e.getProvider("app-check-internal")),function(e,t){if(!Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))throw new rs(ri.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new iA(e.options.projectId,t)}(i,n),i);return r=Object.assign({useFetchStreams:t},r),s._setSettings(r),s},"PUBLIC").setMultipleInstances(!0)),(0,h.KN)(n9,"3.11.0",void 0),(0,h.KN)(n9,"3.11.0","esm2017")}()},5364:function(e,t,n){"use strict";n.d(t,{p:function(){return i}});var r=n(7294);let i=(0,r.createContext)({})},240:function(e,t,n){"use strict";n.d(t,{O:function(){return i}});var r=n(7294);let i=(0,r.createContext)(null)},7367:function(e,t,n){"use strict";n.d(t,{w:function(){return r}});let r={delta:0,timestamp:0,isProcessing:!1}},6405:function(e,t,n){"use strict";n.d(t,{Pn:function(){return d},Wi:function(){return h},S6:function(){return o}});var r=n(7367);let i=!0,s=!1,a=["read","update","preRender","render","postRender"],o=a.reduce((e,t)=>(e[t]=function(e){let t=[],n=[],r=0,i=!1,s=!1,a=new WeakSet,o={schedule(e,s=!1,o=!1){let l=o&&i,u=l?t:n;return s&&a.add(e),-1===u.indexOf(e)&&(u.push(e),l&&i&&(r=t.length)),e},cancel(e){let t=n.indexOf(e);-1!==t&&n.splice(t,1),a.delete(e)},process(l){if(i){s=!0;return}if(i=!0,[t,n]=[n,t],n.length=0,r=t.length)for(let u=0;u<r;u++){let c=t[u];c(l),a.has(c)&&(o.schedule(c),e())}i=!1,s&&(s=!1,o.process(l))}};return o}(()=>s=!0),e),{}),l=e=>o[e].process(r.w),u=e=>{s=!1,r.w.delta=i?1e3/60:Math.max(Math.min(e-r.w.timestamp,40),1),r.w.timestamp=e,r.w.isProcessing=!0,a.forEach(l),r.w.isProcessing=!1,s&&(i=!1,requestAnimationFrame(u))},c=()=>{s=!0,i=!0,r.w.isProcessing||requestAnimationFrame(u)},h=a.reduce((e,t)=>{let n=o[t];return e[t]=(e,t=!1,r=!1)=>(s||c(),n.schedule(e,t,r)),e},{});function d(e){a.forEach(t=>o[t].cancel(e))}},5487:function(e,t,n){"use strict";n.d(t,{K:function(){return i},k:function(){return s}});var r=n(1662);let i=r.Z,s=r.Z},1741:function(e,t,n){"use strict";n.d(t,{j:function(){return r}});let r="undefined"!=typeof document},1662:function(e,t,n){"use strict";n.d(t,{Z:function(){return r}});let r=e=>e},6681:function(e,t,n){"use strict";n.d(t,{h:function(){return i}});var r=n(7294);function i(e){let t=(0,r.useRef)(null);return null===t.current&&(t.current=e()),t.current}},8868:function(e,t,n){"use strict";n.d(t,{L:function(){return s}});var r=n(7294),i=n(1741);let s=i.j?r.useLayoutEffect:r.useEffect},1955:function(e,t,n){"use strict";/*! js-cookie v3.0.5 | MIT */ function r(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)e[r]=n[r]}return e}n.d(t,{Z:function(){return i}});var i=function e(t,n){function i(e,i,s){if("undefined"!=typeof document){"number"==typeof(s=r({},n,s)).expires&&(s.expires=new Date(Date.now()+864e5*s.expires)),s.expires&&(s.expires=s.expires.toUTCString()),e=encodeURIComponent(e).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var a="";for(var o in s)s[o]&&(a+="; "+o,!0!==s[o]&&(a+="="+s[o].split(";")[0]));return document.cookie=e+"="+t.write(i,e)+a}}return Object.create({set:i,get:function(e){if("undefined"!=typeof document&&(!arguments.length||e)){for(var n=document.cookie?document.cookie.split("; "):[],r={},i=0;i<n.length;i++){var s=n[i].split("="),a=s.slice(1).join("=");try{var o=decodeURIComponent(s[0]);if(r[o]=t.read(a,o),e===o)break}catch(l){}}return e?r[e]:r}},remove:function(e,t){i(e,"",r({},t,{expires:-1}))},withAttributes:function(t){return e(this.converter,r({},this.attributes,t))},withConverter:function(t){return e(r({},this.converter,t),this.attributes)}},{attributes:{value:Object.freeze(n)},converter:{value:Object.freeze(t)}})}({read:function(e){return'"'===e[0]&&(e=e.slice(1,-1)),e.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(e){return encodeURIComponent(e).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}},{path:"/"})}},function(e){var t=function(t){return e(e.s=t)};e.O(0,[9774,179],function(){return t(4378),t(1118),t(880)}),_N_E=e.O()}]);
//# sourceMappingURL=_app-8c8aae9d2ab53191.js.map